{"version":3,"sources":["../node_modules/async-mutex/es6/Semaphore.js","../node_modules/async-mutex/es6/Mutex.js","../node_modules/async-mutex/es6/withTimeout.js","../../src/constants.js","../../src/options.js","../../src/create-element.js","../../src/component.js","../../src/render.js","../../src/create-context.js","../../src/util.js","../../src/diff/children.js","../../src/diff/props.js","../../src/diff/index.js","../../src/clone-element.js","../../src/diff/catch-error.js","../../src/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray.js","../node_modules/eth-json-rpc-filters/hexUtils.js","../node_modules/xtend/immutable.js","../index.ts","../node_modules/eth-rpc-errors/src/classes.js","../node_modules/eth-json-rpc-filters/base-filter.js","../node_modules/eth-json-rpc-filters/getBlocksForRange.js","../node_modules/eth-block-tracker/src/polling.js","../node_modules/pify/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get.js","../node_modules/eth-query/index.js","../node_modules/eth-json-rpc-filters/index.js","../../src/index.ts","../../src/getUniqueId.ts","../../src/JsonRpcEngine.ts","../node_modules/eth-rpc-errors/index.js","../node_modules/eth-rpc-errors/src/utils.js","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/scaffold.js","../node_modules/eth-json-rpc-filters/subscriptionManager.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/eth-block-tracker/src/base.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/superPropBase.js","../node_modules/json-rpc-random-id/index.js","../node_modules/safe-event-emitter/index.js","../../src/idRemapMiddleware.ts","../../src/createAsyncMiddleware.ts","../../src/createScaffoldMiddleware.ts","../node_modules/fast-safe-stringify/index.js","../node_modules/eth-rpc-errors/src/errors.js","../../src/mergeMiddleware.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/node_modules/json-rpc-engine/src/createScaffoldMiddleware.js","../node_modules/eth-json-rpc-filters/log-filter.js","../node_modules/eth-json-rpc-filters/node_modules/pify/index.js","../node_modules/eth-json-rpc-filters/base-filter-history.js","../node_modules/eth-json-rpc-filters/block-filter.js","../node_modules/eth-json-rpc-filters/tx-filter.js"],"names":["Semaphore","_maxConcurrency","this","_queue","Error","_value","prototype","acquire","_this","locked","isLocked","ticket","Promise","r","push","_dispatch","runExclusive","callback","__awaiter","_a","value","release","__generator","_b","label","sent","trys","_currentReleaser","releaser","undefined","nextConsumer","shift","released","Mutex","_semaphore","withTimeout","sync","timeout","timeoutError","resolve","reject","isTimeout","setTimeout","Array","isArray","options","isValidElement","rerenderQueue","rerenderCount","defer","prevDebounce","IS_HYDRATE","i","EMPTY_OBJ","EMPTY_ARR","IS_NON_DIMENSIONAL","assign","obj","props","removeNode","node","parentNode","removeChild","createElement","type","children","normalizedProps","arguments","length","defaultProps","createVNode","key","ref","original","vnode","_children","_parent","_depth","_dom","_nextDom","_component","constructor","_original","createRef","Fragment","Component","context","getDomSibling","childIndex","indexOf","sibling","updateParentDomPointers","child","base","enqueueRender","c","_dirty","debounceRendering","process","queue","sort","a","b","_vnode","some","component","commitQueue","oldVNode","newDom","oldDom","parentDom","_parentDom","diff","_globalContext","ownerSVGElement","commitRoot","diffChildren","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","sibDom","firstChildDom","refs","oldChildren","oldChildrenLength","toChildArray","childVNode","nextDom","outer","appendChild","nextSibling","insertBefore","unmount","applyRef","flattened","setStyle","style","setProperty","test","dom","name","oldValue","s","useCapture","nameLower","cssText","replace","toLowerCase","slice","addEventListener","eventProxy","_listeners","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","e","event","newVNode","tmp","isNew","oldProps","oldState","snapshot","clearProcessingException","newProps","provider","componentContext","newType","_diff","contextType","_id","_defaultValue","_processingException","_pendingError","render","doRender","sub","state","_renderCallbacks","_nextState","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","_force","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","_render","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","_catchError","root","_commit","cb","call","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","data","childNodes","dangerouslySetInnerHTML","attributes","__html","innerHTML","hydrate","diffProps","checked","current","parentVNode","skipRemove","componentWillUnmount","replaceNode","_root","cloneElement","createContext","defaultValue","ctx","Consumer","Provider","subs","_props","old","splice","_contextRef","error","hasCaught","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","then","bind","currentIndex","currentComponent","prevRaf","currentHook","afterPaintEffects","oldBeforeRender","oldAfterDiff","oldCommit","oldBeforeUnmount","getHookState","index","_hook","hooks","__hooks","_list","_pendingEffects","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","nextValue","action","useEffect","args","_skipEffects","argsChanged","_args","useLayoutEffect","useRef","initialValue","useMemo","useImperativeHandle","createHandle","concat","factory","_factory","useCallback","useContext","_context","useDebugValue","formatter","useErrorBoundary","errState","err","flushAfterPaintEffects","forEach","invokeCleanup","invokeEffect","hook","_cleanup","result","oldArgs","newArgs","arg","f","requestAnimationFrame","raf","done","clearTimeout","cancelAnimationFrame","window","filter","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","module","exports","arr","sortBlockRefs","refA","refB","hexToInt","hexString","Number","parseInt","intToHex","int","toString","unsafeRandomNibble","Math","floor","random","minBlockRef","sortedRefs","maxBlockRef","bnToHex","bn","blockRefIsNumber","blockRef","includes","incrementHexInt","unsafeRandomBytes","byteCount","target","source","hasOwnProperty","Object","safeStringify","require","EthereumRpcError","code","message","isInteger","serialized","stack","serialize","stringifyReplacer","EthereumProviderError","isValidEthProviderCode","_","BaseFilter","updates","newResults","emit","default","fromBlock","toBlock","fromBlockNumber","toBlockNumber","missingBlockNumbers","fill","map","all","blockNum","query","blockBodies","method","params","sendAsync","id","jsonrpc","res","pify","BaseBlockTracker","PollingBlockTracker","opts","pollingInterval","retryTimeout","keepEventLoopActive","setSkipCacheFlag","blockResetDuration","_provider","_pollingInterval","_retryTimeout","_keepEventLoopActive","_setSkipCacheFlag","_updateLatestBlock","getLatestBlock","_performSync","catch","_isRunning","newErr","emitErr","console","_fetchLatestBlock","latestBlock","_newPotentialLatest","req","skipCache","duration","unref","timoutRef","processFn","fn","P","promiseModule","errorFirst","multiArgs","results","unshift","apply","exclude","ret","match","pattern","include","excludeMain","create","getPrototypeOf","x","superPropBase","_get","property","receiver","Reflect","get","desc","getOwnPropertyDescriptor","extend","createRandomId","EthQuery","currentProvider","generateFnFor","methodName","self","pop","generateFnWithDefaultBlockFor","argCount","getBalance","getCode","getTransactionCount","getStorageAt","protocolVersion","syncing","coinbase","mining","hashrate","gasPrice","accounts","blockNumber","getBlockTransactionCountByHash","getBlockTransactionCountByNumber","getUncleCountByBlockHash","getUncleCountByBlockNumber","sign","sendTransaction","sendRawTransaction","estimateGas","getBlockByHash","getBlockByNumber","getTransactionByHash","getTransactionByBlockHashAndIndex","getTransactionByBlockNumberAndIndex","getTransactionReceipt","getUncleByBlockHashAndIndex","getUncleByBlockNumberAndIndex","getCompilers","compileLLL","compileSolidity","compileSerpent","newFilter","newBlockFilter","newPendingTransactionFilter","uninstallFilter","getFilterChanges","getFilterLogs","getLogs","getWork","submitWork","submitHashrate","response","createAsyncMiddleware","createJsonRpcMiddleware","LogFilter","BlockFilter","TxFilter","toFilterCreationMiddleware","createFilterFn","toAsyncRpcMiddleware","asyncFn","objValues","values","blockTracker","filterIndex","filters","mutex","waitForFree","middleware","next","end","releaseLock","mutexMiddlewareWrapper","eth_newFilter","newLogFilter","eth_newBlockFilter","eth_newPendingTransactionFilter","eth_uninstallFilter","uninstallFilterHandler","eth_getFilterChanges","eth_getFilterLogs","filterUpdater","oldBlock","newBlock","destroy","uninstallAllFilters","installFilter","filterIndexHex","getChangesAndClear","getAllResults","Boolean","prevFilterCount","currentBlock","initialize","idHex","newFilterCount","updateBlockTrackerSubs","on","removeListener","serializeError","getMessageFromCode","ethErrors","ERROR_CODES","errorValues","FALLBACK_ERROR_CODE","rpc","internal","FALLBACK_MESSAGE","FALLBACK_ERROR","fallbackMessage","codeString","isJsonRpcServerError","isValidCode","assignOriginalError","fallbackError","shouldIncludeStack","originalError","JSON_RPC_SERVER_ERROR_MESSAGE","SafeEventEmitter","createScaffoldMiddleware","createFilterMiddleware","getBlocksForRange","normalizeBlock","block","hash","parentHash","sha3Uncles","miner","stateRoot","transactionsRoot","receiptsRoot","logsBloom","difficulty","number","gasLimit","gasUsed","nonce","mixHash","timestamp","extraData","subscriptions","filterManager","isDestroyed","events","eth_subscribe","eth_unsubscribe","removeAllListeners","createSubNewHeads","createSubFromFilter","subId","_emitSubscriptionResult","subscriptionType","rawBlocks","filterParams","subscription","filterIdHex","arrayLikeToArray","iter","Symbol","iterator","from","TypeError","calculateSum","accumulator","currentValue","blockTrackerEvents","_blockResetDuration","_blockResetTimeout","_currentBlock","_onNewListener","_onRemoveListener","_resetCurrentBlock","_setupInternalEvents","once","eventName","handler","_maybeStart","_getBlockTrackerEventCount","_maybeEnd","_cancelBlockResetTimeout","_start","_setupBlockResetTimeout","_end","listenerCount","reduce","_setCurrentBlock","hexInt","object","max","MAX_SAFE_INTEGER","idCounter","start","util","EventEmitter","R","ReflectApply","Function","safeApply","arrayClone","n","copy","inherits","doError","_events","er","len","listeners","stringify","stable","deterministicStringify","stableStringify","replacerStack","defaultOptions","depthLimit","edgesLimit","replacer","spacer","decirc","val","k","edgeIndex","parent","depth","setReplace","keys","JSON","replaceGetterValues","part","defineProperty","propertyDescriptor","configurable","compareFunction","deterministicDecirc","toJSON","v","getEthJsonRpcError","validateOpts","getEthProviderError","parse","invalidRequest","invalidParams","methodNotFound","server","invalidInput","resourceNotFound","resourceUnavailable","transactionRejected","methodNotSupported","limitExceeded","userRejectedRequest","unauthorized","unsupportedMethod","disconnected","chainDisconnected","custom","mergeMiddleware","handlers","BaseFilterWithHistory","ethQuery","address","topics","_fetchLogs","newLogs","addInitialResults","matchingLogs","log","matchLog","addResults","normalizedLogAddress","every","topicPattern","logTopic","subtopicsToMatch","topic","proxy","unwrapped","arguments_","filterCache","WeakMap","input","objectType","cache","Proxy","thisArg","cached","pified","set","writableOrConfigurableOwn","writable","shouldFilter","allResults","blockHashes","blocks","blockTxHashes","transactions"],"mappings":"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","file":"static/js/0.335796d0.chunk.js","sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_maxConcurrency) {\n        this._maxConcurrency = _maxConcurrency;\n        this._queue = [];\n        if (_maxConcurrency <= 0) {\n            throw new Error('semaphore must be initialized to a positive value');\n        }\n        this._value = _maxConcurrency;\n    }\n    Semaphore.prototype.acquire = function () {\n        var _this = this;\n        var locked = this.isLocked();\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\n        if (!locked)\n            this._dispatch();\n        return ticket;\n    };\n    Semaphore.prototype.runExclusive = function (callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire()];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.release = function () {\n        if (this._maxConcurrency > 1) {\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n        }\n        if (this._currentReleaser) {\n            var releaser = this._currentReleaser;\n            this._currentReleaser = undefined;\n            releaser();\n        }\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _this = this;\n        var nextConsumer = this._queue.shift();\n        if (!nextConsumer)\n            return;\n        var released = false;\n        this._currentReleaser = function () {\n            if (released)\n                return;\n            released = true;\n            _this._value++;\n            _this._dispatch();\n        };\n        nextConsumer([this._value--, this._currentReleaser]);\n    };\n    return Semaphore;\n}());\nexport default Semaphore;\n","import { __awaiter, __generator } from \"tslib\";\nimport Semaphore from './Semaphore';\nvar Mutex = /** @class */ (function () {\n    function Mutex() {\n        this._semaphore = new Semaphore(1);\n    }\n    Mutex.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, releaser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this._semaphore.acquire()];\n                    case 1:\n                        _a = _b.sent(), releaser = _a[1];\n                        return [2 /*return*/, releaser];\n                }\n            });\n        });\n    };\n    Mutex.prototype.runExclusive = function (callback) {\n        return this._semaphore.runExclusive(function () { return callback(); });\n    };\n    Mutex.prototype.isLocked = function () {\n        return this._semaphore.isLocked();\n    };\n    Mutex.prototype.release = function () {\n        this._semaphore.release();\n    };\n    return Mutex;\n}());\nexport default Mutex;\n","import { __awaiter, __generator } from \"tslib\";\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = new Error('timeout'); }\n    return {\n        acquire: function () {\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                var isTimeout, ticket, release;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            return [4 /*yield*/, sync.acquire()];\n                        case 1:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                resolve(ticket);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback) {\n            return __awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire()];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function () {\n            sync.release();\n        },\n        isLocked: function () { return sync.isLocked(); },\n    };\n}\n","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\ti;\n\tfor (i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(\n\t\ttype,\n\t\tnormalizedProps,\n\t\tprops && props.key,\n\t\tprops && props.ref,\n\t\tnull\n\t);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\tconstructor: undefined,\n\t\t_original: original\n\t};\n\n\tif (original == null) vnode._original = vnode;\n\tif (options.vnode) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn {};\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\tupdate = update(s, this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = oldVNode;\n\n\t\tlet newDom = diff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tnull,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (newDom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\nlet rerenderCount = 0;\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\nconst IS_HYDRATE = EMPTY_OBJ;\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {Element | Text} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we\n\t// are in hydration mode or not by passing `IS_HYDRATE` instead of a\n\t// DOM element.\n\tlet isHydrating = replaceNode === IS_HYDRATE;\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\tvnode = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\t((isHydrating ? parentDom : replaceNode || parentDom)._children = vnode),\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\treplaceNode && !isHydrating\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: EMPTY_ARR.slice.call(parentDom.childNodes),\n\t\tcommitQueue,\n\t\treplaceNode || EMPTY_OBJ,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, IS_HYDRATE);\n}\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue) {\n\tconst ctx = {};\n\n\tconst context = {\n\t\t_id: '__cC' + i++,\n\t\t_defaultValue: defaultValue,\n\t\tConsumer(props, context) {\n\t\t\treturn props.children(context);\n\t\t},\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tconst subs = [];\n\t\t\t\tthis.getChildContext = () => {\n\t\t\t\t\tctx[context._id] = this;\n\t\t\t\t\treturn ctx;\n\t\t\t\t};\n\n\t\t\t\tthis.shouldComponentUpdate = _props => {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\tsubs.some(c => {\n\t\t\t\t\t\t\tc.context = _props.value;\n\t\t\t\t\t\t\tenqueueRender(c);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\told && old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\tcontext.Consumer.contextType = context;\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\tcontext.Provider._contextRef = context;\n\n\treturn context;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { removeNode } from '../util';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Node | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, newDom, sibDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\t// Only in very specific places should this logic be invoked (top level `render` and `diffElementNodes`).\n\t// I'm using `EMPTY_OBJ` to signal when `diffChildren` is invoked in these situations. I can't use `null`\n\t// for this purpose, because `null` is a valid value for `oldDom` which can mean to skip to this logic\n\t// (e.g. if mounting a new tree in which the old DOM should be ignored (usually for Fragments).\n\tif (oldDom == EMPTY_OBJ) {\n\t\tif (excessDomChildren != null) {\n\t\t\toldDom = excessDomChildren[0];\n\t\t} else if (oldChildrenLength) {\n\t\t\toldDom = getDomSibling(oldParentVNode, 0);\n\t\t} else {\n\t\t\toldDom = null;\n\t\t}\n\t}\n\n\ti = 0;\n\tnewParentVNode._children = toChildArray(\n\t\tnewParentVNode._children,\n\t\tchildVNode => {\n\t\t\tif (childVNode != null) {\n\t\t\t\tchildVNode._parent = newParentVNode;\n\t\t\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t\t\t// Check if we find a corresponding element in oldChildren.\n\t\t\t\t// If found, delete the array item by setting to `undefined`.\n\t\t\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t\t\t// (holes).\n\t\t\t\toldVNode = oldChildren[i];\n\n\t\t\t\tif (\n\t\t\t\t\toldVNode === null ||\n\t\t\t\t\t(oldVNode &&\n\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t\t\t) {\n\t\t\t\t\toldChildren[i] = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t\t\t// We always match by type (in either case).\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\toldVNode &&\n\t\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldVNode = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\t\t\tnewDom = diff(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\tglobalContext,\n\t\t\t\t\tisSvg,\n\t\t\t\t\texcessDomChildren,\n\t\t\t\t\tcommitQueue,\n\t\t\t\t\toldDom,\n\t\t\t\t\tisHydrating\n\t\t\t\t);\n\n\t\t\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\t\t\tif (!refs) refs = [];\n\t\t\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t\t\t}\n\n\t\t\t\t// Only proceed if the vnode has not been unmounted by `diff()` above.\n\t\t\t\tif (newDom != null) {\n\t\t\t\t\tif (firstChildDom == null) {\n\t\t\t\t\t\tfirstChildDom = newDom;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet nextDom;\n\t\t\t\t\tif (childVNode._nextDom !== undefined) {\n\t\t\t\t\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t\t\t\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t\t\t\t\t// of last DOM child of this child VNode\n\t\t\t\t\t\tnextDom = childVNode._nextDom;\n\n\t\t\t\t\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t\t\t\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t\t\t\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t\t\t\t\t// can clean up the property\n\t\t\t\t\t\tchildVNode._nextDom = undefined;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\texcessDomChildren == oldVNode ||\n\t\t\t\t\t\tnewDom != oldDom ||\n\t\t\t\t\t\tnewDom.parentNode == null\n\t\t\t\t\t) {\n\t\t\t\t\t\t// NOTE: excessDomChildren==oldVNode above:\n\t\t\t\t\t\t// This is a compression of excessDomChildren==null && oldVNode==null!\n\t\t\t\t\t\t// The values only have the same type when `null`.\n\n\t\t\t\t\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\t\t\t\t\tparentDom.appendChild(newDom);\n\t\t\t\t\t\t\tnextDom = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\t\tsibDom = oldDom, j = 0;\n\t\t\t\t\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildrenLength;\n\t\t\t\t\t\t\t\tj += 2\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\t\t\t\t\tnextDom = oldDom;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t\t\t\t// there are probably some internal data structures that aren't\n\t\t\t\t\t\t// updated properly.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t\t\t\t// value check in `diff()` won't be skipped.\n\t\t\t\t\t\tif (newParentVNode.type == 'option') {\n\t\t\t\t\t\t\tparentDom.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t\t\t\t\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t\t\t\t\t// See more detail in create-element.js:createVNode\n\t\t\t\t\tif (nextDom !== undefined) {\n\t\t\t\t\t\toldDom = nextDom;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldDom = newDom.nextSibling;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t\t\t// node's nextSibling.\n\n\t\t\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\toldDom &&\n\t\t\t\t\toldVNode._dom == oldDom &&\n\t\t\t\t\toldDom.parentNode != parentDom\n\t\t\t\t) {\n\t\t\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\t\t\toldDom = getDomSibling(oldVNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti++;\n\t\t\treturn childVNode;\n\t\t}\n\t);\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove children that are not part of any vnode.\n\tif (excessDomChildren != null && typeof newParentVNode.type != 'function') {\n\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t}\n\t}\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) unmount(oldChildren[i], oldChildren[i]);\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @param {(vnode: import('../internal').VNode) => import('../internal').VNode} [callback]\n * A function to invoke for each child before it is added to the flattened list.\n * @param {Array<import('../internal').VNode | string | number>} [flattened] An flat array of children to modify\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, callback, flattened) {\n\tif (flattened == null) flattened = [];\n\n\tif (children == null || typeof children == 'boolean') {\n\t\tif (callback) flattened.push(callback(null));\n\t} else if (Array.isArray(children)) {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\ttoChildArray(children[i], callback, flattened);\n\t\t}\n\t} else if (!callback) {\n\t\tflattened.push(children);\n\t} else if (typeof children == 'string' || typeof children == 'number') {\n\t\tflattened.push(callback(createVNode(null, children, null, null, children)));\n\t} else if (children._dom != null || children._component != null) {\n\t\tflattened.push(\n\t\t\tcallback(\n\t\t\t\tcreateVNode(\n\t\t\t\t\tchildren.type,\n\t\t\t\t\tchildren.props,\n\t\t\t\t\tchildren.key,\n\t\t\t\t\tnull,\n\t\t\t\t\tchildren._original\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tflattened.push(callback(children));\n\t}\n\n\treturn flattened;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (\n\t\ttypeof value == 'number' &&\n\t\tIS_NON_DIMENSIONAL.test(key) === false\n\t) {\n\t\tstyle[key] = value + 'px';\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else {\n\t\tstyle[key] = value;\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet s, useCapture, nameLower;\n\n\tif (isSvg) {\n\t\tif (name === 'className') {\n\t\t\tname = 'class';\n\t\t}\n\t} else if (name === 'class') {\n\t\tname = 'className';\n\t}\n\n\tif (name === 'style') {\n\t\ts = dom.style;\n\n\t\tif (typeof value == 'string') {\n\t\t\ts.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\ts.cssText = '';\n\t\t\t\toldValue = null;\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (let i in oldValue) {\n\t\t\t\t\tif (!(value && i in value)) {\n\t\t\t\t\t\tsetStyle(s, i, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (let i in value) {\n\t\t\t\t\tif (!oldValue || value[i] !== oldValue[i]) {\n\t\t\t\t\t\tsetStyle(s, i, value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tnameLower = name.toLowerCase();\n\t\tname = (nameLower in dom ? nameLower : name).slice(2);\n\n\t\tif (value) {\n\t\t\tif (!oldValue) dom.addEventListener(name, eventProxy, useCapture);\n\t\t\t(dom._listeners || (dom._listeners = {}))[name] = value;\n\t\t} else {\n\t\t\tdom.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t} else if (\n\t\tname !== 'list' &&\n\t\tname !== 'tagName' &&\n\t\t// HTMLButtonElement.form and HTMLInputElement.form are read-only but can be set using\n\t\t// setAttribute\n\t\tname !== 'form' &&\n\t\tname !== 'type' &&\n\t\tname !== 'size' &&\n\t\t!isSvg &&\n\t\tname in dom\n\t) {\n\t\tdom[name] = value == null ? '' : value;\n\t} else if (typeof value != 'function' && name !== 'dangerouslySetInnerHTML') {\n\t\tif (name !== (name = name.replace(/^xlink:?/, ''))) {\n\t\t\tif (value == null || value === false) {\n\t\t\t\tdom.removeAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdom.setAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase(),\n\t\t\t\t\tvalue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tvalue == null ||\n\t\t\t(value === false &&\n\t\t\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t\t\t// The value `false` is different from the attribute not\n\t\t\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t\t\t// that other VDOM frameworks also always stringify `false`.\n\t\t\t\t!/^ar/.test(name))\n\t\t) {\n\t\t\tdom.removeAttribute(name);\n\t\t} else {\n\t\t\tdom.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Element | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\t(newVNode._original === oldVNode._original && !c._processingException)\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (tmp = 0; tmp < newVNode._children.length; tmp++) {\n\t\t\t\t\t\tif (newVNode._children[tmp]) {\n\t\t\t\t\t\t\tnewVNode._children[tmp]._parent = newVNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type == Fragment && tmp.key == null;\n\t\t\tnewVNode._children = isTopLevelFragment\n\t\t\t\t? tmp.props.children\n\t\t\t\t: Array.isArray(tmp)\n\t\t\t\t? tmp\n\t\t\t\t: [tmp];\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n\n\treturn newVNode._dom;\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet i;\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvg = newVNode.type === 'svg' || isSvg;\n\n\tif (excessDomChildren != null) {\n\t\tfor (i = 0; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild != null &&\n\t\t\t\t((newVNode.type === null\n\t\t\t\t\t? child.nodeType === 3\n\t\t\t\t\t: child.localName === newVNode.type) ||\n\t\t\t\t\tdom == child)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (newVNode.type === null) {\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tdom = isSvg\n\t\t\t? document.createElementNS('http://www.w3.org/2000/svg', newVNode.type)\n\t\t\t: document.createElement(\n\t\t\t\t\tnewVNode.type,\n\t\t\t\t\tnewProps.is && { is: newProps.is }\n\t\t\t  );\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (newVNode.type === null) {\n\t\tif (oldProps !== newProps && dom.data != newProps) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\tif (excessDomChildren != null) {\n\t\t\texcessDomChildren = EMPTY_ARR.slice.call(dom.childNodes);\n\t\t}\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\tif (oldProps === EMPTY_OBJ) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (!newHtml || !oldHtml || newHtml.__html != oldHtml.__html) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\tnewVNode._children = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tnewVNode.type === 'foreignObject' ? false : isSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tEMPTY_OBJ,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\ti !== dom.value\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { assign } from './util';\nimport { EMPTY_ARR } from './constants';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./index').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props) {\n\tprops = assign(assign({}, vnode.props), props);\n\tif (arguments.length > 2) props.children = EMPTY_ARR.slice.call(arguments, 2);\n\tlet normalizedProps = {};\n\tfor (const i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tprops.key || vnode.key,\n\t\tprops.ref || vnode.ref,\n\t\tnull\n\t);\n}\n","import { enqueueRender } from '../component';\n\n/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, hasCaught;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tif (\n\t\t\t\t\tcomponent.constructor &&\n\t\t\t\t\tcomponent.constructor.getDerivedStateFromError != null\n\t\t\t\t) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.setState(\n\t\t\t\t\t\tcomponent.constructor.getDerivedStateFromError(error)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t}\n\n\t\t\t\tif (hasCaught)\n\t\t\t\t\treturn enqueueRender((component._pendingError = component));\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tif (currentComponent.__hooks) {\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\tcurrentComponent.__hooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\tif (hooks._pendingEffects.length) {\n\t\t\tafterPaint(afterPaintEffects.push(c));\n\t\t}\n\t}\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\ttry {\n\t\t\thooks._list.forEach(hook => hook._cleanup && hook._cleanup());\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {import('./internal').HookState}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} initialState\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\tif (!hookState._component) {\n\t\thookState._component = currentComponent;\n\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value[0] = nextValue;\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t\treturn (state._value = factory());\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\nexport function useErrorBoundary(cb) {\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.some(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tcancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (typeof window != 'undefined') {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\tif (hook._cleanup) hook._cleanup();\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\tconst result = hook._value();\n\tif (typeof result == 'function') hook._cleanup = result;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn !oldArgs || newArgs.some((arg, index) => arg !== oldArgs[index]);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","\nmodule.exports = {\n  minBlockRef,\n  maxBlockRef,\n  sortBlockRefs,\n  bnToHex,\n  blockRefIsNumber,\n  hexToInt,\n  incrementHexInt,\n  intToHex,\n  unsafeRandomBytes,\n}\n\nfunction minBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[0]\n}\n\nfunction maxBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[sortedRefs.length-1]\n}\n\nfunction sortBlockRefs(refs) {\n  return refs.sort((refA, refB) => {\n    if (refA === 'latest' || refB === 'earliest') return 1\n    if (refB === 'latest' || refA === 'earliest') return -1\n    return hexToInt(refA) - hexToInt(refB)\n  })\n}\n\nfunction bnToHex(bn) {\n  return '0x' + bn.toString(16)\n}\n\nfunction blockRefIsNumber(blockRef){\n  return blockRef && !['earliest', 'latest', 'pending'].includes(blockRef)\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  let hexString = int.toString(16)\n  const needsLeftPad = hexString.length % 2\n  if (needsLeftPad) hexString = '0' + hexString\n  return '0x' + hexString\n}\n\nfunction unsafeRandomBytes(byteCount) {\n  let result = '0x'\n  for (let i = 0; i < byteCount; i++) {\n    result += unsafeRandomNibble()\n    result += unsafeRandomNibble()\n  }\n  return result\n}\n\nfunction unsafeRandomNibble() {\n  return Math.floor(Math.random() * 16).toString(16)\n}\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = require(\"events\");\nfunction safeApply(handler, context, args) {\n    try {\n        Reflect.apply(handler, context, args);\n    }\n    catch (err) {\n        // Throw error after timeout so as not to interrupt the stack\n        setTimeout(() => {\n            throw err;\n        });\n    }\n}\nfunction arrayClone(arr) {\n    const n = arr.length;\n    const copy = new Array(n);\n    for (let i = 0; i < n; i += 1) {\n        copy[i] = arr[i];\n    }\n    return copy;\n}\nclass SafeEventEmitter extends events_1.EventEmitter {\n    emit(type, ...args) {\n        let doError = type === 'error';\n        const events = this._events;\n        if (events !== undefined) {\n            doError = doError && events.error === undefined;\n        }\n        else if (!doError) {\n            return false;\n        }\n        // If there is no 'error' event listener then throw.\n        if (doError) {\n            let er;\n            if (args.length > 0) {\n                [er] = args;\n            }\n            if (er instanceof Error) {\n                // Note: The comments on the `throw` lines are intentional, they show\n                // up in Node's output if this results in an unhandled exception.\n                throw er; // Unhandled 'error' event\n            }\n            // At least give some kind of context to the user\n            const err = new Error(`Unhandled error.${er ? ` (${er.message})` : ''}`);\n            err.context = er;\n            throw err; // Unhandled 'error' event\n        }\n        const handler = events[type];\n        if (handler === undefined) {\n            return false;\n        }\n        if (typeof handler === 'function') {\n            safeApply(handler, this, args);\n        }\n        else {\n            const len = handler.length;\n            const listeners = arrayClone(handler);\n            for (let i = 0; i < len; i += 1) {\n                safeApply(listeners[i], this, args);\n            }\n        }\n        return true;\n    }\n}\nexports.default = SafeEventEmitter;\n//# sourceMappingURL=index.js.map","\nconst safeStringify = require('fast-safe-stringify')\n\n/**\n * @class JsonRpcError\n * Error subclass implementing JSON RPC 2.0 errors and Ethereum RPC errors\n * per EIP 1474.\n * Permits any integer error code.\n */\nclass EthereumRpcError extends Error {\n\n  /**\n   * Create an Ethereum JSON RPC error.\n   *\n   * @param {number} code - The integer error code.\n   * @param {string} message - The string message.\n   * @param {any} [data] - The error data.\n   */\n  constructor (code, message, data) {\n\n    if (!Number.isInteger(code)) {\n      throw new Error(\n        '\"code\" must be an integer.',\n      )\n    }\n    if (!message || typeof message !== 'string') {\n      throw new Error(\n        '\"message\" must be a nonempty string.',\n      )\n    }\n\n    super(message)\n    this.code = code\n    if (data !== undefined) {\n      this.data = data\n    }\n  }\n\n  /**\n   * Returns a plain object with all public class properties.\n   *\n   * @returns {object} The serialized error.\n   */\n  serialize () {\n    const serialized = {\n      code: this.code,\n      message: this.message,\n    }\n    if (this.data !== undefined) {\n      serialized.data = this.data\n    }\n    if (this.stack) {\n      serialized.stack = this.stack\n    }\n    return serialized\n  }\n\n  /**\n   * Return a string representation of the serialized error, omitting\n   * any circular references.\n   *\n   * @returns {string} The serialized error as a string.\n   */\n  toString () {\n    return safeStringify(\n      this.serialize(),\n      stringifyReplacer,\n      2,\n    )\n  }\n}\n\n/**\n * @class EthereumRpcError\n * Error subclass implementing Ethereum Provider errors per EIP 1193.\n * Permits integer error codes in the [ 1000 <= 4999 ] range.\n */\nclass EthereumProviderError extends EthereumRpcError {\n\n  /**\n   * Create an Ethereum JSON RPC error.\n   *\n   * @param {number} code - The integer error code, in the [ 1000 <= 4999 ] range.\n   * @param {string} message - The string message.\n   * @param {any} [data] - The error data.\n   */\n  constructor (code, message, data) {\n\n    if (!isValidEthProviderCode(code)) {\n      throw new Error(\n        '\"code\" must be an integer such that: 1000 <= code <= 4999',\n      )\n    }\n\n    super(code, message, data)\n  }\n}\n\n// Internal\n\nfunction isValidEthProviderCode (code) {\n  return Number.isInteger(code) && code >= 1000 && code <= 4999\n}\n\nfunction stringifyReplacer (_, value) {\n  if (value === '[Circular]') {\n    return undefined\n  }\n  return value\n}\n\n// Exports\n\nmodule.exports = {\n  EthereumRpcError,\n  EthereumProviderError,\n}\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\n\nclass BaseFilter extends SafeEventEmitter {\n\n  constructor () {\n    super()\n    this.updates = []\n  }\n\n  async initialize () {}\n\n  async update () {\n    throw new Error('BaseFilter - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.updates = this.updates.concat(newResults)\n    newResults.forEach(result => this.emit('update', result))\n  }\n\n  addInitialResults (newResults) {}\n\n  getChangesAndClear () {\n    const updates = this.updates\n    this.updates = []\n    return updates\n  }\n  \n}\n\nmodule.exports = BaseFilter\n","module.exports = getBlocksForRange\n\nasync function getBlocksForRange({ provider, fromBlock, toBlock }) {\n  if (!fromBlock) fromBlock = toBlock\n\n  const fromBlockNumber = hexToInt(fromBlock)\n  const toBlockNumber = hexToInt(toBlock)\n  const blockCountToQuery = toBlockNumber - fromBlockNumber + 1\n  // load all blocks from old to new (inclusive)\n  const missingBlockNumbers = Array(blockCountToQuery).fill()\n                              .map((_,index) => fromBlockNumber + index)\n                              .map(intToHex)\n  const blockBodies = await Promise.all(\n    missingBlockNumbers.map(blockNum => query(provider, 'eth_getBlockByNumber', [blockNum, false]))\n  )\n  return blockBodies\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  const hexString = int.toString(16)\n  return '0x' + hexString\n}\n\nfunction query(provider, method, params) {\n  return new Promise((resolve, reject) => {\n    provider.sendAsync({ id: 1, jsonrpc: '2.0', method, params }, (err, res) => {\n      if (err) return reject(err)\n      resolve(res.result)\n    })\n  })\n}\n","const pify = require('pify')\nconst BaseBlockTracker = require('./base')\n\nconst sec = 1000\n\nclass PollingBlockTracker extends BaseBlockTracker {\n\n  constructor (opts = {}) {\n    // parse + validate args\n    if (!opts.provider) throw new Error('PollingBlockTracker - no provider specified.')\n    const pollingInterval = opts.pollingInterval || 20 * sec\n    const retryTimeout = opts.retryTimeout || pollingInterval / 10\n    const keepEventLoopActive = opts.keepEventLoopActive !== undefined ? opts.keepEventLoopActive : true\n    const setSkipCacheFlag = opts.setSkipCacheFlag || false\n    // BaseBlockTracker constructor\n    super(Object.assign({\n      blockResetDuration: pollingInterval,\n    }, opts))\n    // config\n    this._provider = opts.provider\n    this._pollingInterval = pollingInterval\n    this._retryTimeout = retryTimeout\n    this._keepEventLoopActive = keepEventLoopActive\n    this._setSkipCacheFlag = setSkipCacheFlag\n  }\n\n  //\n  // public\n  //\n\n  // trigger block polling\n  async checkForLatestBlock () {\n    await this._updateLatestBlock()\n    return await this.getLatestBlock()\n  }\n\n  //\n  // private\n  //\n\n  _start () {\n    this._performSync().catch(err => this.emit('error', err))\n  }\n\n  async _performSync () {\n    while (this._isRunning) {\n      try {\n        await this._updateLatestBlock()\n        await timeout(this._pollingInterval, !this._keepEventLoopActive)\n      } catch (err) {\n        const newErr = new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\\n${err.stack}`)\n        try {\n          this.emit('error', newErr)\n        } catch (emitErr) {\n          console.error(newErr)\n        }\n        await timeout(this._retryTimeout, !this._keepEventLoopActive)\n      }\n    }\n  }\n\n  async _updateLatestBlock () {\n    // fetch + set latest block\n    const latestBlock = await this._fetchLatestBlock()\n    this._newPotentialLatest(latestBlock)\n  }\n\n  async _fetchLatestBlock () {\n    const req = { jsonrpc: \"2.0\", id: 1, method: 'eth_blockNumber', params: [] }\n    if (this._setSkipCacheFlag) req.skipCache = true\n    const res = await pify((cb) => this._provider.sendAsync(req, cb))()\n    if (res.error) throw new Error(`PollingBlockTracker - encountered error fetching block:\\n${res.error}`)\n    return res.result\n  }\n\n}\n\nmodule.exports = PollingBlockTracker\n\nfunction timeout (duration, unref) {\n  return new Promise(resolve => {\n    const timoutRef = setTimeout(resolve, duration)\n    // don't keep process open\n    if (timoutRef.unref && unref) {\n      timoutRef.unref()\n    }\n  })\n}\n","'use strict';\n\nconst processFn = (fn, opts) => function () {\n\tconst P = opts.promiseModule;\n\tconst args = new Array(arguments.length);\n\n\tfor (let i = 0; i < arguments.length; i++) {\n\t\targs[i] = arguments[i];\n\t}\n\n\treturn new P((resolve, reject) => {\n\t\tif (opts.errorFirst) {\n\t\t\targs.push(function (err, result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 1; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i - 1] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tresults.unshift(err);\n\t\t\t\t\t\treject(results);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(results);\n\t\t\t\t\t}\n\t\t\t\t} else if (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targs.push(function (result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(results);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfn.apply(this, args);\n\t});\n};\n\nmodule.exports = (obj, opts) => {\n\topts = Object.assign({\n\t\texclude: [/.+(Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise\n\t}, opts);\n\n\tconst filter = key => {\n\t\tconst match = pattern => typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\t\treturn opts.include ? opts.include.some(match) : !opts.exclude.some(match);\n\t};\n\n\tlet ret;\n\tif (typeof obj === 'function') {\n\t\tret = function () {\n\t\t\tif (opts.excludeMain) {\n\t\t\t\treturn obj.apply(this, arguments);\n\t\t\t}\n\n\t\t\treturn processFn(obj, opts).apply(this, arguments);\n\t\t};\n\t} else {\n\t\tret = Object.create(Object.getPrototypeOf(obj));\n\t}\n\n\tfor (const key in obj) { // eslint-disable-line guard-for-in\n\t\tconst x = obj[key];\n\t\tret[key] = typeof x === 'function' && filter(key) ? processFn(x, opts) : x;\n\t}\n\n\treturn ret;\n};\n","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","const extend = require('xtend')\nconst createRandomId = require('json-rpc-random-id')()\n\nmodule.exports = EthQuery\n\n\nfunction EthQuery(provider){\n  const self = this\n  self.currentProvider = provider\n}\n\n//\n// base queries\n//\n\n// default block\nEthQuery.prototype.getBalance =                          generateFnWithDefaultBlockFor(2, 'eth_getBalance')\nEthQuery.prototype.getCode =                             generateFnWithDefaultBlockFor(2, 'eth_getCode')\nEthQuery.prototype.getTransactionCount =                 generateFnWithDefaultBlockFor(2, 'eth_getTransactionCount')\nEthQuery.prototype.getStorageAt =                        generateFnWithDefaultBlockFor(3, 'eth_getStorageAt')\nEthQuery.prototype.call =                                generateFnWithDefaultBlockFor(2, 'eth_call')\n// standard\nEthQuery.prototype.protocolVersion =                     generateFnFor('eth_protocolVersion')\nEthQuery.prototype.syncing =                             generateFnFor('eth_syncing')\nEthQuery.prototype.coinbase =                            generateFnFor('eth_coinbase')\nEthQuery.prototype.mining =                              generateFnFor('eth_mining')\nEthQuery.prototype.hashrate =                            generateFnFor('eth_hashrate')\nEthQuery.prototype.gasPrice =                            generateFnFor('eth_gasPrice')\nEthQuery.prototype.accounts =                            generateFnFor('eth_accounts')\nEthQuery.prototype.blockNumber =                         generateFnFor('eth_blockNumber')\nEthQuery.prototype.getBlockTransactionCountByHash =      generateFnFor('eth_getBlockTransactionCountByHash')\nEthQuery.prototype.getBlockTransactionCountByNumber =    generateFnFor('eth_getBlockTransactionCountByNumber')\nEthQuery.prototype.getUncleCountByBlockHash =            generateFnFor('eth_getUncleCountByBlockHash')\nEthQuery.prototype.getUncleCountByBlockNumber =          generateFnFor('eth_getUncleCountByBlockNumber')\nEthQuery.prototype.sign =                                generateFnFor('eth_sign')\nEthQuery.prototype.sendTransaction =                     generateFnFor('eth_sendTransaction')\nEthQuery.prototype.sendRawTransaction =                  generateFnFor('eth_sendRawTransaction')\nEthQuery.prototype.estimateGas =                         generateFnFor('eth_estimateGas')\nEthQuery.prototype.getBlockByHash =                      generateFnFor('eth_getBlockByHash')\nEthQuery.prototype.getBlockByNumber =                    generateFnFor('eth_getBlockByNumber')\nEthQuery.prototype.getTransactionByHash =                generateFnFor('eth_getTransactionByHash')\nEthQuery.prototype.getTransactionByBlockHashAndIndex =   generateFnFor('eth_getTransactionByBlockHashAndIndex')\nEthQuery.prototype.getTransactionByBlockNumberAndIndex = generateFnFor('eth_getTransactionByBlockNumberAndIndex')\nEthQuery.prototype.getTransactionReceipt =               generateFnFor('eth_getTransactionReceipt')\nEthQuery.prototype.getUncleByBlockHashAndIndex =         generateFnFor('eth_getUncleByBlockHashAndIndex')\nEthQuery.prototype.getUncleByBlockNumberAndIndex =       generateFnFor('eth_getUncleByBlockNumberAndIndex')\nEthQuery.prototype.getCompilers =                        generateFnFor('eth_getCompilers')\nEthQuery.prototype.compileLLL =                          generateFnFor('eth_compileLLL')\nEthQuery.prototype.compileSolidity =                     generateFnFor('eth_compileSolidity')\nEthQuery.prototype.compileSerpent =                      generateFnFor('eth_compileSerpent')\nEthQuery.prototype.newFilter =                           generateFnFor('eth_newFilter')\nEthQuery.prototype.newBlockFilter =                      generateFnFor('eth_newBlockFilter')\nEthQuery.prototype.newPendingTransactionFilter =         generateFnFor('eth_newPendingTransactionFilter')\nEthQuery.prototype.uninstallFilter =                     generateFnFor('eth_uninstallFilter')\nEthQuery.prototype.getFilterChanges =                    generateFnFor('eth_getFilterChanges')\nEthQuery.prototype.getFilterLogs =                       generateFnFor('eth_getFilterLogs')\nEthQuery.prototype.getLogs =                             generateFnFor('eth_getLogs')\nEthQuery.prototype.getWork =                             generateFnFor('eth_getWork')\nEthQuery.prototype.submitWork =                          generateFnFor('eth_submitWork')\nEthQuery.prototype.submitHashrate =                      generateFnFor('eth_submitHashrate')\n\n// network level\n\nEthQuery.prototype.sendAsync = function(opts, cb){\n  const self = this\n  self.currentProvider.sendAsync(createPayload(opts), function(err, response){\n    if (!err && response.error) err = new Error('EthQuery - RPC Error - '+response.error.message)\n    if (err) return cb(err)\n    cb(null, response.result)\n  })\n}\n\n// util\n\nfunction generateFnFor(methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction generateFnWithDefaultBlockFor(argCount, methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    // set optional default block param\n    if (args.length < argCount) args.push('latest')\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction createPayload(data){\n  return extend({\n    // defaults\n    id: createRandomId(),\n    jsonrpc: '2.0',\n    params: [],\n    // user-specified\n  }, data)\n}\n","const Mutex = require('async-mutex').Mutex\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createJsonRpcMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst LogFilter = require('./log-filter.js')\nconst BlockFilter = require('./block-filter.js')\nconst TxFilter = require('./tx-filter.js')\nconst { intToHex, hexToInt } = require('./hexUtils')\n\nmodule.exports = createEthFilterMiddleware\n\nfunction createEthFilterMiddleware({ blockTracker, provider }) {\n\n  // create filter collection\n  let filterIndex = 0\n  let filters = {}\n  // create update mutex\n  const mutex = new Mutex()\n  const waitForFree = mutexMiddlewareWrapper({ mutex })\n\n  const middleware = createJsonRpcMiddleware({\n    // install filters\n    eth_newFilter:                   waitForFree(toFilterCreationMiddleware(newLogFilter)),\n    eth_newBlockFilter:              waitForFree(toFilterCreationMiddleware(newBlockFilter)),\n    eth_newPendingTransactionFilter: waitForFree(toFilterCreationMiddleware(newPendingTransactionFilter)),\n    // uninstall filters\n    eth_uninstallFilter:             waitForFree(toAsyncRpcMiddleware(uninstallFilterHandler)),\n    // checking filter changes\n    eth_getFilterChanges:            waitForFree(toAsyncRpcMiddleware(getFilterChanges)),\n    eth_getFilterLogs:               waitForFree(toAsyncRpcMiddleware(getFilterLogs)),\n  })\n\n  // setup filter updating and destroy handler\n  const filterUpdater = async ({ oldBlock, newBlock }) => {\n    if (filters.length === 0) return\n    // lock update reads\n    const releaseLock = await mutex.acquire()\n    try {\n      // process all filters in parallel\n      await Promise.all(objValues(filters).map(async (filter) => {\n        try {\n         await filter.update({ oldBlock, newBlock })\n        } catch (err) {\n          // handle each error individually so filter update errors don't affect other filters\n          console.error(err)\n        }\n      }))\n    } catch (err) {\n      // log error so we don't skip the releaseLock\n      console.error(err)\n    }\n    // unlock update reads\n    releaseLock()\n  }\n\n  // expose filter methods directly\n  middleware.newLogFilter = newLogFilter\n  middleware.newBlockFilter = newBlockFilter\n  middleware.newPendingTransactionFilter = newPendingTransactionFilter\n  middleware.uninstallFilter = uninstallFilterHandler\n  middleware.getFilterChanges = getFilterChanges\n  middleware.getFilterLogs = getFilterLogs\n\n  // expose destroy method for cleanup\n  middleware.destroy = () => {\n    uninstallAllFilters()\n  }\n\n  return middleware\n\n  //\n  // new filters\n  //\n\n  async function newLogFilter(params) {\n    const filter = new LogFilter({ provider, params })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newBlockFilter() {\n    const filter = new BlockFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newPendingTransactionFilter() {\n    const filter = new TxFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  //\n  // get filter changes\n  //\n\n  async function getFilterChanges(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    const results = filter.getChangesAndClear()\n    return results\n  }\n\n  async function getFilterLogs(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    // only return results for log filters\n    if (filter.type === 'log') {\n      results = filter.getAllResults()\n    } else {\n      results = []\n    }\n    return results\n  }\n\n\n  //\n  // remove filters\n  //\n\n\n  async function uninstallFilterHandler(filterIndexHex) {\n    // check filter exists\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    const result = Boolean(filter)\n    // uninstall filter\n    if (result) {\n      await uninstallFilter(filterIndex)\n    }\n    return result\n  }\n\n  //\n  // utils\n  //\n\n  async function installFilter(filter) {\n    const prevFilterCount = objValues(filters).length\n    // install filter\n    const currentBlock = await blockTracker.getLatestBlock()\n    await filter.initialize({ currentBlock })\n    filterIndex++\n    filters[filterIndex] = filter\n    filter.id = filterIndex\n    filter.idHex = intToHex(filterIndex)\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n    return filterIndex\n  }\n\n  async function uninstallFilter(filterIndex) {\n    const prevFilterCount = objValues(filters).length\n    delete filters[filterIndex]\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n  }\n\n  async function uninstallAllFilters() {\n    const prevFilterCount = objValues(filters).length\n    filters = {}\n    // update block tracker subs\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount: 0 })\n  }\n\n  function updateBlockTrackerSubs({ prevFilterCount, newFilterCount }) {\n    // subscribe\n    if (prevFilterCount === 0 && newFilterCount > 0) {\n      blockTracker.on('sync', filterUpdater)\n      return\n    }\n    // unsubscribe\n    if (prevFilterCount > 0 && newFilterCount === 0) {\n      blockTracker.removeListener('sync', filterUpdater)\n      return\n    }\n  }\n\n}\n\n// helper for turning filter constructors into rpc middleware\nfunction toFilterCreationMiddleware(createFilterFn) {\n  return toAsyncRpcMiddleware(async (...args) => {\n    const filter = await createFilterFn(...args)\n    const result = intToHex(filter.id)\n    return result\n  })\n}\n\n// helper for pulling out req.params and setting res.result\nfunction toAsyncRpcMiddleware(asyncFn) {\n  return createAsyncMiddleware(async (req, res) => {\n    const result = await asyncFn.apply(null, req.params)\n    res.result = result\n  })\n}\n\nfunction mutexMiddlewareWrapper({ mutex }) {\n  return (middleware) => {\n    return async (req, res, next, end) => {\n      // wait for mutex available\n      // we can release immediately because\n      // we just need to make sure updates aren't active\n      const releaseLock = await mutex.acquire()\n      releaseLock()\n      middleware(req, res, next, end)\n    }\n  }\n}\n\nfunction objValues(obj, fn){\n  const values = []\n  for (let key in obj) {\n    values.push(obj[key])\n  }\n  return values\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./idRemapMiddleware\"), exports);\n__exportStar(require(\"./createAsyncMiddleware\"), exports);\n__exportStar(require(\"./createScaffoldMiddleware\"), exports);\n__exportStar(require(\"./getUniqueId\"), exports);\n__exportStar(require(\"./JsonRpcEngine\"), exports);\n__exportStar(require(\"./mergeMiddleware\"), exports);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsc0RBQW9DO0FBQ3BDLDBEQUF3QztBQUN4Qyw2REFBMkM7QUFDM0MsZ0RBQThCO0FBQzlCLGtEQUFnQztBQUNoQyxvREFBa0MifQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getUniqueId = void 0;\n// uint32 (two's complement) max\n// more conservative than Number.MAX_SAFE_INTEGER\nconst MAX = 4294967295;\nlet idCounter = Math.floor(Math.random() * MAX);\nfunction getUniqueId() {\n    idCounter = (idCounter + 1) % MAX;\n    return idCounter;\n}\nexports.getUniqueId = getUniqueId;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0VW5pcXVlSWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZ2V0VW5pcXVlSWQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsZ0NBQWdDO0FBQ2hDLGlEQUFpRDtBQUNqRCxNQUFNLEdBQUcsR0FBRyxVQUFVLENBQUM7QUFDdkIsSUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUM7QUFFaEQsU0FBZ0IsV0FBVztJQUN6QixTQUFTLEdBQUcsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO0lBQ2xDLE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUM7QUFIRCxrQ0FHQyJ9","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.JsonRpcEngine = void 0;\nconst safe_event_emitter_1 = __importDefault(require(\"@metamask/safe-event-emitter\"));\nconst eth_rpc_errors_1 = require(\"eth-rpc-errors\");\n/**\n * A JSON-RPC request and response processor.\n * Give it a stack of middleware, pass it requests, and get back responses.\n */\nclass JsonRpcEngine extends safe_event_emitter_1.default {\n    constructor() {\n        super();\n        this._middleware = [];\n    }\n    /**\n     * Add a middleware function to the engine's middleware stack.\n     *\n     * @param middleware - The middleware function to add.\n     */\n    push(middleware) {\n        this._middleware.push(middleware);\n    }\n    handle(req, cb) {\n        if (cb && typeof cb !== 'function') {\n            throw new Error('\"callback\" must be a function if provided.');\n        }\n        if (Array.isArray(req)) {\n            if (cb) {\n                return this._handleBatch(req, cb);\n            }\n            return this._handleBatch(req);\n        }\n        if (cb) {\n            return this._handle(req, cb);\n        }\n        return this._promiseHandle(req);\n    }\n    /**\n     * Returns this engine as a middleware function that can be pushed to other\n     * engines.\n     *\n     * @returns This engine as a middleware function.\n     */\n    asMiddleware() {\n        return async (req, res, next, end) => {\n            try {\n                const [middlewareError, isComplete, returnHandlers,] = await JsonRpcEngine._runAllMiddleware(req, res, this._middleware);\n                if (isComplete) {\n                    await JsonRpcEngine._runReturnHandlers(returnHandlers);\n                    return end(middlewareError);\n                }\n                return next(async (handlerCallback) => {\n                    try {\n                        await JsonRpcEngine._runReturnHandlers(returnHandlers);\n                    }\n                    catch (error) {\n                        return handlerCallback(error);\n                    }\n                    return handlerCallback();\n                });\n            }\n            catch (error) {\n                return end(error);\n            }\n        };\n    }\n    async _handleBatch(reqs, cb) {\n        // The order here is important\n        try {\n            // 2. Wait for all requests to finish, or throw on some kind of fatal\n            // error\n            const responses = await Promise.all(\n            // 1. Begin executing each request in the order received\n            reqs.map(this._promiseHandle.bind(this)));\n            // 3. Return batch response\n            if (cb) {\n                return cb(null, responses);\n            }\n            return responses;\n        }\n        catch (error) {\n            if (cb) {\n                return cb(error);\n            }\n            throw error;\n        }\n    }\n    /**\n     * A promise-wrapped _handle.\n     */\n    _promiseHandle(req) {\n        return new Promise((resolve) => {\n            this._handle(req, (_err, res) => {\n                // There will always be a response, and it will always have any error\n                // that is caught and propagated.\n                resolve(res);\n            });\n        });\n    }\n    /**\n     * Ensures that the request object is valid, processes it, and passes any\n     * error and the response object to the given callback.\n     *\n     * Does not reject.\n     */\n    async _handle(callerReq, cb) {\n        if (!callerReq ||\n            Array.isArray(callerReq) ||\n            typeof callerReq !== 'object') {\n            const error = new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.invalidRequest, `Requests must be plain objects. Received: ${typeof callerReq}`, { request: callerReq });\n            return cb(error, { id: undefined, jsonrpc: '2.0', error });\n        }\n        if (typeof callerReq.method !== 'string') {\n            const error = new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.invalidRequest, `Must specify a string method. Received: ${typeof callerReq.method}`, { request: callerReq });\n            return cb(error, { id: callerReq.id, jsonrpc: '2.0', error });\n        }\n        const req = Object.assign({}, callerReq);\n        const res = {\n            id: req.id,\n            jsonrpc: req.jsonrpc,\n        };\n        let error = null;\n        try {\n            await this._processRequest(req, res);\n        }\n        catch (_error) {\n            // A request handler error, a re-thrown middleware error, or something\n            // unexpected.\n            error = _error;\n        }\n        if (error) {\n            // Ensure no result is present on an errored response\n            delete res.result;\n            if (!res.error) {\n                res.error = eth_rpc_errors_1.serializeError(error);\n            }\n        }\n        return cb(error, res);\n    }\n    /**\n     * For the given request and response, runs all middleware and their return\n     * handlers, if any, and ensures that internal request processing semantics\n     * are satisfied.\n     */\n    async _processRequest(req, res) {\n        const [error, isComplete, returnHandlers,] = await JsonRpcEngine._runAllMiddleware(req, res, this._middleware);\n        // Throw if \"end\" was not called, or if the response has neither a result\n        // nor an error.\n        JsonRpcEngine._checkForCompletion(req, res, isComplete);\n        // The return handlers should run even if an error was encountered during\n        // middleware processing.\n        await JsonRpcEngine._runReturnHandlers(returnHandlers);\n        // Now we re-throw the middleware processing error, if any, to catch it\n        // further up the call chain.\n        if (error) {\n            throw error;\n        }\n    }\n    /**\n     * Serially executes the given stack of middleware.\n     *\n     * @returns An array of any error encountered during middleware execution,\n     * a boolean indicating whether the request was completed, and an array of\n     * middleware-defined return handlers.\n     */\n    static async _runAllMiddleware(req, res, middlewareStack) {\n        const returnHandlers = [];\n        let error = null;\n        let isComplete = false;\n        // Go down stack of middleware, call and collect optional returnHandlers\n        for (const middleware of middlewareStack) {\n            [error, isComplete] = await JsonRpcEngine._runMiddleware(req, res, middleware, returnHandlers);\n            if (isComplete) {\n                break;\n            }\n        }\n        return [error, isComplete, returnHandlers.reverse()];\n    }\n    /**\n     * Runs an individual middleware.\n     *\n     * @returns An array of any error encountered during middleware exection,\n     * and a boolean indicating whether the request should end.\n     */\n    static _runMiddleware(req, res, middleware, returnHandlers) {\n        return new Promise((resolve) => {\n            const end = (err) => {\n                const error = err || res.error;\n                if (error) {\n                    res.error = eth_rpc_errors_1.serializeError(error);\n                }\n                // True indicates that the request should end\n                resolve([error, true]);\n            };\n            const next = (returnHandler) => {\n                if (res.error) {\n                    end(res.error);\n                }\n                else {\n                    if (returnHandler) {\n                        if (typeof returnHandler !== 'function') {\n                            end(new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: \"next\" return handlers must be functions. ` +\n                                `Received \"${typeof returnHandler}\" for request:\\n${jsonify(req)}`, { request: req }));\n                        }\n                        returnHandlers.push(returnHandler);\n                    }\n                    // False indicates that the request should not end\n                    resolve([null, false]);\n                }\n            };\n            try {\n                middleware(req, res, next, end);\n            }\n            catch (error) {\n                end(error);\n            }\n        });\n    }\n    /**\n     * Serially executes array of return handlers. The request and response are\n     * assumed to be in their scope.\n     */\n    static async _runReturnHandlers(handlers) {\n        for (const handler of handlers) {\n            await new Promise((resolve, reject) => {\n                handler((err) => (err ? reject(err) : resolve()));\n            });\n        }\n    }\n    /**\n     * Throws an error if the response has neither a result nor an error, or if\n     * the \"isComplete\" flag is falsy.\n     */\n    static _checkForCompletion(req, res, isComplete) {\n        if (!('result' in res) && !('error' in res)) {\n            throw new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: Response has no error or result for request:\\n${jsonify(req)}`, { request: req });\n        }\n        if (!isComplete) {\n            throw new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: Nothing ended request:\\n${jsonify(req)}`, { request: req });\n        }\n    }\n}\nexports.JsonRpcEngine = JsonRpcEngine;\nfunction jsonify(request) {\n    return JSON.stringify(request, null, 2);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSnNvblJwY0VuZ2luZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Kc29uUnBjRW5naW5lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHNGQUE0RDtBQUM1RCxtREFBOEU7QUF1RjlFOzs7R0FHRztBQUNILE1BQWEsYUFBYyxTQUFRLDRCQUFnQjtJQUdqRDtRQUNFLEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxJQUFJLENBQU8sVUFBbUM7UUFDNUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBaUQsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUEyQ0QsTUFBTSxDQUFDLEdBQVksRUFBRSxFQUFRO1FBQzNCLElBQUksRUFBRSxJQUFJLE9BQU8sRUFBRSxLQUFLLFVBQVUsRUFBRTtZQUNsQyxNQUFNLElBQUksS0FBSyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7U0FDL0Q7UUFFRCxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDdEIsSUFBSSxFQUFFLEVBQUU7Z0JBQ04sT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQzthQUNuQztZQUNELE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMvQjtRQUVELElBQUksRUFBRSxFQUFFO1lBQ04sT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQThCLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDekQ7UUFDRCxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBOEIsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILFlBQVk7UUFDVixPQUFPLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRTtZQUNuQyxJQUFJO2dCQUNGLE1BQU0sQ0FDSixlQUFlLEVBQ2YsVUFBVSxFQUNWLGNBQWMsRUFDZixHQUFHLE1BQU0sYUFBYSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUV0RSxJQUFJLFVBQVUsRUFBRTtvQkFDZCxNQUFNLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLENBQUMsQ0FBQztvQkFDdkQsT0FBTyxHQUFHLENBQUMsZUFBNkMsQ0FBQyxDQUFDO2lCQUMzRDtnQkFFRCxPQUFPLElBQUksQ0FBQyxLQUFLLEVBQUUsZUFBZSxFQUFFLEVBQUU7b0JBQ3BDLElBQUk7d0JBQ0YsTUFBTSxhQUFhLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDLENBQUM7cUJBQ3hEO29CQUFDLE9BQU8sS0FBSyxFQUFFO3dCQUNkLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO3FCQUMvQjtvQkFDRCxPQUFPLGVBQWUsRUFBRSxDQUFDO2dCQUMzQixDQUFDLENBQUMsQ0FBQzthQUNKO1lBQUMsT0FBTyxLQUFLLEVBQUU7Z0JBQ2QsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDbkI7UUFDSCxDQUFDLENBQUM7SUFDSixDQUFDO0lBaUJPLEtBQUssQ0FBQyxZQUFZLENBQ3hCLElBQStCLEVBQy9CLEVBQXFFO1FBRXJFLDhCQUE4QjtRQUM5QixJQUFJO1lBQ0YscUVBQXFFO1lBQ3JFLFFBQVE7WUFDUixNQUFNLFNBQVMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHO1lBQ2pDLHdEQUF3RDtZQUN4RCxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQ3pDLENBQUM7WUFFRiwyQkFBMkI7WUFDM0IsSUFBSSxFQUFFLEVBQUU7Z0JBQ04sT0FBTyxFQUFFLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO2FBQzVCO1lBQ0QsT0FBTyxTQUFTLENBQUM7U0FDbEI7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLElBQUksRUFBRSxFQUFFO2dCQUNOLE9BQU8sRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ2xCO1lBRUQsTUFBTSxLQUFLLENBQUM7U0FDYjtJQUNILENBQUM7SUFFRDs7T0FFRztJQUNLLGNBQWMsQ0FDcEIsR0FBNEI7UUFFNUIsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1lBQzdCLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFO2dCQUM5QixxRUFBcUU7Z0JBQ3JFLGlDQUFpQztnQkFDakMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2YsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLEtBQUssQ0FBQyxPQUFPLENBQ25CLFNBQWtDLEVBQ2xDLEVBQWdFO1FBRWhFLElBQ0UsQ0FBQyxTQUFTO1lBQ1YsS0FBSyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7WUFDeEIsT0FBTyxTQUFTLEtBQUssUUFBUSxFQUM3QjtZQUNBLE1BQU0sS0FBSyxHQUFHLElBQUksaUNBQWdCLENBQ2hDLDJCQUFVLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFDN0IsNkNBQTZDLE9BQU8sU0FBUyxFQUFFLEVBQy9ELEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxDQUN2QixDQUFDO1lBQ0YsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7U0FDNUQ7UUFFRCxJQUFJLE9BQU8sU0FBUyxDQUFDLE1BQU0sS0FBSyxRQUFRLEVBQUU7WUFDeEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxpQ0FBZ0IsQ0FDaEMsMkJBQVUsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUM3QiwyQ0FBMkMsT0FBTyxTQUFTLENBQUMsTUFBTSxFQUFFLEVBQ3BFLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxDQUN2QixDQUFDO1lBQ0YsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFLFNBQVMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1NBQy9EO1FBRUQsTUFBTSxHQUFHLHFCQUFpQyxTQUFTLENBQUUsQ0FBQztRQUN0RCxNQUFNLEdBQUcsR0FBb0M7WUFDM0MsRUFBRSxFQUFFLEdBQUcsQ0FBQyxFQUFFO1lBQ1YsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPO1NBQ3JCLENBQUM7UUFDRixJQUFJLEtBQUssR0FBK0IsSUFBSSxDQUFDO1FBRTdDLElBQUk7WUFDRixNQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQ3RDO1FBQUMsT0FBTyxNQUFNLEVBQUU7WUFDZixzRUFBc0U7WUFDdEUsY0FBYztZQUNkLEtBQUssR0FBRyxNQUFNLENBQUM7U0FDaEI7UUFFRCxJQUFJLEtBQUssRUFBRTtZQUNULHFEQUFxRDtZQUNyRCxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUM7WUFDbEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUU7Z0JBQ2QsR0FBRyxDQUFDLEtBQUssR0FBRywrQkFBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ25DO1NBQ0Y7UUFFRCxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsR0FBK0IsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRDs7OztPQUlHO0lBQ0ssS0FBSyxDQUFDLGVBQWUsQ0FDM0IsR0FBNEIsRUFDNUIsR0FBb0M7UUFFcEMsTUFBTSxDQUNKLEtBQUssRUFDTCxVQUFVLEVBQ1YsY0FBYyxFQUNmLEdBQUcsTUFBTSxhQUFhLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFdEUseUVBQXlFO1FBQ3pFLGdCQUFnQjtRQUNoQixhQUFhLENBQUMsbUJBQW1CLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUV4RCx5RUFBeUU7UUFDekUseUJBQXlCO1FBQ3pCLE1BQU0sYUFBYSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBRXZELHVFQUF1RTtRQUN2RSw2QkFBNkI7UUFDN0IsSUFBSSxLQUFLLEVBQUU7WUFDVCxNQUFNLEtBQUssQ0FBQztTQUNiO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNLLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQ3BDLEdBQTRCLEVBQzVCLEdBQW9DLEVBQ3BDLGVBQXNEO1FBUXRELE1BQU0sY0FBYyxHQUFpQyxFQUFFLENBQUM7UUFDeEQsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQztRQUV2Qix3RUFBd0U7UUFDeEUsS0FBSyxNQUFNLFVBQVUsSUFBSSxlQUFlLEVBQUU7WUFDeEMsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLEdBQUcsTUFBTSxhQUFhLENBQUMsY0FBYyxDQUN0RCxHQUFHLEVBQ0gsR0FBRyxFQUNILFVBQVUsRUFDVixjQUFjLENBQ2YsQ0FBQztZQUNGLElBQUksVUFBVSxFQUFFO2dCQUNkLE1BQU07YUFDUDtTQUNGO1FBQ0QsT0FBTyxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsY0FBYyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssTUFBTSxDQUFDLGNBQWMsQ0FDM0IsR0FBNEIsRUFDNUIsR0FBb0MsRUFDcEMsVUFBK0MsRUFDL0MsY0FBNEM7UUFFNUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1lBQzdCLE1BQU0sR0FBRyxHQUE2QixDQUFDLEdBQWEsRUFBRSxFQUFFO2dCQUN0RCxNQUFNLEtBQUssR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQztnQkFDL0IsSUFBSSxLQUFLLEVBQUU7b0JBQ1QsR0FBRyxDQUFDLEtBQUssR0FBRywrQkFBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUNuQztnQkFDRCw2Q0FBNkM7Z0JBQzdDLE9BQU8sQ0FBQyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ3pCLENBQUMsQ0FBQztZQUVGLE1BQU0sSUFBSSxHQUE4QixDQUN0QyxhQUEwQyxFQUMxQyxFQUFFO2dCQUNGLElBQUksR0FBRyxDQUFDLEtBQUssRUFBRTtvQkFDYixHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUNoQjtxQkFBTTtvQkFDTCxJQUFJLGFBQWEsRUFBRTt3QkFDakIsSUFBSSxPQUFPLGFBQWEsS0FBSyxVQUFVLEVBQUU7NEJBQ3ZDLEdBQUcsQ0FDRCxJQUFJLGlDQUFnQixDQUNsQiwyQkFBVSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQ3ZCLDJEQUEyRDtnQ0FDekQsYUFBYSxPQUFPLGFBQWEsbUJBQW1CLE9BQU8sQ0FDekQsR0FBRyxDQUNKLEVBQUUsRUFDTCxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FDakIsQ0FDRixDQUFDO3lCQUNIO3dCQUNELGNBQWMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7cUJBQ3BDO29CQUVELGtEQUFrRDtvQkFDbEQsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7aUJBQ3hCO1lBQ0gsQ0FBQyxDQUFDO1lBRUYsSUFBSTtnQkFDRixVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7YUFDakM7WUFBQyxPQUFPLEtBQUssRUFBRTtnQkFDZCxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDWjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7T0FHRztJQUNLLE1BQU0sQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQ3JDLFFBQXNDO1FBRXRDLEtBQUssTUFBTSxPQUFPLElBQUksUUFBUSxFQUFFO1lBQzlCLE1BQU0sSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7Z0JBQ3BDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3BELENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ssTUFBTSxDQUFDLG1CQUFtQixDQUNoQyxHQUE0QixFQUM1QixHQUFvQyxFQUNwQyxVQUFtQjtRQUVuQixJQUFJLENBQUMsQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sSUFBSSxHQUFHLENBQUMsRUFBRTtZQUMzQyxNQUFNLElBQUksaUNBQWdCLENBQ3hCLDJCQUFVLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFDdkIsZ0VBQWdFLE9BQU8sQ0FDckUsR0FBRyxDQUNKLEVBQUUsRUFDSCxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FDakIsQ0FBQztTQUNIO1FBQ0QsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNmLE1BQU0sSUFBSSxpQ0FBZ0IsQ0FDeEIsMkJBQVUsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUN2QiwwQ0FBMEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQ3hELEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUNqQixDQUFDO1NBQ0g7SUFDSCxDQUFDO0NBQ0Y7QUFyWUQsc0NBcVlDO0FBRUQsU0FBUyxPQUFPLENBQUMsT0FBZ0M7SUFDL0MsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDMUMsQ0FBQyJ9","\nconst { EthereumRpcError, EthereumProviderError } = require('./src/classes')\nconst {\n  serializeError, getMessageFromCode,\n} = require('./src/utils')\nconst ethErrors = require('./src/errors')\nconst ERROR_CODES = require('./src/errorCodes.json')\n\nmodule.exports = {\n  ethErrors,\n  EthereumRpcError,\n  EthereumProviderError,\n  serializeError,\n  getMessageFromCode,\n\n  /** @type ErrorCodes */\n  ERROR_CODES,\n}\n\n// Types\n\n/**\n * @typedef {Object} EthereumProviderErrorCodes\n * @property {number} userRejectedRequest\n * @property {number} unauthorized\n * @property {number} unsupportedMethod\n * @property {number} disconnected\n * @property {number} chainDisconnected\n */\n\n/**\n * @typedef {Object} EthereumRpcErrorCodes\n * @property {number} parse\n * @property {number} invalidRequest\n * @property {number} invalidParams\n * @property {number} methodNotFound\n * @property {number} limitExceeded\n * @property {number} internal\n * @property {number} invalidInput\n * @property {number} resourceNotFound\n * @property {number} resourceUnavailable\n * @property {number} transactionRejected\n * @property {number} methodNotSupported\n */\n\n/**\n * @typedef ErrorCodes\n * @property {EthereumRpcErrorCodes} rpc\n * @property {EthereumProviderErrorCodes} provider\n */\n","\nconst errorValues = require('./errorValues.json')\nconst FALLBACK_ERROR_CODE = require('./errorCodes.json').rpc.internal\nconst { EthereumRpcError } = require('./classes')\n\nconst JSON_RPC_SERVER_ERROR_MESSAGE = 'Unspecified server error.'\n\nconst FALLBACK_MESSAGE = 'Unspecified error message. This is a bug, please report it.'\n\nconst FALLBACK_ERROR = {\n  code: FALLBACK_ERROR_CODE,\n  message: getMessageFromCode(FALLBACK_ERROR_CODE),\n}\n\n/**\n * Gets the message for a given code, or a fallback message if the code has\n * no corresponding message.\n *\n * @param {number} code - The integer error code\n * @param {string} fallbackMessage - The fallback message\n * @return {string} The corresponding message or the fallback message\n */\nfunction getMessageFromCode (code, fallbackMessage = FALLBACK_MESSAGE) {\n\n  if (Number.isInteger(code)) {\n\n    const codeString = code.toString()\n\n    if (errorValues[codeString]) {\n      return errorValues[codeString].message\n    }\n    if (isJsonRpcServerError(code)) {\n      return JSON_RPC_SERVER_ERROR_MESSAGE\n    }\n  }\n  return fallbackMessage\n}\n\n/**\n * Returns whether the given code is valid.\n * A code is only valid if it has a message.\n *\n * @param {number} code - The code to check\n * @return {boolean} true if the code is valid, false otherwise.\n */\nfunction isValidCode (code) {\n\n  if (!Number.isInteger(code)) {\n    return false\n  }\n\n  const codeString = code.toString()\n  if (errorValues[codeString]) {\n    return true\n  }\n\n  if (isJsonRpcServerError(code)) {\n    return true\n  }\n\n  // TODO: allow valid codes and messages to be extended\n  // // EIP 1193 Status Codes\n  // if (code >= 4000 && code <= 4999) return true\n\n  return false\n}\n\n/**\n * Serializes the given error to an Ethereum JSON RPC-compatible error object.\n * Merely copies the given error's values if it is already compatible.\n * If the given error is not fully compatible, it will be preserved on the\n * returned object's data.originalError property.\n *\n * @param {any} error - The error to serialize.\n * @param {Object} [options] - An options object.\n * @param {Object} [options.fallbackError] - The custom fallback error values if\n * the given error is invalid.\n * @param {boolean} [options.shouldIncludeStack] - Whether the 'stack' property\n * of the given error should be included on the serialized error, if present.\n * @return {Object} A standardized, plain error object.\n */\nfunction serializeError (\n  error,\n  { fallbackError = FALLBACK_ERROR, shouldIncludeStack = false } = {},\n) {\n\n  if (\n    !fallbackError ||\n    !Number.isInteger(fallbackError.code) ||\n    typeof fallbackError.message !== 'string'\n  ) {\n    throw new Error(\n      'Must provide fallback error with integer number code and string message.',\n    )\n  }\n\n  if (error instanceof EthereumRpcError) {\n    return error.serialize()\n  }\n\n  const serialized = {}\n\n  if (error && isValidCode(error.code)) {\n\n    serialized.code = error.code\n\n    if (error.message && typeof error.message === 'string') {\n      serialized.message = error.message\n      if ('data' in error) {\n        serialized.data = error.data\n      }\n    } else {\n      serialized.message = getMessageFromCode(serialized.code)\n      serialized.data = { originalError: assignOriginalError(error) }\n    }\n\n  } else {\n    serialized.code = fallbackError.code\n    serialized.message = (\n      error && error.message\n        ? error.message\n        : fallbackError.message\n    )\n    serialized.data = { originalError: assignOriginalError(error) }\n  }\n\n  if (shouldIncludeStack && error && typeof error.stack === 'string') {\n    serialized.stack = error.stack\n  }\n  return serialized\n}\n\n// Internal\n\nfunction isJsonRpcServerError (code) {\n  return code >= -32099 && code <= -32000\n}\n\nfunction assignOriginalError (error) {\n  if (error && typeof error === 'object' && !Array.isArray(error)) {\n    return { ...error }\n  }\n  return error\n}\n\n// Exports\n\nmodule.exports = {\n  getMessageFromCode,\n  isValidCode,\n  serializeError,\n  JSON_RPC_SERVER_ERROR_MESSAGE,\n}\n","// for backwards compat\nmodule.exports = require('json-rpc-engine/src/createScaffoldMiddleware')\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\nconst createScaffoldMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createFilterMiddleware = require('./index.js')\nconst { unsafeRandomBytes, incrementHexInt } = require('./hexUtils.js')\nconst getBlocksForRange = require('./getBlocksForRange.js')\n\nmodule.exports = createSubscriptionMiddleware\n\n\nfunction createSubscriptionMiddleware({ blockTracker, provider }) {\n  // state and utilities for handling subscriptions\n  const subscriptions = {}\n  const filterManager = createFilterMiddleware({ blockTracker, provider })\n\n  // internal flag\n  let isDestroyed = false\n\n  // create subscriptionManager api object\n  const events = new SafeEventEmitter()\n  const middleware = createScaffoldMiddleware({\n    eth_subscribe: createAsyncMiddleware(subscribe),\n    eth_unsubscribe: createAsyncMiddleware(unsubscribe),\n  })\n  middleware.destroy = destroy\n  return { events, middleware }\n\n  async function subscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const subscriptionType = req.params[0]\n    // subId is 16 byte hex string\n    const subId = unsafeRandomBytes(16)\n\n    // create sub\n    let sub\n    switch (subscriptionType) {\n      case 'newHeads':\n        sub = createSubNewHeads({ subId })\n        break\n      case 'logs':\n        const filterParams = req.params[1]\n        const filter = await filterManager.newLogFilter(filterParams)\n        sub = createSubFromFilter({ subId, filter })\n        break\n      default:\n        throw new Error(`SubscriptionManager - unsupported subscription type \"${subscriptionType}\"`)\n\n    }\n    subscriptions[subId] = sub\n\n    res.result = subId\n    return\n\n    function createSubNewHeads({ subId }) {\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          blockTracker.removeListener('sync', sub.update)\n        },\n        update: async ({ oldBlock, newBlock }) => {\n          // for newHeads\n          const toBlock = newBlock\n          const fromBlock = incrementHexInt(oldBlock)\n          const rawBlocks = await getBlocksForRange({ provider, fromBlock, toBlock })\n          const results = rawBlocks.map(normalizeBlock)\n          results.forEach((value) => {\n            _emitSubscriptionResult(subId, value)\n          })\n        }\n      }\n      // check for subscription updates on new block\n      blockTracker.on('sync', sub.update)\n      return sub\n    }\n\n    function createSubFromFilter({ subId, filter }){\n      filter.on('update', result => _emitSubscriptionResult(subId, result))\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          return await filterManager.uninstallFilter(filter.idHex)\n        },\n      }\n      return sub\n    }\n  }\n\n  async function unsubscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const id = req.params[0]\n    const subscription = subscriptions[id]\n    // if missing, return \"false\" to indicate it was not removed\n    if (!subscription) {\n      res.result = false\n      return\n    }\n    // cleanup subscription\n    delete subscriptions[id]\n    await subscription.destroy()\n    res.result = true\n  }\n\n  function _emitSubscriptionResult(filterIdHex, value) {\n    events.emit('notification', {\n      jsonrpc: '2.0',\n      method: 'eth_subscription',\n      params: {\n        subscription: filterIdHex,\n        result: value,\n      },\n    })\n  }\n\n  function destroy () {\n    events.removeAllListeners()\n    for (const id in subscriptions) {\n      subscriptions[id].destroy()\n      delete subscriptions[id]\n    }\n    isDestroyed = true\n  }\n}\n\nfunction normalizeBlock(block) {\n  return {\n    hash: block.hash,\n    parentHash: block.parentHash,\n    sha3Uncles: block.sha3Uncles,\n    miner: block.miner,\n    stateRoot: block.stateRoot,\n    transactionsRoot: block.transactionsRoot,\n    receiptsRoot: block.receiptsRoot,\n    logsBloom: block.logsBloom,\n    difficulty: block.difficulty,\n    number: block.number,\n    gasLimit: block.gasLimit,\n    gasUsed: block.gasUsed,\n    nonce: block.nonce,\n    mixHash: block.mixHash,\n    timestamp: block.timestamp,\n    extraData: block.extraData,\n  }\n}\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst SafeEventEmitter = require('safe-event-emitter')\n\nconst sec = 1000\n\nconst calculateSum = (accumulator, currentValue) => accumulator + currentValue\nconst blockTrackerEvents = ['sync', 'latest']\n\nclass BaseBlockTracker extends SafeEventEmitter {\n\n  //\n  // public\n  //\n\n  constructor (opts = {}) {\n    super()\n    // config\n    this._blockResetDuration = opts.blockResetDuration || 20 * sec\n    // state\n    this._blockResetTimeout\n    this._currentBlock = null\n    this._isRunning = false\n    // bind functions for internal use\n    this._onNewListener = this._onNewListener.bind(this)\n    this._onRemoveListener = this._onRemoveListener.bind(this)\n    this._resetCurrentBlock = this._resetCurrentBlock.bind(this)\n    // listen for handler changes\n    this._setupInternalEvents()\n  }\n\n  isRunning () {\n    return this._isRunning\n  }\n\n  getCurrentBlock () {\n    return this._currentBlock\n  }\n\n  async getLatestBlock () {\n    // return if available\n    if (this._currentBlock) return this._currentBlock\n    // wait for a new latest block\n    const latestBlock = await new Promise(resolve => this.once('latest', resolve))\n    // return newly set current block\n    return latestBlock\n  }\n\n  // dont allow module consumer to remove our internal event listeners\n  removeAllListeners (eventName) {\n    // perform default behavior, preserve fn arity\n    if (eventName) {\n      super.removeAllListeners(eventName)\n    } else {\n      super.removeAllListeners()\n    }\n    // re-add internal events\n    this._setupInternalEvents()\n    // trigger stop check just in case\n    this._onRemoveListener()\n  }\n\n  //\n  // to be implemented in subclass\n  //\n\n  _start () {\n    // default behavior is noop\n  }\n\n  _end () {\n    // default behavior is noop\n  }\n\n  //\n  // private\n  //\n\n  _setupInternalEvents () {\n    // first remove listeners for idempotence\n    this.removeListener('newListener', this._onNewListener)\n    this.removeListener('removeListener', this._onRemoveListener)\n    // then add them\n    this.on('newListener', this._onNewListener)\n    this.on('removeListener', this._onRemoveListener)\n  }\n\n  _onNewListener (eventName, handler) {\n    // `newListener` is called *before* the listener is added\n    if (!blockTrackerEvents.includes(eventName)) return\n    this._maybeStart()\n  }\n\n  _onRemoveListener (eventName, handler) {\n    // `removeListener` is called *after* the listener is removed\n    if (this._getBlockTrackerEventCount() > 0) return\n    this._maybeEnd()\n  }\n\n  _maybeStart () {\n    if (this._isRunning) return\n    this._isRunning = true\n    // cancel setting latest block to stale\n    this._cancelBlockResetTimeout()\n    this._start()\n  }\n\n  _maybeEnd () {\n    if (!this._isRunning) return\n    this._isRunning = false\n    this._setupBlockResetTimeout()\n    this._end()\n  }\n\n  _getBlockTrackerEventCount () {\n    return blockTrackerEvents\n      .map(eventName => this.listenerCount(eventName))\n      .reduce(calculateSum)\n  }\n\n  _newPotentialLatest (newBlock) {\n    const currentBlock = this._currentBlock\n    // only update if blok number is higher\n    if (currentBlock && (hexToInt(newBlock) <= hexToInt(currentBlock))) return\n    this._setCurrentBlock(newBlock)\n  }\n\n  _setCurrentBlock (newBlock) {\n    const oldBlock = this._currentBlock\n    this._currentBlock = newBlock\n    this.emit('latest', newBlock)\n    this.emit('sync', { oldBlock, newBlock })\n  }\n\n  _setupBlockResetTimeout () {\n    // clear any existing timeout\n    this._cancelBlockResetTimeout()\n    // clear latest block when stale\n    this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this._blockResetDuration)\n    // nodejs - dont hold process open\n    if (this._blockResetTimeout.unref) {\n      this._blockResetTimeout.unref()\n    }\n  }\n\n  _cancelBlockResetTimeout () {\n    clearTimeout(this._blockResetTimeout)\n  }\n\n  _resetCurrentBlock () {\n    this._currentBlock = null\n  }\n\n}\n\nmodule.exports = BaseBlockTracker\n\nfunction hexToInt(hexInt) {\n  return Number.parseInt(hexInt, 16)\n}\n","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","module.exports = IdIterator\n\nfunction IdIterator(opts){\n  opts = opts || {}\n  var max = opts.max || Number.MAX_SAFE_INTEGER\n  var idCounter = typeof opts.start !== 'undefined' ? opts.start : Math.floor(Math.random() * max)\n\n  return function createRandomId () {\n    idCounter = idCounter % max\n    return idCounter++\n  }\n\n}","const util = require('util')\nconst EventEmitter = require('events/')\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n}\n\nmodule.exports = SafeEventEmitter\n\n\nfunction SafeEventEmitter() {\n  EventEmitter.call(this)\n}\n\nutil.inherits(SafeEventEmitter, EventEmitter)\n\nSafeEventEmitter.prototype.emit = function (type) {\n  // copied from https://github.com/Gozala/events/blob/master/events.js\n  // modified lines are commented with \"edited:\"\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    // edited: using safeApply\n    safeApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      // edited: using safeApply\n      safeApply(listeners[i], this, args);\n  }\n\n  return true;\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    ReflectApply(handler, context, args)\n  } catch (err) {\n    // throw error after timeout so as not to interupt the stack\n    setTimeout(() => {\n      throw err\n    })\n  }\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createIdRemapMiddleware = void 0;\nconst getUniqueId_1 = require(\"./getUniqueId\");\nfunction createIdRemapMiddleware() {\n    return (req, res, next, _end) => {\n        const originalId = req.id;\n        const newId = getUniqueId_1.getUniqueId();\n        req.id = newId;\n        res.id = newId;\n        next((done) => {\n            req.id = originalId;\n            res.id = originalId;\n            done();\n        });\n    };\n}\nexports.createIdRemapMiddleware = createIdRemapMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRSZW1hcE1pZGRsZXdhcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaWRSZW1hcE1pZGRsZXdhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsK0NBQTRDO0FBRzVDLFNBQWdCLHVCQUF1QjtJQUNyQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUU7UUFDOUIsTUFBTSxVQUFVLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUMxQixNQUFNLEtBQUssR0FBRyx5QkFBVyxFQUFFLENBQUM7UUFDNUIsR0FBRyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUM7UUFDZixHQUFHLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQztRQUNmLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ1osR0FBRyxDQUFDLEVBQUUsR0FBRyxVQUFVLENBQUM7WUFDcEIsR0FBRyxDQUFDLEVBQUUsR0FBRyxVQUFVLENBQUM7WUFDcEIsSUFBSSxFQUFFLENBQUM7UUFDVCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQztBQUNKLENBQUM7QUFaRCwwREFZQyJ9","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createAsyncMiddleware = void 0;\n/**\n * JsonRpcEngine only accepts callback-based middleware directly.\n * createAsyncMiddleware exists to enable consumers to pass in async middleware\n * functions.\n *\n * Async middleware have no \"end\" function. Instead, they \"end\" if they return\n * without calling \"next\". Rather than passing in explicit return handlers,\n * async middleware can simply await \"next\", and perform operations on the\n * response object when execution resumes.\n *\n * To accomplish this, createAsyncMiddleware passes the async middleware a\n * wrapped \"next\" function. That function calls the internal JsonRpcEngine\n * \"next\" function with a return handler that resolves a promise when called.\n *\n * The return handler will always be called. Its resolution of the promise\n * enables the control flow described above.\n */\nfunction createAsyncMiddleware(asyncMiddleware) {\n    return async (req, res, next, end) => {\n        // nextPromise is the key to the implementation\n        // it is resolved by the return handler passed to the\n        // \"next\" function\n        let resolveNextPromise;\n        const nextPromise = new Promise((resolve) => {\n            resolveNextPromise = resolve;\n        });\n        let returnHandlerCallback = null;\n        let nextWasCalled = false;\n        // This will be called by the consumer's async middleware.\n        const asyncNext = async () => {\n            nextWasCalled = true;\n            // We pass a return handler to next(). When it is called by the engine,\n            // the consumer's async middleware will resume executing.\n            // eslint-disable-next-line node/callback-return\n            next((runReturnHandlersCallback) => {\n                // This callback comes from JsonRpcEngine._runReturnHandlers\n                returnHandlerCallback = runReturnHandlersCallback;\n                resolveNextPromise();\n            });\n            await nextPromise;\n        };\n        try {\n            await asyncMiddleware(req, res, asyncNext);\n            if (nextWasCalled) {\n                await nextPromise; // we must wait until the return handler is called\n                returnHandlerCallback(null);\n            }\n            else {\n                end(null);\n            }\n        }\n        catch (error) {\n            if (returnHandlerCallback) {\n                returnHandlerCallback(error);\n            }\n            else {\n                end(error);\n            }\n        }\n    };\n}\nexports.createAsyncMiddleware = createAsyncMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQXN5bmNNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NyZWF0ZUFzeW5jTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFnQkE7Ozs7Ozs7Ozs7Ozs7Ozs7R0FnQkc7QUFDSCxTQUFnQixxQkFBcUIsQ0FDbkMsZUFBNkM7SUFFN0MsT0FBTyxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDbkMsK0NBQStDO1FBQy9DLHFEQUFxRDtRQUNyRCxrQkFBa0I7UUFDbEIsSUFBSSxrQkFBOEIsQ0FBQztRQUNuQyxNQUFNLFdBQVcsR0FBRyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1lBQzFDLGtCQUFrQixHQUFHLE9BQU8sQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztRQUVILElBQUkscUJBQXFCLEdBQVksSUFBSSxDQUFDO1FBQzFDLElBQUksYUFBYSxHQUFHLEtBQUssQ0FBQztRQUUxQiwwREFBMEQ7UUFDMUQsTUFBTSxTQUFTLEdBQUcsS0FBSyxJQUFJLEVBQUU7WUFDM0IsYUFBYSxHQUFHLElBQUksQ0FBQztZQUVyQix1RUFBdUU7WUFDdkUseURBQXlEO1lBQ3pELGdEQUFnRDtZQUNoRCxJQUFJLENBQUMsQ0FBQyx5QkFBeUIsRUFBRSxFQUFFO2dCQUNqQyw0REFBNEQ7Z0JBQzVELHFCQUFxQixHQUFHLHlCQUF5QixDQUFDO2dCQUNsRCxrQkFBa0IsRUFBRSxDQUFDO1lBQ3ZCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxXQUFXLENBQUM7UUFDcEIsQ0FBQyxDQUFDO1FBRUYsSUFBSTtZQUNGLE1BQU0sZUFBZSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFM0MsSUFBSSxhQUFhLEVBQUU7Z0JBQ2pCLE1BQU0sV0FBVyxDQUFDLENBQUMsa0RBQWtEO2dCQUNwRSxxQkFBK0MsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUN4RDtpQkFBTTtnQkFDTCxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDWDtTQUNGO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLHFCQUFxQixFQUFFO2dCQUN4QixxQkFBK0MsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUN6RDtpQkFBTTtnQkFDTCxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDWjtTQUNGO0lBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQS9DRCxzREErQ0MifQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createScaffoldMiddleware = void 0;\nfunction createScaffoldMiddleware(handlers) {\n    return (req, res, next, end) => {\n        const handler = handlers[req.method];\n        // if no handler, return\n        if (handler === undefined) {\n            return next();\n        }\n        // if handler is fn, call as middleware\n        if (typeof handler === 'function') {\n            return handler(req, res, next, end);\n        }\n        // if handler is some other value, use as result\n        res.result = handler;\n        return end();\n    };\n}\nexports.createScaffoldMiddleware = createScaffoldMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlU2NhZmZvbGRNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NyZWF0ZVNjYWZmb2xkTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFJQSxTQUFnQix3QkFBd0IsQ0FBQyxRQUV4QztJQUNDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUM3QixNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLHdCQUF3QjtRQUN4QixJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDekIsT0FBTyxJQUFJLEVBQUUsQ0FBQztTQUNmO1FBQ0QsdUNBQXVDO1FBQ3ZDLElBQUksT0FBTyxPQUFPLEtBQUssVUFBVSxFQUFFO1lBQ2pDLE9BQU8sT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQ3JDO1FBQ0QsZ0RBQWdEO1FBQy9DLEdBQStCLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQztRQUNsRCxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQWpCRCw0REFpQkMifQ==","module.exports = stringify\nstringify.default = stringify\nstringify.stable = deterministicStringify\nstringify.stableStringify = deterministicStringify\n\nvar LIMIT_REPLACE_NODE = '[...]'\nvar CIRCULAR_REPLACE_NODE = '[Circular]'\n\nvar arr = []\nvar replacerStack = []\n\nfunction defaultOptions () {\n  return {\n    depthLimit: Number.MAX_SAFE_INTEGER,\n    edgesLimit: Number.MAX_SAFE_INTEGER\n  }\n}\n\n// Regular stringify\nfunction stringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  decirc(obj, '', 0, [], undefined, 0, options)\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(obj, replacer, spacer)\n    } else {\n      res = JSON.stringify(obj, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction setReplace (replace, val, k, parent) {\n  var propertyDescriptor = Object.getOwnPropertyDescriptor(parent, k)\n  if (propertyDescriptor.get !== undefined) {\n    if (propertyDescriptor.configurable) {\n      Object.defineProperty(parent, k, { value: replace })\n      arr.push([parent, k, val, propertyDescriptor])\n    } else {\n      replacerStack.push([val, k, replace])\n    }\n  } else {\n    parent[k] = replace\n    arr.push([parent, k, val])\n  }\n}\n\nfunction decirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        decirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      var keys = Object.keys(val)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        decirc(val[key], key, i, stack, val, depth, options)\n      }\n    }\n    stack.pop()\n  }\n}\n\n// Stable-stringify\nfunction compareFunction (a, b) {\n  if (a < b) {\n    return -1\n  }\n  if (a > b) {\n    return 1\n  }\n  return 0\n}\n\nfunction deterministicStringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  var tmp = deterministicDecirc(obj, '', 0, [], undefined, 0, options) || obj\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(tmp, replacer, spacer)\n    } else {\n      res = JSON.stringify(tmp, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    // Ensure that we restore the object as it was.\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction deterministicDecirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n    try {\n      if (typeof val.toJSON === 'function') {\n        return\n      }\n    } catch (_) {\n      return\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        deterministicDecirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      // Create a temporary object in the required way\n      var tmp = {}\n      var keys = Object.keys(val).sort(compareFunction)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        deterministicDecirc(val[key], key, i, stack, val, depth, options)\n        tmp[key] = val[key]\n      }\n      if (typeof parent !== 'undefined') {\n        arr.push([parent, k, val])\n        parent[k] = tmp\n      } else {\n        return tmp\n      }\n    }\n    stack.pop()\n  }\n}\n\n// wraps replacer function to handle values we couldn't replace\n// and mark them as replaced value\nfunction replaceGetterValues (replacer) {\n  replacer =\n    typeof replacer !== 'undefined'\n      ? replacer\n      : function (k, v) {\n        return v\n      }\n  return function (key, val) {\n    if (replacerStack.length > 0) {\n      for (var i = 0; i < replacerStack.length; i++) {\n        var part = replacerStack[i]\n        if (part[1] === key && part[0] === val) {\n          val = part[2]\n          replacerStack.splice(i, 1)\n          break\n        }\n      }\n    }\n    return replacer.call(this, key, val)\n  }\n}\n","\nconst { EthereumRpcError, EthereumProviderError } = require('./classes')\nconst { getMessageFromCode } = require('./utils')\nconst ERROR_CODES = require('./errorCodes.json')\n\nmodule.exports = {\n  rpc: {\n\n    /**\n     * Get a JSON RPC 2.0 Parse (-32700) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    parse: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.parse, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Invalid Request (-32600) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidRequest: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidRequest, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Invalid Params (-32602) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidParams: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidParams, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Method Not Found (-32601) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    methodNotFound: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.methodNotFound, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Internal (-32603) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    internal: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.internal, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Server error.\n     * Permits integer error codes in the [ -32099 <= -32005 ] range.\n     * Codes -32000 through -32004 are reserved by EIP 1474.\n     *\n     * @param {Object|string} opts - Options object\n     * @param {number} opts.code - The error code\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    server: (opts) => {\n      if (!opts || typeof opts !== 'object' || Array.isArray(opts)) {\n        throw new Error('Ethereum RPC Server errors must provide single object argument.')\n      }\n      const { code } = opts\n      if (!Number.isInteger(code) || code > -32005 || code < -32099) {\n        throw new Error(\n          '\"code\" must be an integer such that: -32099 <= code <= -32005',\n        )\n      }\n      return getEthJsonRpcError(code, opts)\n    },\n\n    /**\n     * Get an Ethereum JSON RPC Invalid Input (-32000) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidInput: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidInput, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Resource Not Found (-32001) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    resourceNotFound: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.resourceNotFound, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Resource Unavailable (-32002) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    resourceUnavailable: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.resourceUnavailable, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Transaction Rejected (-32003) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    transactionRejected: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.transactionRejected, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Method Not Supported (-32004) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    methodNotSupported: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.methodNotSupported, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Limit Exceeded (-32005) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    limitExceeded: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.limitExceeded, opts,\n    ),\n  },\n\n  provider: {\n\n    /**\n     * Get an Ethereum Provider User Rejected Request (4001) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    userRejectedRequest: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.userRejectedRequest, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Unauthorized (4100) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    unauthorized: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.unauthorized, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Unsupported Method (4200) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    unsupportedMethod: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.unsupportedMethod, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Not Connected (4900) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    disconnected: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.disconnected, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Chain Not Connected (4901) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    chainDisconnected: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.chainDisconnected, opts,\n      )\n    },\n\n    /**\n     * Get a custom Ethereum Provider error.\n     *\n     * @param {Object|string} opts - Options object\n     * @param {number} opts.code - The error code\n     * @param {string} opts.message - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    custom: (opts) => {\n      if (!opts || typeof opts !== 'object' || Array.isArray(opts)) {\n        throw new Error('Ethereum Provider custom errors must provide single object argument.')\n      }\n      const { code, message, data } = opts\n      if (!message || typeof message !== 'string') {\n        throw new Error(\n          '\"message\" must be a nonempty string',\n        )\n      }\n      return new EthereumProviderError(code, message, data)\n    },\n  },\n}\n\n// Internal\n\nfunction getEthJsonRpcError (code, opts) {\n  const [message, data] = validateOpts(opts)\n  return new EthereumRpcError(\n    code,\n    message || getMessageFromCode(code),\n    data,\n  )\n}\n\nfunction getEthProviderError (code, opts) {\n  const [message, data] = validateOpts(opts)\n  return new EthereumProviderError(\n    code,\n    message || getMessageFromCode(code),\n    data,\n  )\n}\n\nfunction validateOpts (opts) {\n  if (opts) {\n    if (typeof opts === 'string') {\n      return [opts]\n    } else if (typeof opts === 'object' && !Array.isArray(opts)) {\n      const { message, data } = opts\n      return [message, data]\n    }\n  }\n  return []\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeMiddleware = void 0;\nconst JsonRpcEngine_1 = require(\"./JsonRpcEngine\");\nfunction mergeMiddleware(middlewareStack) {\n    const engine = new JsonRpcEngine_1.JsonRpcEngine();\n    middlewareStack.forEach((middleware) => engine.push(middleware));\n    return engine.asMiddleware();\n}\nexports.mergeMiddleware = mergeMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVyZ2VNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL21lcmdlTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxtREFBbUU7QUFFbkUsU0FBZ0IsZUFBZSxDQUFDLGVBQXNEO0lBQ3BGLE1BQU0sTUFBTSxHQUFHLElBQUksNkJBQWEsRUFBRSxDQUFDO0lBQ25DLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUNqRSxPQUFPLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUMvQixDQUFDO0FBSkQsMENBSUMifQ==","module.exports = function createScaffoldMiddleware (handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method]\n    // if no handler, return\n    if (handler === undefined) {\n      return next()\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === 'function') {\n      return handler(req, res, next, end)\n    }\n    // if handler is some other value, use as result\n    res.result = handler\n    return end()\n  }\n}\n","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst BaseFilterWithHistory = require('./base-filter-history')\nconst { bnToHex, hexToInt, incrementHexInt, minBlockRef, blockRefIsNumber } = require('./hexUtils')\n\nclass LogFilter extends BaseFilterWithHistory {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'log'\n    this.ethQuery = new EthQuery(provider)\n    this.params = Object.assign({\n      fromBlock: 'latest',\n      toBlock: 'latest',\n      address: undefined,\n      topics: [],\n    }, params)\n    // normalize address parameter\n    if (this.params.address) {\n      // ensure array\n      if (!Array.isArray(this.params.address)) {\n        this.params.address = [this.params.address]\n      }\n      // ensure lowercase\n      this.params.address = this.params.address.map(address => address.toLowerCase())\n    }\n  }\n\n  async initialize({ currentBlock }) {\n    // resolve params.fromBlock\n    let fromBlock = this.params.fromBlock\n    if (['latest', 'pending'].includes(fromBlock)) fromBlock = currentBlock\n    if ('earliest' === fromBlock) fromBlock = '0x0'\n    this.params.fromBlock = fromBlock\n    // set toBlock for initial lookup\n    const toBlock = minBlockRef(this.params.toBlock, currentBlock)\n    const params = Object.assign({}, this.params, { toBlock })\n    // fetch logs and add to results\n    const newLogs = await this._fetchLogs(params)\n    this.addInitialResults(newLogs)\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    // configure params for this update\n    const toBlock = newBlock\n    let fromBlock\n    // oldBlock is empty on first sync\n    if (oldBlock) {\n      fromBlock = incrementHexInt(oldBlock)\n    } else {\n      fromBlock = newBlock\n    }\n    // fetch logs\n    const params = Object.assign({}, this.params, { fromBlock, toBlock })\n    const newLogs = await this._fetchLogs(params)\n    const matchingLogs = newLogs.filter(log => this.matchLog(log))\n\n    // add to results\n    this.addResults(matchingLogs)\n  }\n\n  async _fetchLogs (params) {\n    const newLogs = await pify(cb => this.ethQuery.getLogs(params, cb))()\n    // add to results\n    return newLogs\n  }\n\n  matchLog(log) {\n    // check if block number in bounds:\n    if (hexToInt(this.params.fromBlock) >= hexToInt(log.blockNumber)) return false\n    if (blockRefIsNumber(this.params.toBlock) && hexToInt(this.params.toBlock) <= hexToInt(log.blockNumber)) return false\n\n    // address is correct:\n    const normalizedLogAddress = log.address && log.address.toLowerCase()\n    if (this.params.address && normalizedLogAddress && !this.params.address.includes(normalizedLogAddress)) return false\n\n    // topics match:\n    // topics are position-dependant\n    // topics can be nested to represent `or` [[a || b], c]\n    // topics can be null, representing a wild card for that position\n    const topicsMatch = this.params.topics.every((topicPattern, index) => {\n      // pattern is longer than actual topics\n      let logTopic = log.topics[index]\n      if (!logTopic) return false\n      logTopic = logTopic.toLowerCase()\n      // normalize subTopics\n      let subtopicsToMatch = Array.isArray(topicPattern) ? topicPattern : [topicPattern]\n      // check for wild card\n      const subtopicsIncludeWildcard = subtopicsToMatch.includes(null)\n      if (subtopicsIncludeWildcard) return true\n      subtopicsToMatch = subtopicsToMatch.map(topic => topic.toLowerCase())\n      // check each possible matching topic\n      const topicDoesMatch = subtopicsToMatch.includes(logTopic)\n      return topicDoesMatch\n    })\n\n    return topicsMatch\n  }\n\n}\n\nmodule.exports = LogFilter\n","'use strict';\n\nconst processFn = (fn, options, proxy, unwrapped) => function (...arguments_) {\n\tconst P = options.promiseModule;\n\n\treturn new P((resolve, reject) => {\n\t\tif (options.multiArgs) {\n\t\t\targuments_.push((...result) => {\n\t\t\t\tif (options.errorFirst) {\n\t\t\t\t\tif (result[0]) {\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.shift();\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (options.errorFirst) {\n\t\t\targuments_.push((error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targuments_.push(resolve);\n\t\t}\n\n\t\tconst self = this === proxy ? unwrapped : this;\n\t\tReflect.apply(fn, self, arguments_);\n\t});\n};\n\nconst filterCache = new WeakMap();\n\nmodule.exports = (input, options) => {\n\toptions = {\n\t\texclude: [/.+(?:Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise,\n\t\t...options\n\t};\n\n\tconst objectType = typeof input;\n\tif (!(input !== null && (objectType === 'object' || objectType === 'function'))) {\n\t\tthrow new TypeError(`Expected \\`input\\` to be a \\`Function\\` or \\`Object\\`, got \\`${input === null ? 'null' : objectType}\\``);\n\t}\n\n\tconst filter = (target, key) => {\n\t\tlet cached = filterCache.get(target);\n\n\t\tif (!cached) {\n\t\t\tcached = {};\n\t\t\tfilterCache.set(target, cached);\n\t\t}\n\n\t\tif (key in cached) {\n\t\t\treturn cached[key];\n\t\t}\n\n\t\tconst match = pattern => (typeof pattern === 'string' || typeof key === 'symbol') ? key === pattern : pattern.test(key);\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(target, key);\n\t\tconst writableOrConfigurableOwn = (desc === undefined || desc.writable || desc.configurable);\n\t\tconst included = options.include ? options.include.some(match) : !options.exclude.some(match);\n\t\tconst shouldFilter = included && writableOrConfigurableOwn;\n\t\tcached[key] = shouldFilter;\n\t\treturn shouldFilter;\n\t};\n\n\tconst cache = new WeakMap();\n\n\tconst proxy = new Proxy(input, {\n\t\tapply(target, thisArg, args) {\n\t\t\tconst cached = cache.get(target);\n\n\t\t\tif (cached) {\n\t\t\t\treturn Reflect.apply(cached, thisArg, args);\n\t\t\t}\n\n\t\t\tconst pified = options.excludeMain ? target : processFn(target, options, proxy, target);\n\t\t\tcache.set(target, pified);\n\t\t\treturn Reflect.apply(pified, thisArg, args);\n\t\t},\n\n\t\tget(target, key) {\n\t\t\tconst property = target[key];\n\n\t\t\t// eslint-disable-next-line no-use-extend-native/no-use-extend-native\n\t\t\tif (!filter(target, key) || property === Function.prototype[key]) {\n\t\t\t\treturn property;\n\t\t\t}\n\n\t\t\tconst cached = cache.get(property);\n\n\t\t\tif (cached) {\n\t\t\t\treturn cached;\n\t\t\t}\n\n\t\t\tif (typeof property === 'function') {\n\t\t\t\tconst pified = processFn(property, options, proxy, target);\n\t\t\t\tcache.set(property, pified);\n\t\t\t\treturn pified;\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t});\n\n\treturn proxy;\n};\n","const BaseFilter = require('./base-filter')\n\n// tracks all results ever recorded\nclass BaseFilterWithHistory extends BaseFilter {\n\n  constructor () {\n    super()\n    this.allResults = []\n  }\n\n  async update () {\n    throw new Error('BaseFilterWithHistory - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addResults(newResults)\n  }\n\n  addInitialResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addInitialResults(newResults)\n  }\n\n  getAllResults () {\n    return this.allResults\n  }\n\n}\n\nmodule.exports = BaseFilterWithHistory","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass BlockFilter extends BaseFilter {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'block'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    const toBlock = newBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blockBodies = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockHashes = blockBodies.map((block) => block.hash)\n    this.addResults(blockHashes)\n  }\n\n}\n\nmodule.exports = BlockFilter\n","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass TxFilter extends BaseFilter {\n\n  constructor ({ provider }) {\n    super()\n    this.type = 'tx'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock }) {\n    const toBlock = oldBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blocks = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockTxHashes = []\n    for (const block of blocks) {\n      blockTxHashes.push(...block.transactions)\n    }\n    // add to results\n    this.addResults(blockTxHashes)\n  }\n\n}\n\nmodule.exports = TxFilter\n"],"sourceRoot":""}