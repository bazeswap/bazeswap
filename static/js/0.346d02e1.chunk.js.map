{"version":3,"sources":["../../src/idRemapMiddleware.ts","../../src/createAsyncMiddleware.ts","../../src/createScaffoldMiddleware.ts","../node_modules/fast-safe-stringify/index.js","../node_modules/eth-rpc-errors/src/errors.js","../../src/mergeMiddleware.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/node_modules/json-rpc-engine/src/createScaffoldMiddleware.js","../node_modules/eth-json-rpc-filters/log-filter.js","../node_modules/eth-json-rpc-filters/node_modules/pify/index.js","../node_modules/eth-json-rpc-filters/base-filter-history.js","../node_modules/eth-json-rpc-filters/block-filter.js","../node_modules/eth-json-rpc-filters/tx-filter.js","../node_modules/async-mutex/es6/Semaphore.js","../node_modules/async-mutex/es6/Mutex.js","../node_modules/async-mutex/es6/withTimeout.js","../../src/constants.js","../../src/options.js","../../src/create-element.js","../../src/component.js","../../src/render.js","../../src/create-context.js","../../src/util.js","../../src/diff/children.js","../../src/diff/props.js","../../src/diff/index.js","../../src/clone-element.js","../../src/diff/catch-error.js","../../src/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray.js","../node_modules/eth-json-rpc-filters/hexUtils.js","../index.ts","../node_modules/eth-rpc-errors/index.js","../node_modules/eth-rpc-errors/src/classes.js","../node_modules/eth-json-rpc-filters/base-filter.js","../node_modules/eth-json-rpc-filters/getBlocksForRange.js","../node_modules/eth-block-tracker/src/polling.js","../node_modules/pify/index.js","../node_modules/eth-query/index.js","../node_modules/eth-json-rpc-filters/index.js","../../src/index.ts","../../src/getUniqueId.ts","../../src/JsonRpcEngine.ts","../node_modules/eth-rpc-errors/src/utils.js","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/scaffold.js","../node_modules/eth-json-rpc-filters/subscriptionManager.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/eth-block-tracker/src/base.js","../node_modules/json-rpc-random-id/index.js","../node_modules/safe-event-emitter/index.js"],"names":["module","exports","stringify","default","stable","deterministicStringify","stableStringify","arr","replacerStack","defaultOptions","depthLimit","Number","MAX_SAFE_INTEGER","edgesLimit","obj","replacer","spacer","options","res","decirc","val","k","edgeIndex","stack","parent","depth","i","length","setReplace","push","Array","isArray","keys","Object","key","pop","undefined","JSON","replaceGetterValues","_","part","defineProperty","replace","propertyDescriptor","getOwnPropertyDescriptor","get","configurable","value","compareFunction","a","b","tmp","deterministicDecirc","toJSON","sort","v","splice","call","this","require","EthereumRpcError","EthereumProviderError","getMessageFromCode","ERROR_CODES","getEthJsonRpcError","code","opts","validateOpts","message","data","getEthProviderError","rpc","parse","invalidRequest","invalidParams","methodNotFound","internal","server","Error","isInteger","invalidInput","resourceNotFound","resourceUnavailable","transactionRejected","methodNotSupported","limitExceeded","provider","userRejectedRequest","unauthorized","unsupportedMethod","disconnected","chainDisconnected","custom","mergeMiddleware","handlers","req","next","end","handler","method","result","c","EthQuery","pify","BaseFilterWithHistory","hexToInt","bnToHex","incrementHexInt","minBlockRef","blockRefIsNumber","LogFilter","params","type","ethQuery","assign","fromBlock","toBlock","address","topics","map","toLowerCase","currentBlock","includes","_fetchLogs","newLogs","addInitialResults","oldBlock","newBlock","matchingLogs","filter","log","matchLog","addResults","cb","getLogs","blockNumber","normalizedLogAddress","every","topicPattern","index","logTopic","subtopicsToMatch","topic","processFn","fn","proxy","unwrapped","arguments_","P","promiseModule","resolve","reject","multiArgs","errorFirst","shift","error","self","Reflect","apply","filterCache","WeakMap","input","exclude","Promise","objectType","TypeError","cache","Proxy","target","thisArg","args","cached","pified","excludeMain","set","property","match","pattern","test","desc","writableOrConfigurableOwn","writable","shouldFilter","include","some","Function","prototype","allResults","newResults","concat","BaseFilter","getBlocksForRange","BlockFilter","blockBodies","blockHashes","block","hash","TxFilter","blocks","blockTxHashes","transactions","Semaphore","_maxConcurrency","_queue","_value","acquire","_this","locked","isLocked","ticket","r","_dispatch","runExclusive","callback","__awaiter","_a","release","__generator","_b","label","sent","trys","_currentReleaser","releaser","nextConsumer","released","Mutex","_semaphore","withTimeout","sync","timeout","timeoutError","isTimeout","setTimeout","isValidElement","rerenderQueue","rerenderCount","defer","prevDebounce","IS_HYDRATE","EMPTY_OBJ","EMPTY_ARR","IS_NON_DIMENSIONAL","props","removeNode","node","parentNode","removeChild","createElement","children","normalizedProps","arguments","defaultProps","createVNode","ref","original","vnode","_children","_parent","_depth","_dom","_nextDom","_component","constructor","_original","createRef","Fragment","Component","context","getDomSibling","childIndex","indexOf","sibling","updateParentDomPointers","child","base","enqueueRender","_dirty","debounceRendering","process","queue","_vnode","component","commitQueue","oldVNode","newDom","oldDom","parentDom","_parentDom","diff","_globalContext","ownerSVGElement","commitRoot","diffChildren","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","sibDom","firstChildDom","refs","oldChildren","oldChildrenLength","toChildArray","childVNode","nextDom","outer","appendChild","nextSibling","insertBefore","unmount","applyRef","flattened","setStyle","style","setProperty","dom","name","oldValue","s","useCapture","nameLower","cssText","slice","addEventListener","eventProxy","_listeners","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","e","event","newVNode","isNew","oldProps","oldState","snapshot","clearProcessingException","newProps","componentContext","newType","_diff","contextType","_id","_defaultValue","_processingException","_pendingError","render","doRender","sub","state","_renderCallbacks","_nextState","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","_force","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","_render","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","_catchError","root","_commit","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","childNodes","dangerouslySetInnerHTML","attributes","__html","innerHTML","hydrate","diffProps","checked","current","parentVNode","skipRemove","componentWillUnmount","replaceNode","_root","cloneElement","createContext","defaultValue","ctx","Consumer","Provider","subs","_props","old","_contextRef","hasCaught","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","then","bind","currentIndex","currentComponent","prevRaf","currentHook","afterPaintEffects","oldBeforeRender","oldAfterDiff","oldCommit","oldBeforeUnmount","getHookState","_hook","hooks","__hooks","_list","_pendingEffects","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","nextValue","action","useEffect","_skipEffects","argsChanged","_args","useLayoutEffect","useRef","initialValue","useMemo","useImperativeHandle","createHandle","factory","_factory","useCallback","useContext","_context","useDebugValue","formatter","useErrorBoundary","errState","err","flushAfterPaintEffects","forEach","invokeCleanup","invokeEffect","hook","_cleanup","oldArgs","newArgs","arg","f","requestAnimationFrame","raf","done","clearTimeout","cancelAnimationFrame","window","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","sortBlockRefs","refA","refB","hexString","parseInt","intToHex","int","toString","unsafeRandomNibble","Math","floor","random","sortedRefs","maxBlockRef","bn","blockRef","unsafeRandomBytes","byteCount","serializeError","ethErrors","safeStringify","serialized","serialize","stringifyReplacer","isValidEthProviderCode","updates","emit","fromBlockNumber","toBlockNumber","missingBlockNumbers","fill","all","blockNum","query","sendAsync","id","jsonrpc","BaseBlockTracker","PollingBlockTracker","pollingInterval","retryTimeout","keepEventLoopActive","setSkipCacheFlag","blockResetDuration","_provider","_pollingInterval","_retryTimeout","_keepEventLoopActive","_setSkipCacheFlag","_updateLatestBlock","getLatestBlock","_performSync","catch","_isRunning","newErr","emitErr","console","_fetchLatestBlock","latestBlock","_newPotentialLatest","skipCache","duration","unref","timoutRef","results","unshift","ret","create","getPrototypeOf","x","extend","createRandomId","currentProvider","generateFnFor","methodName","generateFnWithDefaultBlockFor","argCount","getBalance","getCode","getTransactionCount","getStorageAt","protocolVersion","syncing","coinbase","mining","hashrate","gasPrice","accounts","getBlockTransactionCountByHash","getBlockTransactionCountByNumber","getUncleCountByBlockHash","getUncleCountByBlockNumber","sign","sendTransaction","sendRawTransaction","estimateGas","getBlockByHash","getBlockByNumber","getTransactionByHash","getTransactionByBlockHashAndIndex","getTransactionByBlockNumberAndIndex","getTransactionReceipt","getUncleByBlockHashAndIndex","getUncleByBlockNumberAndIndex","getCompilers","compileLLL","compileSolidity","compileSerpent","newFilter","newBlockFilter","newPendingTransactionFilter","uninstallFilter","getFilterChanges","getFilterLogs","getWork","submitWork","submitHashrate","response","createAsyncMiddleware","createJsonRpcMiddleware","toFilterCreationMiddleware","createFilterFn","toAsyncRpcMiddleware","asyncFn","objValues","values","blockTracker","filterIndex","filters","mutex","waitForFree","middleware","releaseLock","mutexMiddlewareWrapper","eth_newFilter","newLogFilter","eth_newBlockFilter","eth_newPendingTransactionFilter","eth_uninstallFilter","uninstallFilterHandler","eth_getFilterChanges","eth_getFilterLogs","filterUpdater","destroy","uninstallAllFilters","installFilter","filterIndexHex","getChangesAndClear","getAllResults","Boolean","prevFilterCount","initialize","idHex","newFilterCount","updateBlockTrackerSubs","on","removeListener","errorValues","FALLBACK_ERROR_CODE","FALLBACK_MESSAGE","FALLBACK_ERROR","fallbackMessage","codeString","isJsonRpcServerError","isValidCode","assignOriginalError","fallbackError","shouldIncludeStack","originalError","JSON_RPC_SERVER_ERROR_MESSAGE","SafeEventEmitter","createScaffoldMiddleware","createFilterMiddleware","normalizeBlock","parentHash","sha3Uncles","miner","stateRoot","transactionsRoot","receiptsRoot","logsBloom","difficulty","number","gasLimit","gasUsed","nonce","mixHash","timestamp","extraData","subscriptions","filterManager","isDestroyed","events","eth_subscribe","eth_unsubscribe","removeAllListeners","createSubNewHeads","createSubFromFilter","subId","_emitSubscriptionResult","subscriptionType","rawBlocks","filterParams","subscription","filterIdHex","arrayLikeToArray","iter","Symbol","iterator","from","calculateSum","accumulator","currentValue","blockTrackerEvents","_blockResetDuration","_blockResetTimeout","_currentBlock","_onNewListener","_onRemoveListener","_resetCurrentBlock","_setupInternalEvents","once","eventName","_maybeStart","_getBlockTrackerEventCount","_maybeEnd","_cancelBlockResetTimeout","_start","_setupBlockResetTimeout","_end","listenerCount","reduce","_setCurrentBlock","hexInt","max","idCounter","start","util","EventEmitter","R","ReflectApply","receiver","safeApply","arrayClone","n","copy","inherits","doError","_events","er","len","listeners"],"mappings":"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","file":"static/js/0.346d02e1.chunk.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createIdRemapMiddleware = void 0;\nconst getUniqueId_1 = require(\"./getUniqueId\");\nfunction createIdRemapMiddleware() {\n    return (req, res, next, _end) => {\n        const originalId = req.id;\n        const newId = getUniqueId_1.getUniqueId();\n        req.id = newId;\n        res.id = newId;\n        next((done) => {\n            req.id = originalId;\n            res.id = originalId;\n            done();\n        });\n    };\n}\nexports.createIdRemapMiddleware = createIdRemapMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRSZW1hcE1pZGRsZXdhcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaWRSZW1hcE1pZGRsZXdhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsK0NBQTRDO0FBRzVDLFNBQWdCLHVCQUF1QjtJQUNyQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUU7UUFDOUIsTUFBTSxVQUFVLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUMxQixNQUFNLEtBQUssR0FBRyx5QkFBVyxFQUFFLENBQUM7UUFDNUIsR0FBRyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUM7UUFDZixHQUFHLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQztRQUNmLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ1osR0FBRyxDQUFDLEVBQUUsR0FBRyxVQUFVLENBQUM7WUFDcEIsR0FBRyxDQUFDLEVBQUUsR0FBRyxVQUFVLENBQUM7WUFDcEIsSUFBSSxFQUFFLENBQUM7UUFDVCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQztBQUNKLENBQUM7QUFaRCwwREFZQyJ9","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createAsyncMiddleware = void 0;\n/**\n * JsonRpcEngine only accepts callback-based middleware directly.\n * createAsyncMiddleware exists to enable consumers to pass in async middleware\n * functions.\n *\n * Async middleware have no \"end\" function. Instead, they \"end\" if they return\n * without calling \"next\". Rather than passing in explicit return handlers,\n * async middleware can simply await \"next\", and perform operations on the\n * response object when execution resumes.\n *\n * To accomplish this, createAsyncMiddleware passes the async middleware a\n * wrapped \"next\" function. That function calls the internal JsonRpcEngine\n * \"next\" function with a return handler that resolves a promise when called.\n *\n * The return handler will always be called. Its resolution of the promise\n * enables the control flow described above.\n */\nfunction createAsyncMiddleware(asyncMiddleware) {\n    return async (req, res, next, end) => {\n        // nextPromise is the key to the implementation\n        // it is resolved by the return handler passed to the\n        // \"next\" function\n        let resolveNextPromise;\n        const nextPromise = new Promise((resolve) => {\n            resolveNextPromise = resolve;\n        });\n        let returnHandlerCallback = null;\n        let nextWasCalled = false;\n        // This will be called by the consumer's async middleware.\n        const asyncNext = async () => {\n            nextWasCalled = true;\n            // We pass a return handler to next(). When it is called by the engine,\n            // the consumer's async middleware will resume executing.\n            // eslint-disable-next-line node/callback-return\n            next((runReturnHandlersCallback) => {\n                // This callback comes from JsonRpcEngine._runReturnHandlers\n                returnHandlerCallback = runReturnHandlersCallback;\n                resolveNextPromise();\n            });\n            await nextPromise;\n        };\n        try {\n            await asyncMiddleware(req, res, asyncNext);\n            if (nextWasCalled) {\n                await nextPromise; // we must wait until the return handler is called\n                returnHandlerCallback(null);\n            }\n            else {\n                end(null);\n            }\n        }\n        catch (error) {\n            if (returnHandlerCallback) {\n                returnHandlerCallback(error);\n            }\n            else {\n                end(error);\n            }\n        }\n    };\n}\nexports.createAsyncMiddleware = createAsyncMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQXN5bmNNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NyZWF0ZUFzeW5jTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFnQkE7Ozs7Ozs7Ozs7Ozs7Ozs7R0FnQkc7QUFDSCxTQUFnQixxQkFBcUIsQ0FDbkMsZUFBNkM7SUFFN0MsT0FBTyxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDbkMsK0NBQStDO1FBQy9DLHFEQUFxRDtRQUNyRCxrQkFBa0I7UUFDbEIsSUFBSSxrQkFBOEIsQ0FBQztRQUNuQyxNQUFNLFdBQVcsR0FBRyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1lBQzFDLGtCQUFrQixHQUFHLE9BQU8sQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztRQUVILElBQUkscUJBQXFCLEdBQVksSUFBSSxDQUFDO1FBQzFDLElBQUksYUFBYSxHQUFHLEtBQUssQ0FBQztRQUUxQiwwREFBMEQ7UUFDMUQsTUFBTSxTQUFTLEdBQUcsS0FBSyxJQUFJLEVBQUU7WUFDM0IsYUFBYSxHQUFHLElBQUksQ0FBQztZQUVyQix1RUFBdUU7WUFDdkUseURBQXlEO1lBQ3pELGdEQUFnRDtZQUNoRCxJQUFJLENBQUMsQ0FBQyx5QkFBeUIsRUFBRSxFQUFFO2dCQUNqQyw0REFBNEQ7Z0JBQzVELHFCQUFxQixHQUFHLHlCQUF5QixDQUFDO2dCQUNsRCxrQkFBa0IsRUFBRSxDQUFDO1lBQ3ZCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxXQUFXLENBQUM7UUFDcEIsQ0FBQyxDQUFDO1FBRUYsSUFBSTtZQUNGLE1BQU0sZUFBZSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFFM0MsSUFBSSxhQUFhLEVBQUU7Z0JBQ2pCLE1BQU0sV0FBVyxDQUFDLENBQUMsa0RBQWtEO2dCQUNwRSxxQkFBK0MsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUN4RDtpQkFBTTtnQkFDTCxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDWDtTQUNGO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxJQUFJLHFCQUFxQixFQUFFO2dCQUN4QixxQkFBK0MsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUN6RDtpQkFBTTtnQkFDTCxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDWjtTQUNGO0lBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQS9DRCxzREErQ0MifQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createScaffoldMiddleware = void 0;\nfunction createScaffoldMiddleware(handlers) {\n    return (req, res, next, end) => {\n        const handler = handlers[req.method];\n        // if no handler, return\n        if (handler === undefined) {\n            return next();\n        }\n        // if handler is fn, call as middleware\n        if (typeof handler === 'function') {\n            return handler(req, res, next, end);\n        }\n        // if handler is some other value, use as result\n        res.result = handler;\n        return end();\n    };\n}\nexports.createScaffoldMiddleware = createScaffoldMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlU2NhZmZvbGRNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NyZWF0ZVNjYWZmb2xkTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFJQSxTQUFnQix3QkFBd0IsQ0FBQyxRQUV4QztJQUNDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUM3QixNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLHdCQUF3QjtRQUN4QixJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDekIsT0FBTyxJQUFJLEVBQUUsQ0FBQztTQUNmO1FBQ0QsdUNBQXVDO1FBQ3ZDLElBQUksT0FBTyxPQUFPLEtBQUssVUFBVSxFQUFFO1lBQ2pDLE9BQU8sT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQ3JDO1FBQ0QsZ0RBQWdEO1FBQy9DLEdBQStCLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQztRQUNsRCxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQWpCRCw0REFpQkMifQ==","module.exports = stringify\nstringify.default = stringify\nstringify.stable = deterministicStringify\nstringify.stableStringify = deterministicStringify\n\nvar LIMIT_REPLACE_NODE = '[...]'\nvar CIRCULAR_REPLACE_NODE = '[Circular]'\n\nvar arr = []\nvar replacerStack = []\n\nfunction defaultOptions () {\n  return {\n    depthLimit: Number.MAX_SAFE_INTEGER,\n    edgesLimit: Number.MAX_SAFE_INTEGER\n  }\n}\n\n// Regular stringify\nfunction stringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  decirc(obj, '', 0, [], undefined, 0, options)\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(obj, replacer, spacer)\n    } else {\n      res = JSON.stringify(obj, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction setReplace (replace, val, k, parent) {\n  var propertyDescriptor = Object.getOwnPropertyDescriptor(parent, k)\n  if (propertyDescriptor.get !== undefined) {\n    if (propertyDescriptor.configurable) {\n      Object.defineProperty(parent, k, { value: replace })\n      arr.push([parent, k, val, propertyDescriptor])\n    } else {\n      replacerStack.push([val, k, replace])\n    }\n  } else {\n    parent[k] = replace\n    arr.push([parent, k, val])\n  }\n}\n\nfunction decirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        decirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      var keys = Object.keys(val)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        decirc(val[key], key, i, stack, val, depth, options)\n      }\n    }\n    stack.pop()\n  }\n}\n\n// Stable-stringify\nfunction compareFunction (a, b) {\n  if (a < b) {\n    return -1\n  }\n  if (a > b) {\n    return 1\n  }\n  return 0\n}\n\nfunction deterministicStringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  var tmp = deterministicDecirc(obj, '', 0, [], undefined, 0, options) || obj\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(tmp, replacer, spacer)\n    } else {\n      res = JSON.stringify(tmp, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    // Ensure that we restore the object as it was.\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction deterministicDecirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n    try {\n      if (typeof val.toJSON === 'function') {\n        return\n      }\n    } catch (_) {\n      return\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        deterministicDecirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      // Create a temporary object in the required way\n      var tmp = {}\n      var keys = Object.keys(val).sort(compareFunction)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        deterministicDecirc(val[key], key, i, stack, val, depth, options)\n        tmp[key] = val[key]\n      }\n      if (typeof parent !== 'undefined') {\n        arr.push([parent, k, val])\n        parent[k] = tmp\n      } else {\n        return tmp\n      }\n    }\n    stack.pop()\n  }\n}\n\n// wraps replacer function to handle values we couldn't replace\n// and mark them as replaced value\nfunction replaceGetterValues (replacer) {\n  replacer =\n    typeof replacer !== 'undefined'\n      ? replacer\n      : function (k, v) {\n        return v\n      }\n  return function (key, val) {\n    if (replacerStack.length > 0) {\n      for (var i = 0; i < replacerStack.length; i++) {\n        var part = replacerStack[i]\n        if (part[1] === key && part[0] === val) {\n          val = part[2]\n          replacerStack.splice(i, 1)\n          break\n        }\n      }\n    }\n    return replacer.call(this, key, val)\n  }\n}\n","\nconst { EthereumRpcError, EthereumProviderError } = require('./classes')\nconst { getMessageFromCode } = require('./utils')\nconst ERROR_CODES = require('./errorCodes.json')\n\nmodule.exports = {\n  rpc: {\n\n    /**\n     * Get a JSON RPC 2.0 Parse (-32700) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    parse: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.parse, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Invalid Request (-32600) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidRequest: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidRequest, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Invalid Params (-32602) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidParams: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidParams, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Method Not Found (-32601) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    methodNotFound: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.methodNotFound, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Internal (-32603) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    internal: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.internal, opts,\n    ),\n\n    /**\n     * Get a JSON RPC 2.0 Server error.\n     * Permits integer error codes in the [ -32099 <= -32005 ] range.\n     * Codes -32000 through -32004 are reserved by EIP 1474.\n     *\n     * @param {Object|string} opts - Options object\n     * @param {number} opts.code - The error code\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    server: (opts) => {\n      if (!opts || typeof opts !== 'object' || Array.isArray(opts)) {\n        throw new Error('Ethereum RPC Server errors must provide single object argument.')\n      }\n      const { code } = opts\n      if (!Number.isInteger(code) || code > -32005 || code < -32099) {\n        throw new Error(\n          '\"code\" must be an integer such that: -32099 <= code <= -32005',\n        )\n      }\n      return getEthJsonRpcError(code, opts)\n    },\n\n    /**\n     * Get an Ethereum JSON RPC Invalid Input (-32000) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    invalidInput: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.invalidInput, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Resource Not Found (-32001) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    resourceNotFound: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.resourceNotFound, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Resource Unavailable (-32002) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    resourceUnavailable: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.resourceUnavailable, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Transaction Rejected (-32003) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    transactionRejected: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.transactionRejected, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Method Not Supported (-32004) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    methodNotSupported: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.methodNotSupported, opts,\n    ),\n\n    /**\n     * Get an Ethereum JSON RPC Limit Exceeded (-32005) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumRpcError} The error\n     */\n    limitExceeded: (opts) => getEthJsonRpcError(\n      ERROR_CODES.rpc.limitExceeded, opts,\n    ),\n  },\n\n  provider: {\n\n    /**\n     * Get an Ethereum Provider User Rejected Request (4001) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    userRejectedRequest: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.userRejectedRequest, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Unauthorized (4100) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    unauthorized: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.unauthorized, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Unsupported Method (4200) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    unsupportedMethod: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.unsupportedMethod, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Not Connected (4900) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    disconnected: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.disconnected, opts,\n      )\n    },\n\n    /**\n     * Get an Ethereum Provider Chain Not Connected (4901) error.\n     *\n     * @param {Object|string} [opts] - Options object or error message string\n     * @param {string} [opts.message] - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    chainDisconnected: (opts) => {\n      return getEthProviderError(\n        ERROR_CODES.provider.chainDisconnected, opts,\n      )\n    },\n\n    /**\n     * Get a custom Ethereum Provider error.\n     *\n     * @param {Object|string} opts - Options object\n     * @param {number} opts.code - The error code\n     * @param {string} opts.message - The error message\n     * @param {any} [opts.data] - Error data\n     * @returns {EthereumProviderError} The error\n     */\n    custom: (opts) => {\n      if (!opts || typeof opts !== 'object' || Array.isArray(opts)) {\n        throw new Error('Ethereum Provider custom errors must provide single object argument.')\n      }\n      const { code, message, data } = opts\n      if (!message || typeof message !== 'string') {\n        throw new Error(\n          '\"message\" must be a nonempty string',\n        )\n      }\n      return new EthereumProviderError(code, message, data)\n    },\n  },\n}\n\n// Internal\n\nfunction getEthJsonRpcError (code, opts) {\n  const [message, data] = validateOpts(opts)\n  return new EthereumRpcError(\n    code,\n    message || getMessageFromCode(code),\n    data,\n  )\n}\n\nfunction getEthProviderError (code, opts) {\n  const [message, data] = validateOpts(opts)\n  return new EthereumProviderError(\n    code,\n    message || getMessageFromCode(code),\n    data,\n  )\n}\n\nfunction validateOpts (opts) {\n  if (opts) {\n    if (typeof opts === 'string') {\n      return [opts]\n    } else if (typeof opts === 'object' && !Array.isArray(opts)) {\n      const { message, data } = opts\n      return [message, data]\n    }\n  }\n  return []\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeMiddleware = void 0;\nconst JsonRpcEngine_1 = require(\"./JsonRpcEngine\");\nfunction mergeMiddleware(middlewareStack) {\n    const engine = new JsonRpcEngine_1.JsonRpcEngine();\n    middlewareStack.forEach((middleware) => engine.push(middleware));\n    return engine.asMiddleware();\n}\nexports.mergeMiddleware = mergeMiddleware;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVyZ2VNaWRkbGV3YXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL21lcmdlTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxtREFBbUU7QUFFbkUsU0FBZ0IsZUFBZSxDQUFDLGVBQXNEO0lBQ3BGLE1BQU0sTUFBTSxHQUFHLElBQUksNkJBQWEsRUFBRSxDQUFDO0lBQ25DLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUNqRSxPQUFPLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUMvQixDQUFDO0FBSkQsMENBSUMifQ==","module.exports = function createScaffoldMiddleware (handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method]\n    // if no handler, return\n    if (handler === undefined) {\n      return next()\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === 'function') {\n      return handler(req, res, next, end)\n    }\n    // if handler is some other value, use as result\n    res.result = handler\n    return end()\n  }\n}\n","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst BaseFilterWithHistory = require('./base-filter-history')\nconst { bnToHex, hexToInt, incrementHexInt, minBlockRef, blockRefIsNumber } = require('./hexUtils')\n\nclass LogFilter extends BaseFilterWithHistory {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'log'\n    this.ethQuery = new EthQuery(provider)\n    this.params = Object.assign({\n      fromBlock: 'latest',\n      toBlock: 'latest',\n      address: undefined,\n      topics: [],\n    }, params)\n    // normalize address parameter\n    if (this.params.address) {\n      // ensure array\n      if (!Array.isArray(this.params.address)) {\n        this.params.address = [this.params.address]\n      }\n      // ensure lowercase\n      this.params.address = this.params.address.map(address => address.toLowerCase())\n    }\n  }\n\n  async initialize({ currentBlock }) {\n    // resolve params.fromBlock\n    let fromBlock = this.params.fromBlock\n    if (['latest', 'pending'].includes(fromBlock)) fromBlock = currentBlock\n    if ('earliest' === fromBlock) fromBlock = '0x0'\n    this.params.fromBlock = fromBlock\n    // set toBlock for initial lookup\n    const toBlock = minBlockRef(this.params.toBlock, currentBlock)\n    const params = Object.assign({}, this.params, { toBlock })\n    // fetch logs and add to results\n    const newLogs = await this._fetchLogs(params)\n    this.addInitialResults(newLogs)\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    // configure params for this update\n    const toBlock = newBlock\n    let fromBlock\n    // oldBlock is empty on first sync\n    if (oldBlock) {\n      fromBlock = incrementHexInt(oldBlock)\n    } else {\n      fromBlock = newBlock\n    }\n    // fetch logs\n    const params = Object.assign({}, this.params, { fromBlock, toBlock })\n    const newLogs = await this._fetchLogs(params)\n    const matchingLogs = newLogs.filter(log => this.matchLog(log))\n\n    // add to results\n    this.addResults(matchingLogs)\n  }\n\n  async _fetchLogs (params) {\n    const newLogs = await pify(cb => this.ethQuery.getLogs(params, cb))()\n    // add to results\n    return newLogs\n  }\n\n  matchLog(log) {\n    // check if block number in bounds:\n    if (hexToInt(this.params.fromBlock) >= hexToInt(log.blockNumber)) return false\n    if (blockRefIsNumber(this.params.toBlock) && hexToInt(this.params.toBlock) <= hexToInt(log.blockNumber)) return false\n\n    // address is correct:\n    const normalizedLogAddress = log.address && log.address.toLowerCase()\n    if (this.params.address && normalizedLogAddress && !this.params.address.includes(normalizedLogAddress)) return false\n\n    // topics match:\n    // topics are position-dependant\n    // topics can be nested to represent `or` [[a || b], c]\n    // topics can be null, representing a wild card for that position\n    const topicsMatch = this.params.topics.every((topicPattern, index) => {\n      // pattern is longer than actual topics\n      let logTopic = log.topics[index]\n      if (!logTopic) return false\n      logTopic = logTopic.toLowerCase()\n      // normalize subTopics\n      let subtopicsToMatch = Array.isArray(topicPattern) ? topicPattern : [topicPattern]\n      // check for wild card\n      const subtopicsIncludeWildcard = subtopicsToMatch.includes(null)\n      if (subtopicsIncludeWildcard) return true\n      subtopicsToMatch = subtopicsToMatch.map(topic => topic.toLowerCase())\n      // check each possible matching topic\n      const topicDoesMatch = subtopicsToMatch.includes(logTopic)\n      return topicDoesMatch\n    })\n\n    return topicsMatch\n  }\n\n}\n\nmodule.exports = LogFilter\n","'use strict';\n\nconst processFn = (fn, options, proxy, unwrapped) => function (...arguments_) {\n\tconst P = options.promiseModule;\n\n\treturn new P((resolve, reject) => {\n\t\tif (options.multiArgs) {\n\t\t\targuments_.push((...result) => {\n\t\t\t\tif (options.errorFirst) {\n\t\t\t\t\tif (result[0]) {\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.shift();\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (options.errorFirst) {\n\t\t\targuments_.push((error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targuments_.push(resolve);\n\t\t}\n\n\t\tconst self = this === proxy ? unwrapped : this;\n\t\tReflect.apply(fn, self, arguments_);\n\t});\n};\n\nconst filterCache = new WeakMap();\n\nmodule.exports = (input, options) => {\n\toptions = {\n\t\texclude: [/.+(?:Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise,\n\t\t...options\n\t};\n\n\tconst objectType = typeof input;\n\tif (!(input !== null && (objectType === 'object' || objectType === 'function'))) {\n\t\tthrow new TypeError(`Expected \\`input\\` to be a \\`Function\\` or \\`Object\\`, got \\`${input === null ? 'null' : objectType}\\``);\n\t}\n\n\tconst filter = (target, key) => {\n\t\tlet cached = filterCache.get(target);\n\n\t\tif (!cached) {\n\t\t\tcached = {};\n\t\t\tfilterCache.set(target, cached);\n\t\t}\n\n\t\tif (key in cached) {\n\t\t\treturn cached[key];\n\t\t}\n\n\t\tconst match = pattern => (typeof pattern === 'string' || typeof key === 'symbol') ? key === pattern : pattern.test(key);\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(target, key);\n\t\tconst writableOrConfigurableOwn = (desc === undefined || desc.writable || desc.configurable);\n\t\tconst included = options.include ? options.include.some(match) : !options.exclude.some(match);\n\t\tconst shouldFilter = included && writableOrConfigurableOwn;\n\t\tcached[key] = shouldFilter;\n\t\treturn shouldFilter;\n\t};\n\n\tconst cache = new WeakMap();\n\n\tconst proxy = new Proxy(input, {\n\t\tapply(target, thisArg, args) {\n\t\t\tconst cached = cache.get(target);\n\n\t\t\tif (cached) {\n\t\t\t\treturn Reflect.apply(cached, thisArg, args);\n\t\t\t}\n\n\t\t\tconst pified = options.excludeMain ? target : processFn(target, options, proxy, target);\n\t\t\tcache.set(target, pified);\n\t\t\treturn Reflect.apply(pified, thisArg, args);\n\t\t},\n\n\t\tget(target, key) {\n\t\t\tconst property = target[key];\n\n\t\t\t// eslint-disable-next-line no-use-extend-native/no-use-extend-native\n\t\t\tif (!filter(target, key) || property === Function.prototype[key]) {\n\t\t\t\treturn property;\n\t\t\t}\n\n\t\t\tconst cached = cache.get(property);\n\n\t\t\tif (cached) {\n\t\t\t\treturn cached;\n\t\t\t}\n\n\t\t\tif (typeof property === 'function') {\n\t\t\t\tconst pified = processFn(property, options, proxy, target);\n\t\t\t\tcache.set(property, pified);\n\t\t\t\treturn pified;\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t});\n\n\treturn proxy;\n};\n","const BaseFilter = require('./base-filter')\n\n// tracks all results ever recorded\nclass BaseFilterWithHistory extends BaseFilter {\n\n  constructor () {\n    super()\n    this.allResults = []\n  }\n\n  async update () {\n    throw new Error('BaseFilterWithHistory - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addResults(newResults)\n  }\n\n  addInitialResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addInitialResults(newResults)\n  }\n\n  getAllResults () {\n    return this.allResults\n  }\n\n}\n\nmodule.exports = BaseFilterWithHistory","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass BlockFilter extends BaseFilter {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'block'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    const toBlock = newBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blockBodies = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockHashes = blockBodies.map((block) => block.hash)\n    this.addResults(blockHashes)\n  }\n\n}\n\nmodule.exports = BlockFilter\n","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass TxFilter extends BaseFilter {\n\n  constructor ({ provider }) {\n    super()\n    this.type = 'tx'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock }) {\n    const toBlock = oldBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blocks = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockTxHashes = []\n    for (const block of blocks) {\n      blockTxHashes.push(...block.transactions)\n    }\n    // add to results\n    this.addResults(blockTxHashes)\n  }\n\n}\n\nmodule.exports = TxFilter\n","import { __awaiter, __generator } from \"tslib\";\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_maxConcurrency) {\n        this._maxConcurrency = _maxConcurrency;\n        this._queue = [];\n        if (_maxConcurrency <= 0) {\n            throw new Error('semaphore must be initialized to a positive value');\n        }\n        this._value = _maxConcurrency;\n    }\n    Semaphore.prototype.acquire = function () {\n        var _this = this;\n        var locked = this.isLocked();\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\n        if (!locked)\n            this._dispatch();\n        return ticket;\n    };\n    Semaphore.prototype.runExclusive = function (callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire()];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.release = function () {\n        if (this._maxConcurrency > 1) {\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n        }\n        if (this._currentReleaser) {\n            var releaser = this._currentReleaser;\n            this._currentReleaser = undefined;\n            releaser();\n        }\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _this = this;\n        var nextConsumer = this._queue.shift();\n        if (!nextConsumer)\n            return;\n        var released = false;\n        this._currentReleaser = function () {\n            if (released)\n                return;\n            released = true;\n            _this._value++;\n            _this._dispatch();\n        };\n        nextConsumer([this._value--, this._currentReleaser]);\n    };\n    return Semaphore;\n}());\nexport default Semaphore;\n","import { __awaiter, __generator } from \"tslib\";\nimport Semaphore from './Semaphore';\nvar Mutex = /** @class */ (function () {\n    function Mutex() {\n        this._semaphore = new Semaphore(1);\n    }\n    Mutex.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, releaser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this._semaphore.acquire()];\n                    case 1:\n                        _a = _b.sent(), releaser = _a[1];\n                        return [2 /*return*/, releaser];\n                }\n            });\n        });\n    };\n    Mutex.prototype.runExclusive = function (callback) {\n        return this._semaphore.runExclusive(function () { return callback(); });\n    };\n    Mutex.prototype.isLocked = function () {\n        return this._semaphore.isLocked();\n    };\n    Mutex.prototype.release = function () {\n        this._semaphore.release();\n    };\n    return Mutex;\n}());\nexport default Mutex;\n","import { __awaiter, __generator } from \"tslib\";\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = new Error('timeout'); }\n    return {\n        acquire: function () {\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                var isTimeout, ticket, release;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            return [4 /*yield*/, sync.acquire()];\n                        case 1:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                resolve(ticket);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback) {\n            return __awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire()];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function () {\n            sync.release();\n        },\n        isLocked: function () { return sync.isLocked(); },\n    };\n}\n","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\ti;\n\tfor (i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(\n\t\ttype,\n\t\tnormalizedProps,\n\t\tprops && props.key,\n\t\tprops && props.ref,\n\t\tnull\n\t);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\tconstructor: undefined,\n\t\t_original: original\n\t};\n\n\tif (original == null) vnode._original = vnode;\n\tif (options.vnode) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn {};\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\tupdate = update(s, this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = oldVNode;\n\n\t\tlet newDom = diff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tnull,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (newDom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\nlet rerenderCount = 0;\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\nconst IS_HYDRATE = EMPTY_OBJ;\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {Element | Text} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we\n\t// are in hydration mode or not by passing `IS_HYDRATE` instead of a\n\t// DOM element.\n\tlet isHydrating = replaceNode === IS_HYDRATE;\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\tvnode = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\t((isHydrating ? parentDom : replaceNode || parentDom)._children = vnode),\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\treplaceNode && !isHydrating\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: EMPTY_ARR.slice.call(parentDom.childNodes),\n\t\tcommitQueue,\n\t\treplaceNode || EMPTY_OBJ,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, IS_HYDRATE);\n}\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue) {\n\tconst ctx = {};\n\n\tconst context = {\n\t\t_id: '__cC' + i++,\n\t\t_defaultValue: defaultValue,\n\t\tConsumer(props, context) {\n\t\t\treturn props.children(context);\n\t\t},\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tconst subs = [];\n\t\t\t\tthis.getChildContext = () => {\n\t\t\t\t\tctx[context._id] = this;\n\t\t\t\t\treturn ctx;\n\t\t\t\t};\n\n\t\t\t\tthis.shouldComponentUpdate = _props => {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\tsubs.some(c => {\n\t\t\t\t\t\t\tc.context = _props.value;\n\t\t\t\t\t\t\tenqueueRender(c);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\told && old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\tcontext.Consumer.contextType = context;\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\tcontext.Provider._contextRef = context;\n\n\treturn context;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { removeNode } from '../util';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Node | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, newDom, sibDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\t// Only in very specific places should this logic be invoked (top level `render` and `diffElementNodes`).\n\t// I'm using `EMPTY_OBJ` to signal when `diffChildren` is invoked in these situations. I can't use `null`\n\t// for this purpose, because `null` is a valid value for `oldDom` which can mean to skip to this logic\n\t// (e.g. if mounting a new tree in which the old DOM should be ignored (usually for Fragments).\n\tif (oldDom == EMPTY_OBJ) {\n\t\tif (excessDomChildren != null) {\n\t\t\toldDom = excessDomChildren[0];\n\t\t} else if (oldChildrenLength) {\n\t\t\toldDom = getDomSibling(oldParentVNode, 0);\n\t\t} else {\n\t\t\toldDom = null;\n\t\t}\n\t}\n\n\ti = 0;\n\tnewParentVNode._children = toChildArray(\n\t\tnewParentVNode._children,\n\t\tchildVNode => {\n\t\t\tif (childVNode != null) {\n\t\t\t\tchildVNode._parent = newParentVNode;\n\t\t\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t\t\t// Check if we find a corresponding element in oldChildren.\n\t\t\t\t// If found, delete the array item by setting to `undefined`.\n\t\t\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t\t\t// (holes).\n\t\t\t\toldVNode = oldChildren[i];\n\n\t\t\t\tif (\n\t\t\t\t\toldVNode === null ||\n\t\t\t\t\t(oldVNode &&\n\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t\t\t) {\n\t\t\t\t\toldChildren[i] = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t\t\t// We always match by type (in either case).\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\toldVNode &&\n\t\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldVNode = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\t\t\tnewDom = diff(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\tglobalContext,\n\t\t\t\t\tisSvg,\n\t\t\t\t\texcessDomChildren,\n\t\t\t\t\tcommitQueue,\n\t\t\t\t\toldDom,\n\t\t\t\t\tisHydrating\n\t\t\t\t);\n\n\t\t\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\t\t\tif (!refs) refs = [];\n\t\t\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t\t\t}\n\n\t\t\t\t// Only proceed if the vnode has not been unmounted by `diff()` above.\n\t\t\t\tif (newDom != null) {\n\t\t\t\t\tif (firstChildDom == null) {\n\t\t\t\t\t\tfirstChildDom = newDom;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet nextDom;\n\t\t\t\t\tif (childVNode._nextDom !== undefined) {\n\t\t\t\t\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t\t\t\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t\t\t\t\t// of last DOM child of this child VNode\n\t\t\t\t\t\tnextDom = childVNode._nextDom;\n\n\t\t\t\t\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t\t\t\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t\t\t\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t\t\t\t\t// can clean up the property\n\t\t\t\t\t\tchildVNode._nextDom = undefined;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\texcessDomChildren == oldVNode ||\n\t\t\t\t\t\tnewDom != oldDom ||\n\t\t\t\t\t\tnewDom.parentNode == null\n\t\t\t\t\t) {\n\t\t\t\t\t\t// NOTE: excessDomChildren==oldVNode above:\n\t\t\t\t\t\t// This is a compression of excessDomChildren==null && oldVNode==null!\n\t\t\t\t\t\t// The values only have the same type when `null`.\n\n\t\t\t\t\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\t\t\t\t\tparentDom.appendChild(newDom);\n\t\t\t\t\t\t\tnextDom = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\t\tsibDom = oldDom, j = 0;\n\t\t\t\t\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildrenLength;\n\t\t\t\t\t\t\t\tj += 2\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\t\t\t\t\tnextDom = oldDom;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t\t\t\t// there are probably some internal data structures that aren't\n\t\t\t\t\t\t// updated properly.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t\t\t\t// value check in `diff()` won't be skipped.\n\t\t\t\t\t\tif (newParentVNode.type == 'option') {\n\t\t\t\t\t\t\tparentDom.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t\t\t\t\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t\t\t\t\t// See more detail in create-element.js:createVNode\n\t\t\t\t\tif (nextDom !== undefined) {\n\t\t\t\t\t\toldDom = nextDom;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldDom = newDom.nextSibling;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t\t\t// node's nextSibling.\n\n\t\t\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\toldDom &&\n\t\t\t\t\toldVNode._dom == oldDom &&\n\t\t\t\t\toldDom.parentNode != parentDom\n\t\t\t\t) {\n\t\t\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\t\t\toldDom = getDomSibling(oldVNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti++;\n\t\t\treturn childVNode;\n\t\t}\n\t);\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove children that are not part of any vnode.\n\tif (excessDomChildren != null && typeof newParentVNode.type != 'function') {\n\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t}\n\t}\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) unmount(oldChildren[i], oldChildren[i]);\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @param {(vnode: import('../internal').VNode) => import('../internal').VNode} [callback]\n * A function to invoke for each child before it is added to the flattened list.\n * @param {Array<import('../internal').VNode | string | number>} [flattened] An flat array of children to modify\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, callback, flattened) {\n\tif (flattened == null) flattened = [];\n\n\tif (children == null || typeof children == 'boolean') {\n\t\tif (callback) flattened.push(callback(null));\n\t} else if (Array.isArray(children)) {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\ttoChildArray(children[i], callback, flattened);\n\t\t}\n\t} else if (!callback) {\n\t\tflattened.push(children);\n\t} else if (typeof children == 'string' || typeof children == 'number') {\n\t\tflattened.push(callback(createVNode(null, children, null, null, children)));\n\t} else if (children._dom != null || children._component != null) {\n\t\tflattened.push(\n\t\t\tcallback(\n\t\t\t\tcreateVNode(\n\t\t\t\t\tchildren.type,\n\t\t\t\t\tchildren.props,\n\t\t\t\t\tchildren.key,\n\t\t\t\t\tnull,\n\t\t\t\t\tchildren._original\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tflattened.push(callback(children));\n\t}\n\n\treturn flattened;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (\n\t\ttypeof value == 'number' &&\n\t\tIS_NON_DIMENSIONAL.test(key) === false\n\t) {\n\t\tstyle[key] = value + 'px';\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else {\n\t\tstyle[key] = value;\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet s, useCapture, nameLower;\n\n\tif (isSvg) {\n\t\tif (name === 'className') {\n\t\t\tname = 'class';\n\t\t}\n\t} else if (name === 'class') {\n\t\tname = 'className';\n\t}\n\n\tif (name === 'style') {\n\t\ts = dom.style;\n\n\t\tif (typeof value == 'string') {\n\t\t\ts.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\ts.cssText = '';\n\t\t\t\toldValue = null;\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (let i in oldValue) {\n\t\t\t\t\tif (!(value && i in value)) {\n\t\t\t\t\t\tsetStyle(s, i, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (let i in value) {\n\t\t\t\t\tif (!oldValue || value[i] !== oldValue[i]) {\n\t\t\t\t\t\tsetStyle(s, i, value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tnameLower = name.toLowerCase();\n\t\tname = (nameLower in dom ? nameLower : name).slice(2);\n\n\t\tif (value) {\n\t\t\tif (!oldValue) dom.addEventListener(name, eventProxy, useCapture);\n\t\t\t(dom._listeners || (dom._listeners = {}))[name] = value;\n\t\t} else {\n\t\t\tdom.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t} else if (\n\t\tname !== 'list' &&\n\t\tname !== 'tagName' &&\n\t\t// HTMLButtonElement.form and HTMLInputElement.form are read-only but can be set using\n\t\t// setAttribute\n\t\tname !== 'form' &&\n\t\tname !== 'type' &&\n\t\tname !== 'size' &&\n\t\t!isSvg &&\n\t\tname in dom\n\t) {\n\t\tdom[name] = value == null ? '' : value;\n\t} else if (typeof value != 'function' && name !== 'dangerouslySetInnerHTML') {\n\t\tif (name !== (name = name.replace(/^xlink:?/, ''))) {\n\t\t\tif (value == null || value === false) {\n\t\t\t\tdom.removeAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdom.setAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase(),\n\t\t\t\t\tvalue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tvalue == null ||\n\t\t\t(value === false &&\n\t\t\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t\t\t// The value `false` is different from the attribute not\n\t\t\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t\t\t// that other VDOM frameworks also always stringify `false`.\n\t\t\t\t!/^ar/.test(name))\n\t\t) {\n\t\t\tdom.removeAttribute(name);\n\t\t} else {\n\t\t\tdom.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Element | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\t(newVNode._original === oldVNode._original && !c._processingException)\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (tmp = 0; tmp < newVNode._children.length; tmp++) {\n\t\t\t\t\t\tif (newVNode._children[tmp]) {\n\t\t\t\t\t\t\tnewVNode._children[tmp]._parent = newVNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type == Fragment && tmp.key == null;\n\t\t\tnewVNode._children = isTopLevelFragment\n\t\t\t\t? tmp.props.children\n\t\t\t\t: Array.isArray(tmp)\n\t\t\t\t? tmp\n\t\t\t\t: [tmp];\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n\n\treturn newVNode._dom;\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet i;\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvg = newVNode.type === 'svg' || isSvg;\n\n\tif (excessDomChildren != null) {\n\t\tfor (i = 0; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild != null &&\n\t\t\t\t((newVNode.type === null\n\t\t\t\t\t? child.nodeType === 3\n\t\t\t\t\t: child.localName === newVNode.type) ||\n\t\t\t\t\tdom == child)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (newVNode.type === null) {\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tdom = isSvg\n\t\t\t? document.createElementNS('http://www.w3.org/2000/svg', newVNode.type)\n\t\t\t: document.createElement(\n\t\t\t\t\tnewVNode.type,\n\t\t\t\t\tnewProps.is && { is: newProps.is }\n\t\t\t  );\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (newVNode.type === null) {\n\t\tif (oldProps !== newProps && dom.data != newProps) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\tif (excessDomChildren != null) {\n\t\t\texcessDomChildren = EMPTY_ARR.slice.call(dom.childNodes);\n\t\t}\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\tif (oldProps === EMPTY_OBJ) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (!newHtml || !oldHtml || newHtml.__html != oldHtml.__html) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\tnewVNode._children = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tnewVNode.type === 'foreignObject' ? false : isSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tEMPTY_OBJ,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\ti !== dom.value\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { assign } from './util';\nimport { EMPTY_ARR } from './constants';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./index').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props) {\n\tprops = assign(assign({}, vnode.props), props);\n\tif (arguments.length > 2) props.children = EMPTY_ARR.slice.call(arguments, 2);\n\tlet normalizedProps = {};\n\tfor (const i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tprops.key || vnode.key,\n\t\tprops.ref || vnode.ref,\n\t\tnull\n\t);\n}\n","import { enqueueRender } from '../component';\n\n/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, hasCaught;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tif (\n\t\t\t\t\tcomponent.constructor &&\n\t\t\t\t\tcomponent.constructor.getDerivedStateFromError != null\n\t\t\t\t) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.setState(\n\t\t\t\t\t\tcomponent.constructor.getDerivedStateFromError(error)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t}\n\n\t\t\t\tif (hasCaught)\n\t\t\t\t\treturn enqueueRender((component._pendingError = component));\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tif (currentComponent.__hooks) {\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\tcurrentComponent.__hooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\tif (hooks._pendingEffects.length) {\n\t\t\tafterPaint(afterPaintEffects.push(c));\n\t\t}\n\t}\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\ttry {\n\t\t\thooks._list.forEach(hook => hook._cleanup && hook._cleanup());\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {import('./internal').HookState}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} initialState\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\tif (!hookState._component) {\n\t\thookState._component = currentComponent;\n\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value[0] = nextValue;\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t\treturn (state._value = factory());\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\nexport function useErrorBoundary(cb) {\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.some(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tcancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (typeof window != 'undefined') {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\tif (hook._cleanup) hook._cleanup();\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\tconst result = hook._value();\n\tif (typeof result == 'function') hook._cleanup = result;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn !oldArgs || newArgs.some((arg, index) => arg !== oldArgs[index]);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","\nmodule.exports = {\n  minBlockRef,\n  maxBlockRef,\n  sortBlockRefs,\n  bnToHex,\n  blockRefIsNumber,\n  hexToInt,\n  incrementHexInt,\n  intToHex,\n  unsafeRandomBytes,\n}\n\nfunction minBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[0]\n}\n\nfunction maxBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[sortedRefs.length-1]\n}\n\nfunction sortBlockRefs(refs) {\n  return refs.sort((refA, refB) => {\n    if (refA === 'latest' || refB === 'earliest') return 1\n    if (refB === 'latest' || refA === 'earliest') return -1\n    return hexToInt(refA) - hexToInt(refB)\n  })\n}\n\nfunction bnToHex(bn) {\n  return '0x' + bn.toString(16)\n}\n\nfunction blockRefIsNumber(blockRef){\n  return blockRef && !['earliest', 'latest', 'pending'].includes(blockRef)\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  let hexString = int.toString(16)\n  const needsLeftPad = hexString.length % 2\n  if (needsLeftPad) hexString = '0' + hexString\n  return '0x' + hexString\n}\n\nfunction unsafeRandomBytes(byteCount) {\n  let result = '0x'\n  for (let i = 0; i < byteCount; i++) {\n    result += unsafeRandomNibble()\n    result += unsafeRandomNibble()\n  }\n  return result\n}\n\nfunction unsafeRandomNibble() {\n  return Math.floor(Math.random() * 16).toString(16)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = require(\"events\");\nfunction safeApply(handler, context, args) {\n    try {\n        Reflect.apply(handler, context, args);\n    }\n    catch (err) {\n        // Throw error after timeout so as not to interrupt the stack\n        setTimeout(() => {\n            throw err;\n        });\n    }\n}\nfunction arrayClone(arr) {\n    const n = arr.length;\n    const copy = new Array(n);\n    for (let i = 0; i < n; i += 1) {\n        copy[i] = arr[i];\n    }\n    return copy;\n}\nclass SafeEventEmitter extends events_1.EventEmitter {\n    emit(type, ...args) {\n        let doError = type === 'error';\n        const events = this._events;\n        if (events !== undefined) {\n            doError = doError && events.error === undefined;\n        }\n        else if (!doError) {\n            return false;\n        }\n        // If there is no 'error' event listener then throw.\n        if (doError) {\n            let er;\n            if (args.length > 0) {\n                [er] = args;\n            }\n            if (er instanceof Error) {\n                // Note: The comments on the `throw` lines are intentional, they show\n                // up in Node's output if this results in an unhandled exception.\n                throw er; // Unhandled 'error' event\n            }\n            // At least give some kind of context to the user\n            const err = new Error(`Unhandled error.${er ? ` (${er.message})` : ''}`);\n            err.context = er;\n            throw err; // Unhandled 'error' event\n        }\n        const handler = events[type];\n        if (handler === undefined) {\n            return false;\n        }\n        if (typeof handler === 'function') {\n            safeApply(handler, this, args);\n        }\n        else {\n            const len = handler.length;\n            const listeners = arrayClone(handler);\n            for (let i = 0; i < len; i += 1) {\n                safeApply(listeners[i], this, args);\n            }\n        }\n        return true;\n    }\n}\nexports.default = SafeEventEmitter;\n//# sourceMappingURL=index.js.map","\nconst { EthereumRpcError, EthereumProviderError } = require('./src/classes')\nconst {\n  serializeError, getMessageFromCode,\n} = require('./src/utils')\nconst ethErrors = require('./src/errors')\nconst ERROR_CODES = require('./src/errorCodes.json')\n\nmodule.exports = {\n  ethErrors,\n  EthereumRpcError,\n  EthereumProviderError,\n  serializeError,\n  getMessageFromCode,\n\n  /** @type ErrorCodes */\n  ERROR_CODES,\n}\n\n// Types\n\n/**\n * @typedef {Object} EthereumProviderErrorCodes\n * @property {number} userRejectedRequest\n * @property {number} unauthorized\n * @property {number} unsupportedMethod\n * @property {number} disconnected\n * @property {number} chainDisconnected\n */\n\n/**\n * @typedef {Object} EthereumRpcErrorCodes\n * @property {number} parse\n * @property {number} invalidRequest\n * @property {number} invalidParams\n * @property {number} methodNotFound\n * @property {number} limitExceeded\n * @property {number} internal\n * @property {number} invalidInput\n * @property {number} resourceNotFound\n * @property {number} resourceUnavailable\n * @property {number} transactionRejected\n * @property {number} methodNotSupported\n */\n\n/**\n * @typedef ErrorCodes\n * @property {EthereumRpcErrorCodes} rpc\n * @property {EthereumProviderErrorCodes} provider\n */\n","\nconst safeStringify = require('fast-safe-stringify')\n\n/**\n * @class JsonRpcError\n * Error subclass implementing JSON RPC 2.0 errors and Ethereum RPC errors\n * per EIP 1474.\n * Permits any integer error code.\n */\nclass EthereumRpcError extends Error {\n\n  /**\n   * Create an Ethereum JSON RPC error.\n   *\n   * @param {number} code - The integer error code.\n   * @param {string} message - The string message.\n   * @param {any} [data] - The error data.\n   */\n  constructor (code, message, data) {\n\n    if (!Number.isInteger(code)) {\n      throw new Error(\n        '\"code\" must be an integer.',\n      )\n    }\n    if (!message || typeof message !== 'string') {\n      throw new Error(\n        '\"message\" must be a nonempty string.',\n      )\n    }\n\n    super(message)\n    this.code = code\n    if (data !== undefined) {\n      this.data = data\n    }\n  }\n\n  /**\n   * Returns a plain object with all public class properties.\n   *\n   * @returns {object} The serialized error.\n   */\n  serialize () {\n    const serialized = {\n      code: this.code,\n      message: this.message,\n    }\n    if (this.data !== undefined) {\n      serialized.data = this.data\n    }\n    if (this.stack) {\n      serialized.stack = this.stack\n    }\n    return serialized\n  }\n\n  /**\n   * Return a string representation of the serialized error, omitting\n   * any circular references.\n   *\n   * @returns {string} The serialized error as a string.\n   */\n  toString () {\n    return safeStringify(\n      this.serialize(),\n      stringifyReplacer,\n      2,\n    )\n  }\n}\n\n/**\n * @class EthereumRpcError\n * Error subclass implementing Ethereum Provider errors per EIP 1193.\n * Permits integer error codes in the [ 1000 <= 4999 ] range.\n */\nclass EthereumProviderError extends EthereumRpcError {\n\n  /**\n   * Create an Ethereum JSON RPC error.\n   *\n   * @param {number} code - The integer error code, in the [ 1000 <= 4999 ] range.\n   * @param {string} message - The string message.\n   * @param {any} [data] - The error data.\n   */\n  constructor (code, message, data) {\n\n    if (!isValidEthProviderCode(code)) {\n      throw new Error(\n        '\"code\" must be an integer such that: 1000 <= code <= 4999',\n      )\n    }\n\n    super(code, message, data)\n  }\n}\n\n// Internal\n\nfunction isValidEthProviderCode (code) {\n  return Number.isInteger(code) && code >= 1000 && code <= 4999\n}\n\nfunction stringifyReplacer (_, value) {\n  if (value === '[Circular]') {\n    return undefined\n  }\n  return value\n}\n\n// Exports\n\nmodule.exports = {\n  EthereumRpcError,\n  EthereumProviderError,\n}\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\n\nclass BaseFilter extends SafeEventEmitter {\n\n  constructor () {\n    super()\n    this.updates = []\n  }\n\n  async initialize () {}\n\n  async update () {\n    throw new Error('BaseFilter - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.updates = this.updates.concat(newResults)\n    newResults.forEach(result => this.emit('update', result))\n  }\n\n  addInitialResults (newResults) {}\n\n  getChangesAndClear () {\n    const updates = this.updates\n    this.updates = []\n    return updates\n  }\n  \n}\n\nmodule.exports = BaseFilter\n","module.exports = getBlocksForRange\n\nasync function getBlocksForRange({ provider, fromBlock, toBlock }) {\n  if (!fromBlock) fromBlock = toBlock\n\n  const fromBlockNumber = hexToInt(fromBlock)\n  const toBlockNumber = hexToInt(toBlock)\n  const blockCountToQuery = toBlockNumber - fromBlockNumber + 1\n  // load all blocks from old to new (inclusive)\n  const missingBlockNumbers = Array(blockCountToQuery).fill()\n                              .map((_,index) => fromBlockNumber + index)\n                              .map(intToHex)\n  const blockBodies = await Promise.all(\n    missingBlockNumbers.map(blockNum => query(provider, 'eth_getBlockByNumber', [blockNum, false]))\n  )\n  return blockBodies\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  const hexString = int.toString(16)\n  return '0x' + hexString\n}\n\nfunction query(provider, method, params) {\n  return new Promise((resolve, reject) => {\n    provider.sendAsync({ id: 1, jsonrpc: '2.0', method, params }, (err, res) => {\n      if (err) return reject(err)\n      resolve(res.result)\n    })\n  })\n}\n","const pify = require('pify')\nconst BaseBlockTracker = require('./base')\n\nconst sec = 1000\n\nclass PollingBlockTracker extends BaseBlockTracker {\n\n  constructor (opts = {}) {\n    // parse + validate args\n    if (!opts.provider) throw new Error('PollingBlockTracker - no provider specified.')\n    const pollingInterval = opts.pollingInterval || 20 * sec\n    const retryTimeout = opts.retryTimeout || pollingInterval / 10\n    const keepEventLoopActive = opts.keepEventLoopActive !== undefined ? opts.keepEventLoopActive : true\n    const setSkipCacheFlag = opts.setSkipCacheFlag || false\n    // BaseBlockTracker constructor\n    super(Object.assign({\n      blockResetDuration: pollingInterval,\n    }, opts))\n    // config\n    this._provider = opts.provider\n    this._pollingInterval = pollingInterval\n    this._retryTimeout = retryTimeout\n    this._keepEventLoopActive = keepEventLoopActive\n    this._setSkipCacheFlag = setSkipCacheFlag\n  }\n\n  //\n  // public\n  //\n\n  // trigger block polling\n  async checkForLatestBlock () {\n    await this._updateLatestBlock()\n    return await this.getLatestBlock()\n  }\n\n  //\n  // private\n  //\n\n  _start () {\n    this._performSync().catch(err => this.emit('error', err))\n  }\n\n  async _performSync () {\n    while (this._isRunning) {\n      try {\n        await this._updateLatestBlock()\n        await timeout(this._pollingInterval, !this._keepEventLoopActive)\n      } catch (err) {\n        const newErr = new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\\n${err.stack}`)\n        try {\n          this.emit('error', newErr)\n        } catch (emitErr) {\n          console.error(newErr)\n        }\n        await timeout(this._retryTimeout, !this._keepEventLoopActive)\n      }\n    }\n  }\n\n  async _updateLatestBlock () {\n    // fetch + set latest block\n    const latestBlock = await this._fetchLatestBlock()\n    this._newPotentialLatest(latestBlock)\n  }\n\n  async _fetchLatestBlock () {\n    const req = { jsonrpc: \"2.0\", id: 1, method: 'eth_blockNumber', params: [] }\n    if (this._setSkipCacheFlag) req.skipCache = true\n    const res = await pify((cb) => this._provider.sendAsync(req, cb))()\n    if (res.error) throw new Error(`PollingBlockTracker - encountered error fetching block:\\n${res.error}`)\n    return res.result\n  }\n\n}\n\nmodule.exports = PollingBlockTracker\n\nfunction timeout (duration, unref) {\n  return new Promise(resolve => {\n    const timoutRef = setTimeout(resolve, duration)\n    // don't keep process open\n    if (timoutRef.unref && unref) {\n      timoutRef.unref()\n    }\n  })\n}\n","'use strict';\n\nconst processFn = (fn, opts) => function () {\n\tconst P = opts.promiseModule;\n\tconst args = new Array(arguments.length);\n\n\tfor (let i = 0; i < arguments.length; i++) {\n\t\targs[i] = arguments[i];\n\t}\n\n\treturn new P((resolve, reject) => {\n\t\tif (opts.errorFirst) {\n\t\t\targs.push(function (err, result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 1; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i - 1] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tresults.unshift(err);\n\t\t\t\t\t\treject(results);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(results);\n\t\t\t\t\t}\n\t\t\t\t} else if (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targs.push(function (result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(results);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfn.apply(this, args);\n\t});\n};\n\nmodule.exports = (obj, opts) => {\n\topts = Object.assign({\n\t\texclude: [/.+(Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise\n\t}, opts);\n\n\tconst filter = key => {\n\t\tconst match = pattern => typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\t\treturn opts.include ? opts.include.some(match) : !opts.exclude.some(match);\n\t};\n\n\tlet ret;\n\tif (typeof obj === 'function') {\n\t\tret = function () {\n\t\t\tif (opts.excludeMain) {\n\t\t\t\treturn obj.apply(this, arguments);\n\t\t\t}\n\n\t\t\treturn processFn(obj, opts).apply(this, arguments);\n\t\t};\n\t} else {\n\t\tret = Object.create(Object.getPrototypeOf(obj));\n\t}\n\n\tfor (const key in obj) { // eslint-disable-line guard-for-in\n\t\tconst x = obj[key];\n\t\tret[key] = typeof x === 'function' && filter(key) ? processFn(x, opts) : x;\n\t}\n\n\treturn ret;\n};\n","const extend = require('xtend')\nconst createRandomId = require('json-rpc-random-id')()\n\nmodule.exports = EthQuery\n\n\nfunction EthQuery(provider){\n  const self = this\n  self.currentProvider = provider\n}\n\n//\n// base queries\n//\n\n// default block\nEthQuery.prototype.getBalance =                          generateFnWithDefaultBlockFor(2, 'eth_getBalance')\nEthQuery.prototype.getCode =                             generateFnWithDefaultBlockFor(2, 'eth_getCode')\nEthQuery.prototype.getTransactionCount =                 generateFnWithDefaultBlockFor(2, 'eth_getTransactionCount')\nEthQuery.prototype.getStorageAt =                        generateFnWithDefaultBlockFor(3, 'eth_getStorageAt')\nEthQuery.prototype.call =                                generateFnWithDefaultBlockFor(2, 'eth_call')\n// standard\nEthQuery.prototype.protocolVersion =                     generateFnFor('eth_protocolVersion')\nEthQuery.prototype.syncing =                             generateFnFor('eth_syncing')\nEthQuery.prototype.coinbase =                            generateFnFor('eth_coinbase')\nEthQuery.prototype.mining =                              generateFnFor('eth_mining')\nEthQuery.prototype.hashrate =                            generateFnFor('eth_hashrate')\nEthQuery.prototype.gasPrice =                            generateFnFor('eth_gasPrice')\nEthQuery.prototype.accounts =                            generateFnFor('eth_accounts')\nEthQuery.prototype.blockNumber =                         generateFnFor('eth_blockNumber')\nEthQuery.prototype.getBlockTransactionCountByHash =      generateFnFor('eth_getBlockTransactionCountByHash')\nEthQuery.prototype.getBlockTransactionCountByNumber =    generateFnFor('eth_getBlockTransactionCountByNumber')\nEthQuery.prototype.getUncleCountByBlockHash =            generateFnFor('eth_getUncleCountByBlockHash')\nEthQuery.prototype.getUncleCountByBlockNumber =          generateFnFor('eth_getUncleCountByBlockNumber')\nEthQuery.prototype.sign =                                generateFnFor('eth_sign')\nEthQuery.prototype.sendTransaction =                     generateFnFor('eth_sendTransaction')\nEthQuery.prototype.sendRawTransaction =                  generateFnFor('eth_sendRawTransaction')\nEthQuery.prototype.estimateGas =                         generateFnFor('eth_estimateGas')\nEthQuery.prototype.getBlockByHash =                      generateFnFor('eth_getBlockByHash')\nEthQuery.prototype.getBlockByNumber =                    generateFnFor('eth_getBlockByNumber')\nEthQuery.prototype.getTransactionByHash =                generateFnFor('eth_getTransactionByHash')\nEthQuery.prototype.getTransactionByBlockHashAndIndex =   generateFnFor('eth_getTransactionByBlockHashAndIndex')\nEthQuery.prototype.getTransactionByBlockNumberAndIndex = generateFnFor('eth_getTransactionByBlockNumberAndIndex')\nEthQuery.prototype.getTransactionReceipt =               generateFnFor('eth_getTransactionReceipt')\nEthQuery.prototype.getUncleByBlockHashAndIndex =         generateFnFor('eth_getUncleByBlockHashAndIndex')\nEthQuery.prototype.getUncleByBlockNumberAndIndex =       generateFnFor('eth_getUncleByBlockNumberAndIndex')\nEthQuery.prototype.getCompilers =                        generateFnFor('eth_getCompilers')\nEthQuery.prototype.compileLLL =                          generateFnFor('eth_compileLLL')\nEthQuery.prototype.compileSolidity =                     generateFnFor('eth_compileSolidity')\nEthQuery.prototype.compileSerpent =                      generateFnFor('eth_compileSerpent')\nEthQuery.prototype.newFilter =                           generateFnFor('eth_newFilter')\nEthQuery.prototype.newBlockFilter =                      generateFnFor('eth_newBlockFilter')\nEthQuery.prototype.newPendingTransactionFilter =         generateFnFor('eth_newPendingTransactionFilter')\nEthQuery.prototype.uninstallFilter =                     generateFnFor('eth_uninstallFilter')\nEthQuery.prototype.getFilterChanges =                    generateFnFor('eth_getFilterChanges')\nEthQuery.prototype.getFilterLogs =                       generateFnFor('eth_getFilterLogs')\nEthQuery.prototype.getLogs =                             generateFnFor('eth_getLogs')\nEthQuery.prototype.getWork =                             generateFnFor('eth_getWork')\nEthQuery.prototype.submitWork =                          generateFnFor('eth_submitWork')\nEthQuery.prototype.submitHashrate =                      generateFnFor('eth_submitHashrate')\n\n// network level\n\nEthQuery.prototype.sendAsync = function(opts, cb){\n  const self = this\n  self.currentProvider.sendAsync(createPayload(opts), function(err, response){\n    if (!err && response.error) err = new Error('EthQuery - RPC Error - '+response.error.message)\n    if (err) return cb(err)\n    cb(null, response.result)\n  })\n}\n\n// util\n\nfunction generateFnFor(methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction generateFnWithDefaultBlockFor(argCount, methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    // set optional default block param\n    if (args.length < argCount) args.push('latest')\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction createPayload(data){\n  return extend({\n    // defaults\n    id: createRandomId(),\n    jsonrpc: '2.0',\n    params: [],\n    // user-specified\n  }, data)\n}\n","const Mutex = require('async-mutex').Mutex\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createJsonRpcMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst LogFilter = require('./log-filter.js')\nconst BlockFilter = require('./block-filter.js')\nconst TxFilter = require('./tx-filter.js')\nconst { intToHex, hexToInt } = require('./hexUtils')\n\nmodule.exports = createEthFilterMiddleware\n\nfunction createEthFilterMiddleware({ blockTracker, provider }) {\n\n  // create filter collection\n  let filterIndex = 0\n  let filters = {}\n  // create update mutex\n  const mutex = new Mutex()\n  const waitForFree = mutexMiddlewareWrapper({ mutex })\n\n  const middleware = createJsonRpcMiddleware({\n    // install filters\n    eth_newFilter:                   waitForFree(toFilterCreationMiddleware(newLogFilter)),\n    eth_newBlockFilter:              waitForFree(toFilterCreationMiddleware(newBlockFilter)),\n    eth_newPendingTransactionFilter: waitForFree(toFilterCreationMiddleware(newPendingTransactionFilter)),\n    // uninstall filters\n    eth_uninstallFilter:             waitForFree(toAsyncRpcMiddleware(uninstallFilterHandler)),\n    // checking filter changes\n    eth_getFilterChanges:            waitForFree(toAsyncRpcMiddleware(getFilterChanges)),\n    eth_getFilterLogs:               waitForFree(toAsyncRpcMiddleware(getFilterLogs)),\n  })\n\n  // setup filter updating and destroy handler\n  const filterUpdater = async ({ oldBlock, newBlock }) => {\n    if (filters.length === 0) return\n    // lock update reads\n    const releaseLock = await mutex.acquire()\n    try {\n      // process all filters in parallel\n      await Promise.all(objValues(filters).map(async (filter) => {\n        try {\n         await filter.update({ oldBlock, newBlock })\n        } catch (err) {\n          // handle each error individually so filter update errors don't affect other filters\n          console.error(err)\n        }\n      }))\n    } catch (err) {\n      // log error so we don't skip the releaseLock\n      console.error(err)\n    }\n    // unlock update reads\n    releaseLock()\n  }\n\n  // expose filter methods directly\n  middleware.newLogFilter = newLogFilter\n  middleware.newBlockFilter = newBlockFilter\n  middleware.newPendingTransactionFilter = newPendingTransactionFilter\n  middleware.uninstallFilter = uninstallFilterHandler\n  middleware.getFilterChanges = getFilterChanges\n  middleware.getFilterLogs = getFilterLogs\n\n  // expose destroy method for cleanup\n  middleware.destroy = () => {\n    uninstallAllFilters()\n  }\n\n  return middleware\n\n  //\n  // new filters\n  //\n\n  async function newLogFilter(params) {\n    const filter = new LogFilter({ provider, params })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newBlockFilter() {\n    const filter = new BlockFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newPendingTransactionFilter() {\n    const filter = new TxFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  //\n  // get filter changes\n  //\n\n  async function getFilterChanges(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    const results = filter.getChangesAndClear()\n    return results\n  }\n\n  async function getFilterLogs(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    // only return results for log filters\n    if (filter.type === 'log') {\n      results = filter.getAllResults()\n    } else {\n      results = []\n    }\n    return results\n  }\n\n\n  //\n  // remove filters\n  //\n\n\n  async function uninstallFilterHandler(filterIndexHex) {\n    // check filter exists\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    const result = Boolean(filter)\n    // uninstall filter\n    if (result) {\n      await uninstallFilter(filterIndex)\n    }\n    return result\n  }\n\n  //\n  // utils\n  //\n\n  async function installFilter(filter) {\n    const prevFilterCount = objValues(filters).length\n    // install filter\n    const currentBlock = await blockTracker.getLatestBlock()\n    await filter.initialize({ currentBlock })\n    filterIndex++\n    filters[filterIndex] = filter\n    filter.id = filterIndex\n    filter.idHex = intToHex(filterIndex)\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n    return filterIndex\n  }\n\n  async function uninstallFilter(filterIndex) {\n    const prevFilterCount = objValues(filters).length\n    delete filters[filterIndex]\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n  }\n\n  async function uninstallAllFilters() {\n    const prevFilterCount = objValues(filters).length\n    filters = {}\n    // update block tracker subs\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount: 0 })\n  }\n\n  function updateBlockTrackerSubs({ prevFilterCount, newFilterCount }) {\n    // subscribe\n    if (prevFilterCount === 0 && newFilterCount > 0) {\n      blockTracker.on('sync', filterUpdater)\n      return\n    }\n    // unsubscribe\n    if (prevFilterCount > 0 && newFilterCount === 0) {\n      blockTracker.removeListener('sync', filterUpdater)\n      return\n    }\n  }\n\n}\n\n// helper for turning filter constructors into rpc middleware\nfunction toFilterCreationMiddleware(createFilterFn) {\n  return toAsyncRpcMiddleware(async (...args) => {\n    const filter = await createFilterFn(...args)\n    const result = intToHex(filter.id)\n    return result\n  })\n}\n\n// helper for pulling out req.params and setting res.result\nfunction toAsyncRpcMiddleware(asyncFn) {\n  return createAsyncMiddleware(async (req, res) => {\n    const result = await asyncFn.apply(null, req.params)\n    res.result = result\n  })\n}\n\nfunction mutexMiddlewareWrapper({ mutex }) {\n  return (middleware) => {\n    return async (req, res, next, end) => {\n      // wait for mutex available\n      // we can release immediately because\n      // we just need to make sure updates aren't active\n      const releaseLock = await mutex.acquire()\n      releaseLock()\n      middleware(req, res, next, end)\n    }\n  }\n}\n\nfunction objValues(obj, fn){\n  const values = []\n  for (let key in obj) {\n    values.push(obj[key])\n  }\n  return values\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./idRemapMiddleware\"), exports);\n__exportStar(require(\"./createAsyncMiddleware\"), exports);\n__exportStar(require(\"./createScaffoldMiddleware\"), exports);\n__exportStar(require(\"./getUniqueId\"), exports);\n__exportStar(require(\"./JsonRpcEngine\"), exports);\n__exportStar(require(\"./mergeMiddleware\"), exports);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsc0RBQW9DO0FBQ3BDLDBEQUF3QztBQUN4Qyw2REFBMkM7QUFDM0MsZ0RBQThCO0FBQzlCLGtEQUFnQztBQUNoQyxvREFBa0MifQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getUniqueId = void 0;\n// uint32 (two's complement) max\n// more conservative than Number.MAX_SAFE_INTEGER\nconst MAX = 4294967295;\nlet idCounter = Math.floor(Math.random() * MAX);\nfunction getUniqueId() {\n    idCounter = (idCounter + 1) % MAX;\n    return idCounter;\n}\nexports.getUniqueId = getUniqueId;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0VW5pcXVlSWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZ2V0VW5pcXVlSWQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsZ0NBQWdDO0FBQ2hDLGlEQUFpRDtBQUNqRCxNQUFNLEdBQUcsR0FBRyxVQUFVLENBQUM7QUFDdkIsSUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUM7QUFFaEQsU0FBZ0IsV0FBVztJQUN6QixTQUFTLEdBQUcsQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO0lBQ2xDLE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUM7QUFIRCxrQ0FHQyJ9","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.JsonRpcEngine = void 0;\nconst safe_event_emitter_1 = __importDefault(require(\"@metamask/safe-event-emitter\"));\nconst eth_rpc_errors_1 = require(\"eth-rpc-errors\");\n/**\n * A JSON-RPC request and response processor.\n * Give it a stack of middleware, pass it requests, and get back responses.\n */\nclass JsonRpcEngine extends safe_event_emitter_1.default {\n    constructor() {\n        super();\n        this._middleware = [];\n    }\n    /**\n     * Add a middleware function to the engine's middleware stack.\n     *\n     * @param middleware - The middleware function to add.\n     */\n    push(middleware) {\n        this._middleware.push(middleware);\n    }\n    handle(req, cb) {\n        if (cb && typeof cb !== 'function') {\n            throw new Error('\"callback\" must be a function if provided.');\n        }\n        if (Array.isArray(req)) {\n            if (cb) {\n                return this._handleBatch(req, cb);\n            }\n            return this._handleBatch(req);\n        }\n        if (cb) {\n            return this._handle(req, cb);\n        }\n        return this._promiseHandle(req);\n    }\n    /**\n     * Returns this engine as a middleware function that can be pushed to other\n     * engines.\n     *\n     * @returns This engine as a middleware function.\n     */\n    asMiddleware() {\n        return async (req, res, next, end) => {\n            try {\n                const [middlewareError, isComplete, returnHandlers,] = await JsonRpcEngine._runAllMiddleware(req, res, this._middleware);\n                if (isComplete) {\n                    await JsonRpcEngine._runReturnHandlers(returnHandlers);\n                    return end(middlewareError);\n                }\n                return next(async (handlerCallback) => {\n                    try {\n                        await JsonRpcEngine._runReturnHandlers(returnHandlers);\n                    }\n                    catch (error) {\n                        return handlerCallback(error);\n                    }\n                    return handlerCallback();\n                });\n            }\n            catch (error) {\n                return end(error);\n            }\n        };\n    }\n    async _handleBatch(reqs, cb) {\n        // The order here is important\n        try {\n            // 2. Wait for all requests to finish, or throw on some kind of fatal\n            // error\n            const responses = await Promise.all(\n            // 1. Begin executing each request in the order received\n            reqs.map(this._promiseHandle.bind(this)));\n            // 3. Return batch response\n            if (cb) {\n                return cb(null, responses);\n            }\n            return responses;\n        }\n        catch (error) {\n            if (cb) {\n                return cb(error);\n            }\n            throw error;\n        }\n    }\n    /**\n     * A promise-wrapped _handle.\n     */\n    _promiseHandle(req) {\n        return new Promise((resolve) => {\n            this._handle(req, (_err, res) => {\n                // There will always be a response, and it will always have any error\n                // that is caught and propagated.\n                resolve(res);\n            });\n        });\n    }\n    /**\n     * Ensures that the request object is valid, processes it, and passes any\n     * error and the response object to the given callback.\n     *\n     * Does not reject.\n     */\n    async _handle(callerReq, cb) {\n        if (!callerReq ||\n            Array.isArray(callerReq) ||\n            typeof callerReq !== 'object') {\n            const error = new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.invalidRequest, `Requests must be plain objects. Received: ${typeof callerReq}`, { request: callerReq });\n            return cb(error, { id: undefined, jsonrpc: '2.0', error });\n        }\n        if (typeof callerReq.method !== 'string') {\n            const error = new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.invalidRequest, `Must specify a string method. Received: ${typeof callerReq.method}`, { request: callerReq });\n            return cb(error, { id: callerReq.id, jsonrpc: '2.0', error });\n        }\n        const req = Object.assign({}, callerReq);\n        const res = {\n            id: req.id,\n            jsonrpc: req.jsonrpc,\n        };\n        let error = null;\n        try {\n            await this._processRequest(req, res);\n        }\n        catch (_error) {\n            // A request handler error, a re-thrown middleware error, or something\n            // unexpected.\n            error = _error;\n        }\n        if (error) {\n            // Ensure no result is present on an errored response\n            delete res.result;\n            if (!res.error) {\n                res.error = eth_rpc_errors_1.serializeError(error);\n            }\n        }\n        return cb(error, res);\n    }\n    /**\n     * For the given request and response, runs all middleware and their return\n     * handlers, if any, and ensures that internal request processing semantics\n     * are satisfied.\n     */\n    async _processRequest(req, res) {\n        const [error, isComplete, returnHandlers,] = await JsonRpcEngine._runAllMiddleware(req, res, this._middleware);\n        // Throw if \"end\" was not called, or if the response has neither a result\n        // nor an error.\n        JsonRpcEngine._checkForCompletion(req, res, isComplete);\n        // The return handlers should run even if an error was encountered during\n        // middleware processing.\n        await JsonRpcEngine._runReturnHandlers(returnHandlers);\n        // Now we re-throw the middleware processing error, if any, to catch it\n        // further up the call chain.\n        if (error) {\n            throw error;\n        }\n    }\n    /**\n     * Serially executes the given stack of middleware.\n     *\n     * @returns An array of any error encountered during middleware execution,\n     * a boolean indicating whether the request was completed, and an array of\n     * middleware-defined return handlers.\n     */\n    static async _runAllMiddleware(req, res, middlewareStack) {\n        const returnHandlers = [];\n        let error = null;\n        let isComplete = false;\n        // Go down stack of middleware, call and collect optional returnHandlers\n        for (const middleware of middlewareStack) {\n            [error, isComplete] = await JsonRpcEngine._runMiddleware(req, res, middleware, returnHandlers);\n            if (isComplete) {\n                break;\n            }\n        }\n        return [error, isComplete, returnHandlers.reverse()];\n    }\n    /**\n     * Runs an individual middleware.\n     *\n     * @returns An array of any error encountered during middleware exection,\n     * and a boolean indicating whether the request should end.\n     */\n    static _runMiddleware(req, res, middleware, returnHandlers) {\n        return new Promise((resolve) => {\n            const end = (err) => {\n                const error = err || res.error;\n                if (error) {\n                    res.error = eth_rpc_errors_1.serializeError(error);\n                }\n                // True indicates that the request should end\n                resolve([error, true]);\n            };\n            const next = (returnHandler) => {\n                if (res.error) {\n                    end(res.error);\n                }\n                else {\n                    if (returnHandler) {\n                        if (typeof returnHandler !== 'function') {\n                            end(new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: \"next\" return handlers must be functions. ` +\n                                `Received \"${typeof returnHandler}\" for request:\\n${jsonify(req)}`, { request: req }));\n                        }\n                        returnHandlers.push(returnHandler);\n                    }\n                    // False indicates that the request should not end\n                    resolve([null, false]);\n                }\n            };\n            try {\n                middleware(req, res, next, end);\n            }\n            catch (error) {\n                end(error);\n            }\n        });\n    }\n    /**\n     * Serially executes array of return handlers. The request and response are\n     * assumed to be in their scope.\n     */\n    static async _runReturnHandlers(handlers) {\n        for (const handler of handlers) {\n            await new Promise((resolve, reject) => {\n                handler((err) => (err ? reject(err) : resolve()));\n            });\n        }\n    }\n    /**\n     * Throws an error if the response has neither a result nor an error, or if\n     * the \"isComplete\" flag is falsy.\n     */\n    static _checkForCompletion(req, res, isComplete) {\n        if (!('result' in res) && !('error' in res)) {\n            throw new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: Response has no error or result for request:\\n${jsonify(req)}`, { request: req });\n        }\n        if (!isComplete) {\n            throw new eth_rpc_errors_1.EthereumRpcError(eth_rpc_errors_1.errorCodes.rpc.internal, `JsonRpcEngine: Nothing ended request:\\n${jsonify(req)}`, { request: req });\n        }\n    }\n}\nexports.JsonRpcEngine = JsonRpcEngine;\nfunction jsonify(request) {\n    return JSON.stringify(request, null, 2);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSnNvblJwY0VuZ2luZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Kc29uUnBjRW5naW5lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHNGQUE0RDtBQUM1RCxtREFBOEU7QUF1RjlFOzs7R0FHRztBQUNILE1BQWEsYUFBYyxTQUFRLDRCQUFnQjtJQUdqRDtRQUNFLEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxJQUFJLENBQU8sVUFBbUM7UUFDNUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBaUQsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUEyQ0QsTUFBTSxDQUFDLEdBQVksRUFBRSxFQUFRO1FBQzNCLElBQUksRUFBRSxJQUFJLE9BQU8sRUFBRSxLQUFLLFVBQVUsRUFBRTtZQUNsQyxNQUFNLElBQUksS0FBSyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7U0FDL0Q7UUFFRCxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDdEIsSUFBSSxFQUFFLEVBQUU7Z0JBQ04sT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQzthQUNuQztZQUNELE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMvQjtRQUVELElBQUksRUFBRSxFQUFFO1lBQ04sT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQThCLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDekQ7UUFDRCxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBOEIsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILFlBQVk7UUFDVixPQUFPLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRTtZQUNuQyxJQUFJ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","\nconst errorValues = require('./errorValues.json')\nconst FALLBACK_ERROR_CODE = require('./errorCodes.json').rpc.internal\nconst { EthereumRpcError } = require('./classes')\n\nconst JSON_RPC_SERVER_ERROR_MESSAGE = 'Unspecified server error.'\n\nconst FALLBACK_MESSAGE = 'Unspecified error message. This is a bug, please report it.'\n\nconst FALLBACK_ERROR = {\n  code: FALLBACK_ERROR_CODE,\n  message: getMessageFromCode(FALLBACK_ERROR_CODE),\n}\n\n/**\n * Gets the message for a given code, or a fallback message if the code has\n * no corresponding message.\n *\n * @param {number} code - The integer error code\n * @param {string} fallbackMessage - The fallback message\n * @return {string} The corresponding message or the fallback message\n */\nfunction getMessageFromCode (code, fallbackMessage = FALLBACK_MESSAGE) {\n\n  if (Number.isInteger(code)) {\n\n    const codeString = code.toString()\n\n    if (errorValues[codeString]) {\n      return errorValues[codeString].message\n    }\n    if (isJsonRpcServerError(code)) {\n      return JSON_RPC_SERVER_ERROR_MESSAGE\n    }\n  }\n  return fallbackMessage\n}\n\n/**\n * Returns whether the given code is valid.\n * A code is only valid if it has a message.\n *\n * @param {number} code - The code to check\n * @return {boolean} true if the code is valid, false otherwise.\n */\nfunction isValidCode (code) {\n\n  if (!Number.isInteger(code)) {\n    return false\n  }\n\n  const codeString = code.toString()\n  if (errorValues[codeString]) {\n    return true\n  }\n\n  if (isJsonRpcServerError(code)) {\n    return true\n  }\n\n  // TODO: allow valid codes and messages to be extended\n  // // EIP 1193 Status Codes\n  // if (code >= 4000 && code <= 4999) return true\n\n  return false\n}\n\n/**\n * Serializes the given error to an Ethereum JSON RPC-compatible error object.\n * Merely copies the given error's values if it is already compatible.\n * If the given error is not fully compatible, it will be preserved on the\n * returned object's data.originalError property.\n *\n * @param {any} error - The error to serialize.\n * @param {Object} [options] - An options object.\n * @param {Object} [options.fallbackError] - The custom fallback error values if\n * the given error is invalid.\n * @param {boolean} [options.shouldIncludeStack] - Whether the 'stack' property\n * of the given error should be included on the serialized error, if present.\n * @return {Object} A standardized, plain error object.\n */\nfunction serializeError (\n  error,\n  { fallbackError = FALLBACK_ERROR, shouldIncludeStack = false } = {},\n) {\n\n  if (\n    !fallbackError ||\n    !Number.isInteger(fallbackError.code) ||\n    typeof fallbackError.message !== 'string'\n  ) {\n    throw new Error(\n      'Must provide fallback error with integer number code and string message.',\n    )\n  }\n\n  if (error instanceof EthereumRpcError) {\n    return error.serialize()\n  }\n\n  const serialized = {}\n\n  if (error && isValidCode(error.code)) {\n\n    serialized.code = error.code\n\n    if (error.message && typeof error.message === 'string') {\n      serialized.message = error.message\n      if ('data' in error) {\n        serialized.data = error.data\n      }\n    } else {\n      serialized.message = getMessageFromCode(serialized.code)\n      serialized.data = { originalError: assignOriginalError(error) }\n    }\n\n  } else {\n    serialized.code = fallbackError.code\n    serialized.message = (\n      error && error.message\n        ? error.message\n        : fallbackError.message\n    )\n    serialized.data = { originalError: assignOriginalError(error) }\n  }\n\n  if (shouldIncludeStack && error && typeof error.stack === 'string') {\n    serialized.stack = error.stack\n  }\n  return serialized\n}\n\n// Internal\n\nfunction isJsonRpcServerError (code) {\n  return code >= -32099 && code <= -32000\n}\n\nfunction assignOriginalError (error) {\n  if (error && typeof error === 'object' && !Array.isArray(error)) {\n    return { ...error }\n  }\n  return error\n}\n\n// Exports\n\nmodule.exports = {\n  getMessageFromCode,\n  isValidCode,\n  serializeError,\n  JSON_RPC_SERVER_ERROR_MESSAGE,\n}\n","// for backwards compat\nmodule.exports = require('json-rpc-engine/src/createScaffoldMiddleware')\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\nconst createScaffoldMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createFilterMiddleware = require('./index.js')\nconst { unsafeRandomBytes, incrementHexInt } = require('./hexUtils.js')\nconst getBlocksForRange = require('./getBlocksForRange.js')\n\nmodule.exports = createSubscriptionMiddleware\n\n\nfunction createSubscriptionMiddleware({ blockTracker, provider }) {\n  // state and utilities for handling subscriptions\n  const subscriptions = {}\n  const filterManager = createFilterMiddleware({ blockTracker, provider })\n\n  // internal flag\n  let isDestroyed = false\n\n  // create subscriptionManager api object\n  const events = new SafeEventEmitter()\n  const middleware = createScaffoldMiddleware({\n    eth_subscribe: createAsyncMiddleware(subscribe),\n    eth_unsubscribe: createAsyncMiddleware(unsubscribe),\n  })\n  middleware.destroy = destroy\n  return { events, middleware }\n\n  async function subscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const subscriptionType = req.params[0]\n    // subId is 16 byte hex string\n    const subId = unsafeRandomBytes(16)\n\n    // create sub\n    let sub\n    switch (subscriptionType) {\n      case 'newHeads':\n        sub = createSubNewHeads({ subId })\n        break\n      case 'logs':\n        const filterParams = req.params[1]\n        const filter = await filterManager.newLogFilter(filterParams)\n        sub = createSubFromFilter({ subId, filter })\n        break\n      default:\n        throw new Error(`SubscriptionManager - unsupported subscription type \"${subscriptionType}\"`)\n\n    }\n    subscriptions[subId] = sub\n\n    res.result = subId\n    return\n\n    function createSubNewHeads({ subId }) {\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          blockTracker.removeListener('sync', sub.update)\n        },\n        update: async ({ oldBlock, newBlock }) => {\n          // for newHeads\n          const toBlock = newBlock\n          const fromBlock = incrementHexInt(oldBlock)\n          const rawBlocks = await getBlocksForRange({ provider, fromBlock, toBlock })\n          const results = rawBlocks.map(normalizeBlock)\n          results.forEach((value) => {\n            _emitSubscriptionResult(subId, value)\n          })\n        }\n      }\n      // check for subscription updates on new block\n      blockTracker.on('sync', sub.update)\n      return sub\n    }\n\n    function createSubFromFilter({ subId, filter }){\n      filter.on('update', result => _emitSubscriptionResult(subId, result))\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          return await filterManager.uninstallFilter(filter.idHex)\n        },\n      }\n      return sub\n    }\n  }\n\n  async function unsubscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const id = req.params[0]\n    const subscription = subscriptions[id]\n    // if missing, return \"false\" to indicate it was not removed\n    if (!subscription) {\n      res.result = false\n      return\n    }\n    // cleanup subscription\n    delete subscriptions[id]\n    await subscription.destroy()\n    res.result = true\n  }\n\n  function _emitSubscriptionResult(filterIdHex, value) {\n    events.emit('notification', {\n      jsonrpc: '2.0',\n      method: 'eth_subscription',\n      params: {\n        subscription: filterIdHex,\n        result: value,\n      },\n    })\n  }\n\n  function destroy () {\n    events.removeAllListeners()\n    for (const id in subscriptions) {\n      subscriptions[id].destroy()\n      delete subscriptions[id]\n    }\n    isDestroyed = true\n  }\n}\n\nfunction normalizeBlock(block) {\n  return {\n    hash: block.hash,\n    parentHash: block.parentHash,\n    sha3Uncles: block.sha3Uncles,\n    miner: block.miner,\n    stateRoot: block.stateRoot,\n    transactionsRoot: block.transactionsRoot,\n    receiptsRoot: block.receiptsRoot,\n    logsBloom: block.logsBloom,\n    difficulty: block.difficulty,\n    number: block.number,\n    gasLimit: block.gasLimit,\n    gasUsed: block.gasUsed,\n    nonce: block.nonce,\n    mixHash: block.mixHash,\n    timestamp: block.timestamp,\n    extraData: block.extraData,\n  }\n}\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst SafeEventEmitter = require('safe-event-emitter')\n\nconst sec = 1000\n\nconst calculateSum = (accumulator, currentValue) => accumulator + currentValue\nconst blockTrackerEvents = ['sync', 'latest']\n\nclass BaseBlockTracker extends SafeEventEmitter {\n\n  //\n  // public\n  //\n\n  constructor (opts = {}) {\n    super()\n    // config\n    this._blockResetDuration = opts.blockResetDuration || 20 * sec\n    // state\n    this._blockResetTimeout\n    this._currentBlock = null\n    this._isRunning = false\n    // bind functions for internal use\n    this._onNewListener = this._onNewListener.bind(this)\n    this._onRemoveListener = this._onRemoveListener.bind(this)\n    this._resetCurrentBlock = this._resetCurrentBlock.bind(this)\n    // listen for handler changes\n    this._setupInternalEvents()\n  }\n\n  isRunning () {\n    return this._isRunning\n  }\n\n  getCurrentBlock () {\n    return this._currentBlock\n  }\n\n  async getLatestBlock () {\n    // return if available\n    if (this._currentBlock) return this._currentBlock\n    // wait for a new latest block\n    const latestBlock = await new Promise(resolve => this.once('latest', resolve))\n    // return newly set current block\n    return latestBlock\n  }\n\n  // dont allow module consumer to remove our internal event listeners\n  removeAllListeners (eventName) {\n    // perform default behavior, preserve fn arity\n    if (eventName) {\n      super.removeAllListeners(eventName)\n    } else {\n      super.removeAllListeners()\n    }\n    // re-add internal events\n    this._setupInternalEvents()\n    // trigger stop check just in case\n    this._onRemoveListener()\n  }\n\n  //\n  // to be implemented in subclass\n  //\n\n  _start () {\n    // default behavior is noop\n  }\n\n  _end () {\n    // default behavior is noop\n  }\n\n  //\n  // private\n  //\n\n  _setupInternalEvents () {\n    // first remove listeners for idempotence\n    this.removeListener('newListener', this._onNewListener)\n    this.removeListener('removeListener', this._onRemoveListener)\n    // then add them\n    this.on('newListener', this._onNewListener)\n    this.on('removeListener', this._onRemoveListener)\n  }\n\n  _onNewListener (eventName, handler) {\n    // `newListener` is called *before* the listener is added\n    if (!blockTrackerEvents.includes(eventName)) return\n    this._maybeStart()\n  }\n\n  _onRemoveListener (eventName, handler) {\n    // `removeListener` is called *after* the listener is removed\n    if (this._getBlockTrackerEventCount() > 0) return\n    this._maybeEnd()\n  }\n\n  _maybeStart () {\n    if (this._isRunning) return\n    this._isRunning = true\n    // cancel setting latest block to stale\n    this._cancelBlockResetTimeout()\n    this._start()\n  }\n\n  _maybeEnd () {\n    if (!this._isRunning) return\n    this._isRunning = false\n    this._setupBlockResetTimeout()\n    this._end()\n  }\n\n  _getBlockTrackerEventCount () {\n    return blockTrackerEvents\n      .map(eventName => this.listenerCount(eventName))\n      .reduce(calculateSum)\n  }\n\n  _newPotentialLatest (newBlock) {\n    const currentBlock = this._currentBlock\n    // only update if blok number is higher\n    if (currentBlock && (hexToInt(newBlock) <= hexToInt(currentBlock))) return\n    this._setCurrentBlock(newBlock)\n  }\n\n  _setCurrentBlock (newBlock) {\n    const oldBlock = this._currentBlock\n    this._currentBlock = newBlock\n    this.emit('latest', newBlock)\n    this.emit('sync', { oldBlock, newBlock })\n  }\n\n  _setupBlockResetTimeout () {\n    // clear any existing timeout\n    this._cancelBlockResetTimeout()\n    // clear latest block when stale\n    this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this._blockResetDuration)\n    // nodejs - dont hold process open\n    if (this._blockResetTimeout.unref) {\n      this._blockResetTimeout.unref()\n    }\n  }\n\n  _cancelBlockResetTimeout () {\n    clearTimeout(this._blockResetTimeout)\n  }\n\n  _resetCurrentBlock () {\n    this._currentBlock = null\n  }\n\n}\n\nmodule.exports = BaseBlockTracker\n\nfunction hexToInt(hexInt) {\n  return Number.parseInt(hexInt, 16)\n}\n","module.exports = IdIterator\n\nfunction IdIterator(opts){\n  opts = opts || {}\n  var max = opts.max || Number.MAX_SAFE_INTEGER\n  var idCounter = typeof opts.start !== 'undefined' ? opts.start : Math.floor(Math.random() * max)\n\n  return function createRandomId () {\n    idCounter = idCounter % max\n    return idCounter++\n  }\n\n}","const util = require('util')\nconst EventEmitter = require('events/')\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n}\n\nmodule.exports = SafeEventEmitter\n\n\nfunction SafeEventEmitter() {\n  EventEmitter.call(this)\n}\n\nutil.inherits(SafeEventEmitter, EventEmitter)\n\nSafeEventEmitter.prototype.emit = function (type) {\n  // copied from https://github.com/Gozala/events/blob/master/events.js\n  // modified lines are commented with \"edited:\"\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    // edited: using safeApply\n    safeApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      // edited: using safeApply\n      safeApply(listeners[i], this, args);\n  }\n\n  return true;\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    ReflectApply(handler, context, args)\n  } catch (err) {\n    // throw error after timeout so as not to interupt the stack\n    setTimeout(() => {\n      throw err\n    })\n  }\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n"],"sourceRoot":""}